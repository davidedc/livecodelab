<!doctype html>

<!-- Documentation generated by [CoffeeDoc](http://github.com/omarkhan/coffeedoc) -->

<html>
<head>
  <title>CoffeeDoc</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" media="all" href="resources/base.css" />
</head>
<body>
  <header>
    <h1>CoffeeDoc &mdash; Module Index</h1>
  </header>
  <div class="container">
    <div class="sidebar column">
      <ul id="modulelist">
        
        <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/animation-loop.coffee.html">animation-loop.coffee</a></li>
        
        <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/autocoder/autocoder.coffee.html">autocoder/autocoder.coffee</a></li>
        
        <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/autocoder/lexer.coffee.html">autocoder/lexer.coffee</a></li>
        
        <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/background-painter.coffee.html">background-painter.coffee</a></li>
        
        <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/big-cursor.coffee.html">big-cursor.coffee</a></li>
        
        <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/blend-controls.coffee.html">blend-controls.coffee</a></li>
        
        <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/code-transformer.coffee.html">code-transformer.coffee</a></li>
        
        <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/colour-functions.coffee.html">colour-functions.coffee</a></li>
        
        <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/colour-literals.coffee.html">colour-literals.coffee</a></li>
        
        <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/editor/editor.coffee.html">editor/editor.coffee</a></li>
        
        <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/event-router.coffee.html">event-router.coffee</a></li>
        
        <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/globals.coffee.html">globals.coffee</a></li>
        
        <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/graphics-commands.coffee.html">graphics-commands.coffee</a></li>
        
        <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/init.coffee.html">init.coffee</a></li>
        
        <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/lights-commands.coffee.html">lights-commands.coffee</a></li>
        
        <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/livecodelab-core.coffee.html">livecodelab-core.coffee</a></li>
        
        <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/math.coffee.html">math.coffee</a></li>
        
        <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/matrix-commands.coffee.html">matrix-commands.coffee</a></li>
        
        <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/parser.coffee.html">parser.coffee</a></li>
        
        <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/program-loader.coffee.html">program-loader.coffee</a></li>
        
        <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/program-runner.coffee.html">program-runner.coffee</a></li>
        
        <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/renderer.coffee.html">renderer.coffee</a></li>
        
        <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/sound/samplebank.coffee.html">sound/samplebank.coffee</a></li>
        
        <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/sound/sound-system.coffee.html">sound/sound-system.coffee</a></li>
        
        <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/text-dimming.coffee.html">text-dimming.coffee</a></li>
        
        <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/threejs-system.coffee.html">threejs-system.coffee</a></li>
        
        <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/time-keeper.coffee.html">time-keeper.coffee</a></li>
        
        <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/ui.coffee.html">ui.coffee</a></li>
        
        <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/url-router.coffee.html">url-router.coffee</a></li>
        
      </ul>
    </div>
    <div class="content column">
      
      <div class="module">
        <div class="header">
          <a href="docs/deleteme/sourcesWithBlockComments/coffee/animation-loop.coffee.html"><h1>animation-loop.coffee</h1></a>
        </div>
        <div class="module-content">
          <p>The animation loop is the loop that make each &quot;frame&quot; happen, i.e. whatever happend
every 30 to 60 times (or, indeed, &quot;frames&quot;) per second - which is the following:
<em> the next frame is scheduled
</em> the current program (i.e. a draw() Function) is run
<em> the background is repainted if it has changed from the previous frame
</em> the new 3d scene is painted
* the stats widget on the top right is updated to show milliseconds taken by each loop
  frame.</p>
<p>Note that the followings are NOT done as part of the animation loop:
<em> Syntax checking of the program typed by the user (that&#39;s checked only when it changed)
</em> sound playing. That happens by its own series of timeouts (as defined by the
  optional &quot;bpm&quot; command) separately from the
  animation loop.
* blinking of the cursor</p>
<p>About the current Function being run:
note that this might not be the Function corresponding to the very latest
content of the editor, because of two reasons: the newest content of the editor
a) might just be syntactically incorrect or, b) even if it&#39;s syntactically correct
it might not be &quot;stable&quot; i.e. it might have thrown
a runtime error (for example used an undefined variable or function).</p>
<p>Rather, the current
draw() function is the latest program that is both syntactically correct and
&quot;stable&quot; (or in the process of being proven stable). Stability of a
program cannot be guaranteed, but LiveCodeLab heuristically considers as &quot;stable&quot; a
program once it&#39;s able to run for 5 frames without throwing errors. If the program
throws an error past this testing window, then LiveCodeLab currently has no
further fallback, so the Function will be just run each frame and hope is that
it has time to draw enough animation on the screen before it throws the error so that
some kind of animation will still be playing.
One could devise a mechanism by which a stack of stable functions is maintained, so
each failing function of the stack would cause the previous one to become the current
stable alternative. This would practically guarantee that there is a Function that
is simple enough in the past that it would contain no runtime errors - unless a
previous function has so dramatically borked the state of the entire system, but
that would probably take some malice.</p>

          
          <h3>Classes</h3>
          <ul class="classlist">
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/animation-loop.coffee.html#AnimationLoop">AnimationLoop</a></li>
            
          </ul>
          
          
        </div>
      </div>
      
      <div class="module">
        <div class="header">
          <a href="docs/deleteme/sourcesWithBlockComments/coffee/autocoder/autocoder.coffee.html"><h1>autocoder.coffee</h1></a>
        </div>
        <div class="module-content">
          <p>Autocoder takes care of making random variations to the code. It lexes the input,
collects the tokens that can be mutated, picks one at random, invokes a mutation on it,
and then re-builds a string pritout from the tokens so to obtain the mutated program.</p>

          
          <h3>Classes</h3>
          <ul class="classlist">
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/autocoder/autocoder.coffee.html#Autocoder">Autocoder</a></li>
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/autocoder/autocoder.coffee.html#TOKEN_COMMENT">TOKEN_COMMENT</a></li>
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/autocoder/autocoder.coffee.html#TOKEN_SPACE">TOKEN_SPACE</a></li>
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/autocoder/autocoder.coffee.html#TOKEN_NEWLINE">TOKEN_NEWLINE</a></li>
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/autocoder/autocoder.coffee.html#TOKEN_TRANSLATION">TOKEN_TRANSLATION</a></li>
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/autocoder/autocoder.coffee.html#TOKEN_VARIABLE">TOKEN_VARIABLE</a></li>
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/autocoder/autocoder.coffee.html#TOKEN_NUM">TOKEN_NUM</a></li>
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/autocoder/autocoder.coffee.html#TOKEN_OP">TOKEN_OP</a></li>
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/autocoder/autocoder.coffee.html#TOKEN_ARGDLIM">TOKEN_ARGDLIM</a></li>
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/autocoder/autocoder.coffee.html#TOKEN_TAB">TOKEN_TAB</a></li>
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/autocoder/autocoder.coffee.html#TOKEN_DOONCE">TOKEN_DOONCE</a></li>
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/autocoder/autocoder.coffee.html#TOKEN_MESH">TOKEN_MESH</a></li>
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/autocoder/autocoder.coffee.html#TOKEN_STATEFUN">TOKEN_STATEFUN</a></li>
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/autocoder/autocoder.coffee.html#TOKEN_ITERATION">TOKEN_ITERATION</a></li>
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/autocoder/autocoder.coffee.html#TOKEN_UNKNOWN">TOKEN_UNKNOWN</a></li>
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/autocoder/autocoder.coffee.html#TOKEN_COLOUR">TOKEN_COLOUR</a></li>
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/autocoder/autocoder.coffee.html#TOKEN_COLOUROP">TOKEN_COLOUROP</a></li>
            
          </ul>
          
          
        </div>
      </div>
      
      <div class="module">
        <div class="header">
          <a href="docs/deleteme/sourcesWithBlockComments/coffee/autocoder/lexer.coffee.html"><h1>lexer.coffee</h1></a>
        </div>
        <div class="module-content">
          <p>Lexer is a variation/port of:</p>
<p>McLexer: A lexical analysis system/library for JavaScript.
Author:  Matthew Might
Site:    <a href="http://matt.might.net/">http://matt.might.net/</a>
         <a href="http://www.ucombinator.com/">http://www.ucombinator.com/</a></p>
<p>The lexer associates rules with analysis states.</p>
<p>Each rule contains a regular expression to match, 
and action to execute upon finding a match.</p>
<p>When a state matches its rules against an input text, 
it chooses the rule with the longest match against the prefix 
of the input text.</p>
<p>A lexical state is a collection of rules.</p>
<p>It has three primary methods:</p>
<ul>
<li><p>lex(input) runs a continuation-based lexer on the input;
lex invokes next once, and expects a continuation back;
it then invokes the continuation and expects each continuation
it invokes to return another continuation.  Once a continuation
returns null; parsing is complete.     </p>
</li>
<li><p>findAndRunActionPairedToLongestAppliableRegex(input) runs a match against an input,
fires the action.
An action is a procedure that accepts the match data (an array),
the remainder of the input, and the current state and returns a function that
applies the rules again and finds and runs the next action. An action does not run
the next one (that would be recursion). Rather, it returns a function to find and
run the next one</p>
</li>
</ul>
<p>Why this &quot;step by step&quot; approach instead of a normal recursion? The advantage is
that you can stop the parsing and resume it any time you want. Suppose that
you have a huge program to parse. With recursion, once you start you can&#39;t
stop until the end (at least if you are using normal recursion as provided by
the language runtime. If you implement your own recursion using your own stack
then you could indeed pause/resume things). In a single-threaded language like
Javascript this results in everything else &quot;blocking&quot;. A &quot;continuations&quot; approach
lets you stop and resume the parsing more easily, since you lex the program step
by step in a manner that does not rely on the runtime stack. There is no recursion.</p>

          
          <h3>Classes</h3>
          <ul class="classlist">
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/autocoder/lexer.coffee.html#LexerState">LexerState</a></li>
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/autocoder/lexer.coffee.html#LexerRule">LexerRule</a></li>
            
          </ul>
          
          
        </div>
      </div>
      
      <div class="module">
        <div class="header">
          <a href="docs/deleteme/sourcesWithBlockComments/coffee/background-painter.coffee.html"><h1>background-painter.coffee</h1></a>
        </div>
        <div class="module-content">
          <p>The user can issue multiple solid fill and gradient fill commands
and they are all painted on top of each other according to the
order they have been issued in.
So for example you can have one gradient and then
a second one painted over it that uses some transparency.</p>
<p>This is why solid and gradient fills are all kept in an array
and each time the user issues one of the two commands, an
element is added to the array.</p>
<p>Both solid and gradient fills are stored as elements in the
array, all elements are the same and accommodate for a description
that either case (solid/gradient).</p>
<p>The background/gradients are drawn on a separate 2D canvas
and we avoid repainting that canvas over and over if the
painting commands stay the same (i.e. colors of their
arguments and the order of the commands) across frames.</p>
<p>For quickly determining whether the order/content of the commands
has changed across frames,
a string is kept that represents the whole stack of commands
issued in the current frame, and similarly the &quot;previous frame&quot;
string representation is also kept.
So it&#39;s kind of like a simplified JSON representation if you will.</p>
<p>If the strings are the same across frames, then the 2D layer of
the background is not repainted, otherwise the array is iterated
and each background/gradient is painted anew.</p>
<p>Note that we are not trying to be too clever here - for example
a solid fill effectively invalidates the contents of the previous
elements of the array, so we could discard those when such
a command is issued.</p>

          
          <h3>Classes</h3>
          <ul class="classlist">
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/background-painter.coffee.html#BackgroundPainter">BackgroundPainter</a></li>
            
          </ul>
          
          
        </div>
      </div>
      
      <div class="module">
        <div class="header">
          <a href="docs/deleteme/sourcesWithBlockComments/coffee/big-cursor.coffee.html"><h1>big-cursor.coffee</h1></a>
        </div>
        <div class="module-content">
          <p>The big cursor that flashes when the environment is first opened. It&#39;s a special div
which is actually not meant to contain text. It just shrinks/expands depending on
whether the user types something (shrinks) or whether the program turns empty
(expands).</p>

          
          <h3>Classes</h3>
          <ul class="classlist">
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/big-cursor.coffee.html#BigCursor">BigCursor</a></li>
            
          </ul>
          
          
        </div>
      </div>
      
      <div class="module">
        <div class="header">
          <a href="docs/deleteme/sourcesWithBlockComments/coffee/blend-controls.coffee.html"><h1>blend-controls.coffee</h1></a>
        </div>
        <div class="module-content">
          <p>BlendControls manages the three different blending styles. One can decide for either
&#39;normal&#39; (e.g. next frame completely replaces the previous one) or &#39;paintOver&#39;
(new frame is painted over the previous one, meaning that the previous frame shows through
the transparent bits of the new frame) or &#39;motionBlur&#39; (previous frame is shown faintly
below the current one so to give a vague effect of motion blur).</p>

          
          <h3>Classes</h3>
          <ul class="classlist">
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/blend-controls.coffee.html#BlendControls">BlendControls</a></li>
            
          </ul>
          
          
        </div>
      </div>
      
      <div class="module">
        <div class="header">
          <a href="docs/deleteme/sourcesWithBlockComments/coffee/code-transformer.coffee.html"><h1>code-transformer.coffee</h1></a>
        </div>
        <div class="module-content">
          <p>Although LiveCodeLab is ultimately running Javascript code behind the scenes,
the user uses a simpler syntax which is basically coffeescript with a little bit of
extra sugar. CodeTransformer takes care of translating this simplified syntax to
Javascript. Also note that CodeTransformer might return a program that substituted
the program passed as input. This is because doOnce statements get transformed by
pre-prending a tick once they are run, which prevents them from being run again.</p>

          
          <h3>Classes</h3>
          <ul class="classlist">
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/code-transformer.coffee.html#CodeTransformer">CodeTransformer</a></li>
            
          </ul>
          
          
        </div>
      </div>
      
      <div class="module">
        <div class="header">
          <a href="docs/deleteme/sourcesWithBlockComments/coffee/colour-functions.coffee.html"><h1>colour-functions.coffee</h1></a>
        </div>
        <div class="module-content">
          <p>Closure compiler automatically replaces symbolic Constants.* names with their
values (it does it for everything it thinks it&#39;s a constant really).</p>

          
          <h3>Classes</h3>
          <ul class="classlist">
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/colour-functions.coffee.html#ColourFunctions">ColourFunctions</a></li>
            
          </ul>
          
          
        </div>
      </div>
      
      <div class="module">
        <div class="header">
          <a href="docs/deleteme/sourcesWithBlockComments/coffee/colour-literals.coffee.html"><h1>colour-literals.coffee</h1></a>
        </div>
        <div class="module-content">
          <p>Defines several color constant literals, e.g. &quot;red&quot; being 0xffff0000,
modified from processing.js with added the missing ones from the CSS standard,
which includes the spelling &quot;grey&quot; on top of &quot;gray&quot;
and also &quot;angleColor&quot;, used to dress objects with the normal material.</p>

          
          <h3>Classes</h3>
          <ul class="classlist">
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/colour-literals.coffee.html#ColourLiterals">ColourLiterals</a></li>
            
          </ul>
          
          
        </div>
      </div>
      
      <div class="module">
        <div class="header">
          <a href="docs/deleteme/sourcesWithBlockComments/coffee/editor/editor.coffee.html"><h1>editor.coffee</h1></a>
        </div>
        <div class="module-content">
          <p>The Editor is just a wrapper for the CodeMirror editor. Contains a couple of handful
functions and hooks-up the contents with the other parts of LiveCodeLab.</p>

          
          <h3>Classes</h3>
          <ul class="classlist">
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/editor/editor.coffee.html#Editor">Editor</a></li>
            
          </ul>
          
          
        </div>
      </div>
      
      <div class="module">
        <div class="header">
          <a href="docs/deleteme/sourcesWithBlockComments/coffee/event-router.coffee.html"><h1>event-router.coffee</h1></a>
        </div>
        <div class="module-content">
          <p>EventRouter bridges most events in LiveCodeLab. Error message pops up? Event router
steps in. Big cursor needs to shrink? It&#39;s the event router who stepped in. You get the
picture. Any part of LiveCodeLab can just register callbacks and trigger events, using
some descriptive strings as keys. Handy because it&#39;s a hub where one could attach
debugging and listing of all registered callbacks. Probably not a good idea to attach
rapid-fire events due to overheads.</p>

          
          <h3>Classes</h3>
          <ul class="classlist">
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/event-router.coffee.html#EventRouter">EventRouter</a></li>
            
          </ul>
          
          
        </div>
      </div>
      
      <div class="module">
        <div class="header">
          <a href="docs/deleteme/sourcesWithBlockComments/coffee/globals.coffee.html"><h1>globals.coffee</h1></a>
        </div>
        <div class="module-content">
          <p>Extend the Number prototype
This needs to stay globally defined
@param func
@param scope [optional]</p>

          
          
          <h3>Functions</h3>
          <ul class="functionlist">
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/globals.coffee.html#Number.prototype.times">Number.prototype.times(func, scope)</a></li>
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/globals.coffee.html#window.back">window.back()</a></li>
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/globals.coffee.html#window.forward">window.forward()</a></li>
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/globals.coffee.html#window.close">window.close()</a></li>
            
          </ul>
          
        </div>
      </div>
      
      <div class="module">
        <div class="header">
          <a href="docs/deleteme/sourcesWithBlockComments/coffee/graphics-commands.coffee.html"><h1>graphics-commands.coffee</h1></a>
        </div>
        <div class="module-content">
          <p>Please reference the colour-functions.js file for all colour-related
functions and lights-functions.js for lights, which use a similar
structure for caching and counting of light instances.</p>
<h1>Fundamentals</h1>
<p>There are a couple of fundamentals of LiveCodeLab and a couple of
complications of Three.js that shape the way
graphic primitives work in this file.</p>
<h2>LiveCodeLab uses immediate mode graphics</h2>
<p>First off, like Processing, LiveCodeLab shies away from &quot;retained&quot; graphics
and instead uses &quot;immediate mode&quot; graphics.
For context, &quot;immediate mode&quot; graphics means that when the user uses a graphic
primitive, he is
NOT given a handle that he can use to modify properties of that element at a
later stage, contrarily to flash, DOM, CSS, openGL and Three.JS
(to different degrees).
Retained graphic modes keep structures in memory that make easy for example
to do event handling (which object did I click?), hierarchy management
(parent/child relationships, container/content, etc), property tweaking
(change property X of object Y), and sometimes animation ( CoreAnimation from
Apple for example), collision/overlap detection. Note that openGL is retained
in that there are handles to geometry and textures, but little else is given
(no events, no input, no physics/overlap/collision/animation).
Also, retained graphics mode usually is smart about updating
only minimal parts of the screen that need updating rather than redrawing the
whole screen (again, openGL doesn&#39;t do that apart from basic frustum culling, but
for example there is nothing to detect occlusions and avoid painting occluded
objects).
There are a few drawbacks in retained modes: a) programs that manage
handles are more lengthy than programs that don&#39;t
b) they are often not needed for example in
2d sprites-based videogames c) most importantly,
they require deeper understanding of the underlying
model (e.g. which property can I change? What are those called? How do I change
parent/child relationship? How do events bubble up and where should I catch them?).
Processing and LiveCodeLab go for immediate mode. Once the primitive is invoked, it
becomes pixels and there is no built-in way to do input/event/hierarchies...
Rather, there are a few properties that are set as a global state and apply to all
objects. Examples are &quot;fill&quot; and &quot;stroke&quot;.</p>
<h2>Relationship between objects, meshes, geometry, materials...</h2>
<p>A Three.js object (or to be more precise, Object3D) can be a line or a mesh. A line
is a line, a mesh can be anything else depending on what the geometry of the mesh
is. There are more possible types such as particles, etc. but they are not currently
used in LiveCodeLab. An object needs one more thing: a material.</p>
<h2>Caching of objects</h2>
<p>Once created, objects are kept cached together with all possible materials that can be
associated with it. Each object has to have its own set of materials because
one can decide to draw one object in solid fill, one in normal color, one with
an ambient light (i.e. lambert material), etc.</p>
<h2>Objects are kept in the scene</h2>
<p>Once an object is added to the scene, it&#39;s never removed. Rather, it&#39;s hidden if it&#39;s
not used, but it&#39;s never removed. This is because adding/removing objects from the
scene is rather expensive. Note that Mr Doob mentioned via email that subsequent
versions of three.js have improved performance a lot, so it&#39;s worth trying another
approach.</p>
<h2>Strokes are managed via separate objects for stroke and fill</h2>
<p>There is a particular flag in Three.js materials for drawing wireframes. But materials
cannot be combined, i.e. only one is associated at any time with a geometry. So one
can either draw a wireframe or a fill. In previous versions of Three.js more than
one material could be associated, but that has been deprecated, see
<a href="https://github.com/mrdoob/three.js/issues/751">https://github.com/mrdoob/three.js/issues/751</a> and instead a
createMultiMaterialObject utility was put in place, which basically creates multiple
objects one for each material, see
<a href="https://github.com/mrdoob/three.js/blob/dev/src/extras/SceneUtils.js#L29">https://github.com/mrdoob/three.js/blob/dev/src/extras/SceneUtils.js#L29</a>
So the solution here is to create two disting objects.
One for the fills and one, slightly &quot;larger&quot;, for the strokes. In that way, the
strokes are visible &quot;in front&quot; of the fills, and the fills cover the strokes &quot;at
the back&quot;</p>
<h2>The order of materials matters</h2>
<p>When an object is created, it must be first rendered with the most complex material,
because internally in Three.js/WebGL memory is allocated only once. So a special
mechanism is put in place by which new objects are drawn with the normalMaterial
with scale 0, so they are rendered but they are invisible. In the next frame (i.e.
after the first render) the correct material is used.</p>
<h2>&quot;Spinning&quot;</h2>
<p>&quot;Spinning&quot; applies to all objects added to an empty frame: it makes all objects spin
for a few frames. This has been implemented for two reasons a) cosmetic b) the user
is likely to first use &quot;box&quot;, and without spinning that would look like a boring
square that appears without animation. Spinning gives many more cues: the environment
is 3d, the lighting is special by default and all faces have primary colors, things
animate. Without spinning, all those cues need to be further explained and demonstra
ted.</p>

          
          <h3>Classes</h3>
          <ul class="classlist">
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/graphics-commands.coffee.html#GraphicsCommands">GraphicsCommands</a></li>
            
          </ul>
          
          
        </div>
      </div>
      
      <div class="module">
        <div class="header">
          <a href="docs/deleteme/sourcesWithBlockComments/coffee/init.coffee.html"><h1>init.coffee</h1></a>
        </div>
        <div class="module-content">
          <p>Init.js takes care of the setup of the whole environment up to
cruise speed</p>

          
          
          <h3>Functions</h3>
          <ul class="functionlist">
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/init.coffee.html#isCanvasSupported">isCanvasSupported()</a></li>
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/init.coffee.html#startEnvironment">startEnvironment(paramsObject)</a></li>
            
          </ul>
          
        </div>
      </div>
      
      <div class="module">
        <div class="header">
          <a href="docs/deleteme/sourcesWithBlockComments/coffee/lights-commands.coffee.html"><h1>lights-commands.coffee</h1></a>
        </div>
        <div class="module-content">
          <p>Implementation of all lights-related commands.</p>

          
          <h3>Classes</h3>
          <ul class="classlist">
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/lights-commands.coffee.html#LightsCommands">LightsCommands</a></li>
            
          </ul>
          
          
        </div>
      </div>
      
      <div class="module">
        <div class="header">
          <a href="docs/deleteme/sourcesWithBlockComments/coffee/livecodelab-core.coffee.html"><h1>livecodelab-core.coffee</h1></a>
        </div>
        <div class="module-content">
          <p>A LiveCodeLabCore instance packs together the following parts:</p>
<ul>
<li>timeKeeper</li>
<li>three</li>
<li>threeJsSystem</li>
<li>matrixCommands</li>
<li>blendControls</li>
<li>soundSystem</li>
<li>colourFunctions</li>
<li>backgroundPainter</li>
<li>graphicsCommands</li>
<li>lightSystem </li>
<li>drawFunctionRunner</li>
<li>codeTransformer</li>
<li>renderer</li>
<li><p>animationLoop</p>
<p>LiveCodeLab is built one part at a time, and the arguments in the constructor
tell how they depend on each other at construction time and how they
interact at runtime.</p>
</li>
<li><p><em>A constructor with no arguments</em> (or where the arguments are just passed
by the caller of the very createLiveCodeLabCore function we are in),
such as createColourFunctions, is a part
that does not need any other part at construction time and it doesn&#39;t interact
with any of the other parts at run time.</p>
</li>
<li><em>A constructor with arguments other than &quot;liveCodeLabCoreInstance&quot;</em>
(such as threeJsSystem) only needs the parts passed at construction time for its
own construction, and it can only interact with such parts at runtime.</li>
<li><p><em>A constructor which contains the &quot;liveCodeLabCoreInstance&quot; argument</em>, such as
codeTransformer, might or might not need other parts for its own construction
(if they are passed as arguments in addition to the &quot;liveCodeLabCoreInstance&quot; argument)
but it does interact at runtime with other parts not passed in the constructor
argument.</p>
<p>So, for determining the order of the constructors, one can just look at the
dependencies dictated by the arguments other than the &quot;liveCodeLabCoreInstance&quot;
argument. The &quot;liveCodeLabCoreInstance&quot; parameter
doesn&#39;t create dependencies at creation time,
it&#39;s just used by the parts to reference other parts that they need to interact to
at runtime.</p>
<p>It might well be that at runtime part A interacts with part B and viceversa.
This is why runtime interactions are not restricted to parts passed
as arguments at construction
time, because one would need to pass constructed part A to the constructor of part B
and viceversa, which is obviously impossible. This is why the runtime interactions
happen through the mother of all parts, i.e. &quot;liveCodeLabCoreInstance&quot; itself.</p>
<p>To determine which parts any single part interacts with at runtime, one
has to check all the parameters passed to the constructor. The passed parts are likely
to mean that there is an interaction at runtime. If the &quot;mother&quot;
&quot;liveCodeLabCoreInstance&quot; is passed to the constructor, then one case to look for
all &quot;liveCodeLabCoreInstance&quot; occurrences and see which of its children are
accessed.</p>
</li>
</ul>

          
          <h3>Classes</h3>
          <ul class="classlist">
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/livecodelab-core.coffee.html#LiveCodeLabCore">LiveCodeLabCore</a></li>
            
          </ul>
          
          
        </div>
      </div>
      
      <div class="module">
        <div class="header">
          <a href="docs/deleteme/sourcesWithBlockComments/coffee/math.coffee.html"><h1>math.coffee</h1></a>
        </div>
        <div class="module-content">
          <p>Calculates the absolute value (magnitude) of a number. The absolute value of a number is always positive.</p>
<p>@param {int|float} value   int or float</p>
<p>@returns {int|float}</p>

          
          
          <h3>Functions</h3>
          <ul class="functionlist">
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/math.coffee.html#constrain">constrain(aNumber, aMin, aMax)</a></li>
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/math.coffee.html#dist">dist()</a></li>
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/math.coffee.html#lerp">lerp(value1, value2, amt)</a></li>
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/math.coffee.html#mag">mag(a, b, c)</a></li>
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/math.coffee.html#map">map(value, istart, istop, ostart, ostop)</a></li>
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/math.coffee.html#max">max()</a></li>
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/math.coffee.html#min">min()</a></li>
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/math.coffee.html#norm">norm(aNumber, low, high)</a></li>
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/math.coffee.html#sq">sq(aNumber)</a></li>
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/math.coffee.html#degrees">degrees(aAngle)</a></li>
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/math.coffee.html#radians">radians(aAngle)</a></li>
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/math.coffee.html#random">random()</a></li>
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/math.coffee.html#Marsaglia">Marsaglia(i1, i2)</a></li>
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/math.coffee.html#Marsaglia.createRandomized">Marsaglia.createRandomized()</a></li>
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/math.coffee.html#randomSeed">randomSeed(seed)</a></li>
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/math.coffee.html#Random">Random(seed)</a></li>
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/math.coffee.html#PerlinNoise">PerlinNoise(seed)</a></li>
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/math.coffee.html#noise">noise(x, y, z)</a></li>
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/math.coffee.html#noiseDetail">noiseDetail(octaves, fallout)</a></li>
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/math.coffee.html#noiseSeed">noiseSeed(seed)</a></li>
            
          </ul>
          
        </div>
      </div>
      
      <div class="module">
        <div class="header">
          <a href="docs/deleteme/sourcesWithBlockComments/coffee/matrix-commands.coffee.html"><h1>matrix-commands.coffee</h1></a>
        </div>
        <div class="module-content">
          <p>Takes care of all matrix-related commands.</p>

          
          <h3>Classes</h3>
          <ul class="classlist">
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/matrix-commands.coffee.html#MatrixCommands">MatrixCommands</a></li>
            
          </ul>
          
          
        </div>
      </div>
      
      <div class="module">
        <div class="header">
          <a href="docs/deleteme/sourcesWithBlockComments/coffee/parser.coffee.html"><h1>parser.coffee</h1></a>
        </div>
        <div class="module-content">
          <p>This could be an alternative to the lexer and the many regular expressions used
in the Autocoder and in the CodeTransformer. Not used at the moment. In development
stage.</p>

          
          <h3>Classes</h3>
          <ul class="classlist">
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/parser.coffee.html#Parser">Parser</a></li>
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/parser.coffee.html#CodeChecker">CodeChecker</a></li>
            
          </ul>
          
          
        </div>
      </div>
      
      <div class="module">
        <div class="header">
          <a href="docs/deleteme/sourcesWithBlockComments/coffee/program-loader.coffee.html"><h1>program-loader.coffee</h1></a>
        </div>
        <div class="module-content">
          <p>ProgramLoader takes care of managing the URL and editor content when the user navigates
through demos and examples - either by selecting menu entries, or by clicking back/forward
arrow, or by landing on a URL with a hashtag.</p>

          
          <h3>Classes</h3>
          <ul class="classlist">
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/program-loader.coffee.html#ProgramLoader">ProgramLoader</a></li>
            
          </ul>
          
          
        </div>
      </div>
      
      <div class="module">
        <div class="header">
          <a href="docs/deleteme/sourcesWithBlockComments/coffee/program-runner.coffee.html"><h1>program-runner.coffee</h1></a>
        </div>
        <div class="module-content">
          <p>ProgramRunner manages the running function as it runs. E.g. this is not a
translation step, this is managing things such as the actually running of the
latest &quot;stable&quot; function and keeping track of when a function appears to be stable,
and reinstating the last stable function if the current one throws a runtime error.</p>

          
          <h3>Classes</h3>
          <ul class="classlist">
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/program-runner.coffee.html#ProgramRunner">ProgramRunner</a></li>
            
          </ul>
          
          
        </div>
      </div>
      
      <div class="module">
        <div class="header">
          <a href="docs/deleteme/sourcesWithBlockComments/coffee/renderer.coffee.html"><h1>renderer.coffee</h1></a>
        </div>
        <div class="module-content">
          <p>The rendering requires some special steps that allow the display list
to be reused as much as possible between frames.</p>

          
          <h3>Classes</h3>
          <ul class="classlist">
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/renderer.coffee.html#Renderer">Renderer</a></li>
            
          </ul>
          
          
        </div>
      </div>
      
      <div class="module">
        <div class="header">
          <a href="docs/deleteme/sourcesWithBlockComments/coffee/sound/samplebank.coffee.html"><h1>samplebank.coffee</h1></a>
        </div>
        <div class="module-content">
          <p>The SampleBank is responsible for holding the filepaths to any audio that
needs to be loaded by the browser.</p>
<p>It automatically handles returning the ogg or mp3 file path.</p>

          
          <h3>Classes</h3>
          <ul class="classlist">
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/sound/samplebank.coffee.html#SampleBank">SampleBank</a></li>
            
          </ul>
          
          
        </div>
      </div>
      
      <div class="module">
        <div class="header">
          <a href="docs/deleteme/sourcesWithBlockComments/coffee/sound/sound-system.coffee.html"><h1>sound-system.coffee</h1></a>
        </div>
        <div class="module-content">
          <p>SoundSystem tries to abstract away different ways of playing sound, according to
weird performance characteristics of each browser (ad probably, OS). Cross-browser
sound playing is really in a sorry state, we are trying to make do here.</p>

          
          <h3>Classes</h3>
          <ul class="classlist">
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/sound/sound-system.coffee.html#SoundSystem">SoundSystem</a></li>
            
          </ul>
          
          
        </div>
      </div>
      
      <div class="module">
        <div class="header">
          <a href="docs/deleteme/sourcesWithBlockComments/coffee/text-dimming.coffee.html"><h1>text-dimming.coffee</h1></a>
        </div>
        <div class="module-content">
          <p>Simple helper to handle the code dimming. When to trigger dimming and un-dimming and
keeping track of status of the dedicated &quot;automatic dimming&quot; toggle switch.</p>

          
          <h3>Classes</h3>
          <ul class="classlist">
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/text-dimming.coffee.html#EditorDimmer">EditorDimmer</a></li>
            
          </ul>
          
          
        </div>
      </div>
      
      <div class="module">
        <div class="header">
          <a href="docs/deleteme/sourcesWithBlockComments/coffee/threejs-system.coffee.html"><h1>threejs-system.coffee</h1></a>
        </div>
        <div class="module-content">
          <p>Sets up canvas or webgl Threejs renderer based on browser capabilities and flags passed
in the constructor. Sets up all the post-filtering steps.</p>

          
          <h3>Classes</h3>
          <ul class="classlist">
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/threejs-system.coffee.html#ThreeJsSystem">ThreeJsSystem</a></li>
            
          </ul>
          
          
        </div>
      </div>
      
      <div class="module">
        <div class="header">
          <a href="docs/deleteme/sourcesWithBlockComments/coffee/time-keeper.coffee.html"><h1>time-keeper.coffee</h1></a>
        </div>
        <div class="module-content">
          <p>Keeps the time. A small thing to do, but it allows tricks such as setting a fake time
for testing purposes, and avoiding repeated and unnecessary invokation of the Date and
getTime browser functions.</p>

          
          <h3>Classes</h3>
          <ul class="classlist">
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/time-keeper.coffee.html#TimeKeeper">TimeKeeper</a></li>
            
          </ul>
          
          
        </div>
      </div>
      
      <div class="module">
        <div class="header">
          <a href="docs/deleteme/sourcesWithBlockComments/coffee/ui.coffee.html"><h1>ui.coffee</h1></a>
        </div>
        <div class="module-content">
          <p>Ui handles all things UI such as the menus, the notification popups, the editor panel,
the big flashing cursor, the stats widget...</p>

          
          <h3>Classes</h3>
          <ul class="classlist">
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/ui.coffee.html#Ui">Ui</a></li>
            
          </ul>
          
          
        </div>
      </div>
      
      <div class="module">
        <div class="header">
          <a href="docs/deleteme/sourcesWithBlockComments/coffee/url-router.coffee.html"><h1>url-router.coffee</h1></a>
        </div>
        <div class="module-content">
          <p>Helper class to manage URL hash location.</p>

          
          <h3>Classes</h3>
          <ul class="classlist">
            
            <li><a href="docs/deleteme/sourcesWithBlockComments/coffee/url-router.coffee.html#UrlRouter">UrlRouter</a></li>
            
          </ul>
          
          
        </div>
      </div>
      
    </div>
  </div>
</body>
</html>
