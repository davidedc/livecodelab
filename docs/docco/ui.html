<!DOCTYPE html>  <html> <head>   <title>ui.coffee</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="animation-loop.html">                 animation-loop.coffee               </a>                                           <a class="source" href="autocoder.html">                 autocoder.coffee               </a>                                           <a class="source" href="lexer.html">                 lexer.coffee               </a>                                           <a class="source" href="background-painter.html">                 background-painter.coffee               </a>                                           <a class="source" href="big-cursor.html">                 big-cursor.coffee               </a>                                           <a class="source" href="blend-controls.html">                 blend-controls.coffee               </a>                                           <a class="source" href="code-transformer.html">                 code-transformer.coffee               </a>                                           <a class="source" href="colour-functions.html">                 colour-functions.coffee               </a>                                           <a class="source" href="colour-literals.html">                 colour-literals.coffee               </a>                                           <a class="source" href="editor.html">                 editor.coffee               </a>                                           <a class="source" href="event-router.html">                 event-router.coffee               </a>                                           <a class="source" href="globals.html">                 globals.coffee               </a>                                           <a class="source" href="graphics-commands.html">                 graphics-commands.coffee               </a>                                           <a class="source" href="init.html">                 init.coffee               </a>                                           <a class="source" href="lights-commands.html">                 lights-commands.coffee               </a>                                           <a class="source" href="livecodelab-core.html">                 livecodelab-core.coffee               </a>                                           <a class="source" href="math.html">                 math.coffee               </a>                                           <a class="source" href="matrix-commands.html">                 matrix-commands.coffee               </a>                                           <a class="source" href="parser.html">                 parser.coffee               </a>                                           <a class="source" href="program-loader.html">                 program-loader.coffee               </a>                                           <a class="source" href="program-runner.html">                 program-runner.coffee               </a>                                           <a class="source" href="renderer.html">                 renderer.coffee               </a>                                           <a class="source" href="samplebank.html">                 samplebank.coffee               </a>                                           <a class="source" href="sound-system.html">                 sound-system.coffee               </a>                                           <a class="source" href="text-dimming.html">                 text-dimming.coffee               </a>                                           <a class="source" href="threejs-system.html">                 threejs-system.coffee               </a>                                           <a class="source" href="time-keeper.html">                 time-keeper.coffee               </a>                                           <a class="source" href="ui.html">                 ui.coffee               </a>                                           <a class="source" href="url-router.html">                 url-router.coffee               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               ui.coffee             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>Ui handles all things UI such as the menus, the notification popups,
the editor panel, the big flashing cursor, the stats widget...</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="k">class</span> <span class="nx">Ui</span>

  <span class="nv">constructor: </span><span class="nf">(@eventRouter, @stats, @programLoader) -&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>Setup Event Listeners</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">@eventRouter</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span>
      <span class="s">&quot;report-runtime-or-compile-time-error&quot;</span><span class="p">,</span>
      <span class="nf">(e) =&gt;</span> <span class="nx">@checkErrorAndReport</span><span class="p">(</span><span class="nx">e</span><span class="p">),</span>
      <span class="nx">@</span>
    <span class="p">)</span>
    <span class="nx">@eventRouter</span><span class="p">.</span><span class="nx">bind</span> <span class="s">&quot;clear-error&quot;</span><span class="p">,</span> <span class="p">(</span><span class="o">=&gt;</span><span class="nx">@clearError</span><span class="p">()),</span> <span class="nx">@</span>
    <span class="nx">@eventRouter</span><span class="p">.</span><span class="nx">bind</span> <span class="s">&quot;autocoder-button-pressed&quot;</span><span class="p">,</span> <span class="nf">(state) =&gt;</span>
      <span class="k">if</span> <span class="nx">state</span> <span class="o">is</span> <span class="kc">true</span>
        <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">autocodeIndicatorContainer&quot;</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="s">&quot;Autocode: on&quot;</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span>
          <span class="s">&quot;background-color&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="err">#</span><span class="s">FF0000&quot;</span>
        <span class="p">)</span>
      <span class="k">else</span>
        <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">autocodeIndicatorContainer&quot;</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="s">&quot;Autocode&quot;</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span>
          <span class="s">&quot;background-color&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span>
        <span class="p">)</span>

    <span class="nx">@eventRouter</span><span class="p">.</span><span class="nx">bind</span> <span class="s">&quot;autocoderbutton-flash&quot;</span><span class="p">,</span> <span class="o">=&gt;</span>
      <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">autocodeIndicatorContainer&quot;</span><span class="p">).</span><span class="nx">fadeOut</span><span class="p">(</span><span class="mi">100</span><span class="p">).</span><span class="nx">fadeIn</span> <span class="mi">100</span>

    <span class="nx">@eventRouter</span><span class="p">.</span><span class="nx">bind</span> <span class="s">&quot;auto-hide-code-button-pressed&quot;</span><span class="p">,</span> <span class="nf">(state) =&gt;</span>
      <span class="k">if</span> <span class="nx">state</span> <span class="o">is</span> <span class="kc">true</span>
        <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">dimCodeButtonContainer&quot;</span><span class="p">).</span><span class="nx">html</span> <span class="s">&quot;Hide Code: on&quot;</span>
      <span class="k">else</span>
        <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">dimCodeButtonContainer&quot;</span><span class="p">).</span><span class="nx">html</span> <span class="s">&quot;Hide Code: off&quot;</span>

  <span class="nv">resizeCanvas: </span><span class="nf">(canvasId) -&gt;</span>
    <span class="nv">canvas = </span><span class="nx">$</span><span class="p">(</span><span class="nx">canvasId</span><span class="p">)</span>
    <span class="nv">scale =</span>
      <span class="nv">x: </span><span class="mi">1</span>
      <span class="nv">y: </span><span class="mi">1</span>

    <span class="nv">scale.x = </span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">innerWidth</span> <span class="o">+</span> <span class="mi">40</span><span class="p">)</span> <span class="o">/</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">width</span><span class="p">()</span>
    <span class="nv">scale.y = </span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">innerHeight</span> <span class="o">+</span> <span class="mi">40</span><span class="p">)</span> <span class="o">/</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">height</span><span class="p">()</span>
    <span class="nv">scale = </span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span> <span class="o">+</span> <span class="s">&quot;, &quot;</span> <span class="o">+</span> <span class="nx">scale</span><span class="p">.</span><span class="nx">y</span>
    </pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>this code below is if one wants to keep the aspect ratio
but I mean one doesn't necessarily resize the window
keeping the same aspect ratio.</p>             </td>             <td class="code">               <div class="highlight"><pre>    </pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>if (scale.x &lt; 1 || scale.y &lt; 1) {
    scale = '1, 1';
} else if (scale.x &lt; scale.y) {
    scale = scale.x + ', ' + scale.x;
} else {
    scale = scale.y + ', ' + scale.y;
}</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">canvas</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s">&quot;-ms-transform-origin&quot;</span><span class="p">,</span> <span class="s">&quot;left top&quot;</span><span class="p">)</span>
          <span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s">&quot;-webkit-transform-origin&quot;</span><span class="p">,</span> <span class="s">&quot;left top&quot;</span><span class="p">)</span>
          <span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s">&quot;-moz-transform-origin&quot;</span><span class="p">,</span> <span class="s">&quot;left top&quot;</span><span class="p">)</span>
          <span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s">&quot;-o-transform-origin&quot;</span><span class="p">,</span> <span class="s">&quot;left top&quot;</span><span class="p">)</span>
          <span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s">&quot;transform-origin&quot;</span><span class="p">,</span> <span class="s">&quot;left top&quot;</span><span class="p">)</span>
          <span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s">&quot;-ms-transform&quot;</span><span class="p">,</span> <span class="s">&quot;scale(&quot;</span> <span class="o">+</span> <span class="nx">scale</span> <span class="o">+</span> <span class="s">&quot;)&quot;</span><span class="p">)</span>
          <span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s">&quot;-webkit-transform&quot;</span><span class="p">,</span> <span class="s">&quot;scale3d(&quot;</span> <span class="o">+</span> <span class="nx">scale</span> <span class="o">+</span> <span class="s">&quot;, 1)&quot;</span><span class="p">)</span>
          <span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s">&quot;-moz-transform&quot;</span><span class="p">,</span> <span class="s">&quot;scale(&quot;</span> <span class="o">+</span> <span class="nx">scale</span> <span class="o">+</span> <span class="s">&quot;)&quot;</span><span class="p">)</span>
          <span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s">&quot;-o-transform&quot;</span><span class="p">,</span> <span class="s">&quot;scale(&quot;</span> <span class="o">+</span> <span class="nx">scale</span> <span class="o">+</span> <span class="s">&quot;)&quot;</span><span class="p">)</span>
          <span class="p">.</span><span class="nx">css</span> <span class="s">&quot;transform&quot;</span><span class="p">,</span> <span class="s">&quot;scale(&quot;</span> <span class="o">+</span> <span class="nx">scale</span> <span class="o">+</span> <span class="s">&quot;)&quot;</span>

  </pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>TODO In theory we want to re-draw the background because the
aspect ration might have changed.
But for the time being we only have vertical
gradients so that's not going to be a problem.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">adjustCodeMirrorHeight: </span><span class="nf">-&gt;</span>
    <span class="nx">$</span><span class="p">(</span><span class="s">&quot;.CodeMirror-scroll&quot;</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span>
      <span class="s">&quot;height&quot;</span><span class="p">,</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerHeight</span> <span class="o">-</span> <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">theMenu&quot;</span><span class="p">).</span><span class="nx">height</span><span class="p">()</span>
    <span class="p">)</span>

  </pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>resizing the text area is necessary otherwise
as the user types to the end of it, instead of just scrolling
the content leaving all the other parts of the page where
they are, it expands and it pushes down
the view of the page, meaning that the canvas goes up and
the menu disappears
so we have to resize it at launch and also every time the window
is resized.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">fullscreenify: </span><span class="nf">(canvasId) -&gt;</span>
    <span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span> <span class="s">&quot;resize&quot;</span><span class="p">,</span> <span class="p">(</span><span class="o">=&gt;</span>
      <span class="nx">@adjustCodeMirrorHeight</span><span class="p">()</span>
      <span class="nx">@resizeCanvas</span> <span class="nx">canvasId</span>
    <span class="p">),</span> <span class="kc">false</span>
    <span class="nx">@resizeCanvas</span> <span class="nx">canvasId</span>

  <span class="nv">checkErrorAndReport: </span><span class="nf">(e) -&gt;</span>
    <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">errorMessageDiv&quot;</span><span class="p">).</span><span class="nx">css</span> <span class="s">&quot;color&quot;</span><span class="p">,</span> <span class="s">&quot;red&quot;</span>
    </pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>if the object is an exception then get the message
otherwise e should just be a string</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nv">errorMessage = </span><span class="nx">e</span><span class="p">.</span><span class="nx">message</span> <span class="o">or</span> <span class="nx">e</span>
    <span class="k">if</span> <span class="nx">errorMessage</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s">&quot;Unexpected &#39;INDENT&#39;&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span>
      <span class="nv">errorMessage = </span><span class="s">&quot;weird indentation&quot;</span>
    <span class="k">else</span> <span class="k">if</span> <span class="nx">errorMessage</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s">&quot;Unexpected &#39;TERMINATOR&#39;&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span>
      <span class="nv">errorMessage = </span><span class="s">&quot;line not complete&quot;</span>
    <span class="k">else</span> <span class="k">if</span> <span class="nx">errorMessage</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s">&quot;Unexpected &#39;CALL_END&#39;&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span>
      <span class="nv">errorMessage = </span><span class="s">&quot;line not complete&quot;</span>
    <span class="k">else</span> <span class="k">if</span> <span class="nx">errorMessage</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s">&quot;Unexpected &#39;}&#39;&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span>
      <span class="nv">errorMessage = </span><span class="s">&quot;something wrong&quot;</span>
    <span class="k">else</span> <span class="k">if</span> <span class="nx">errorMessage</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s">&quot;Unexpected &#39;MATH&#39;&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span>
      <span class="nv">errorMessage = </span><span class="s">&quot;weird arithmetic there&quot;</span>
    <span class="k">else</span> <span class="k">if</span> <span class="nx">errorMessage</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s">&quot;Unexpected &#39;LOGIC&#39;&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span>
      <span class="nv">errorMessage = </span><span class="s">&quot;odd expression thingy&quot;</span>
    <span class="k">else</span> <span class="k">if</span> <span class="nx">errorMessage</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s">&quot;Unexpected &#39;NUMBER&#39;&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span>
      <span class="nv">errorMessage = </span><span class="s">&quot;lost number?&quot;</span>
    <span class="k">else</span> <span class="k">if</span> <span class="nx">errorMessage</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s">&quot;Unexpected &#39;NUMBER&#39;&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span>
      <span class="nv">errorMessage = </span><span class="s">&quot;lost number?&quot;</span>
    <span class="k">else</span>
      <span class="nv">errorMessage = </span><span class="nx">errorMessage</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/ReferenceError:\s/g</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="k">if</span><span class="p">(</span>
        <span class="nx">errorMessage</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s">&quot;ReferenceError&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span>
      <span class="p">)</span>
    <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">errorMessageDiv&quot;</span><span class="p">).</span><span class="nx">text</span> <span class="nx">errorMessage</span>

  <span class="nv">clearError: </span><span class="nf">-&gt;</span>
    <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">errorMessageDiv&quot;</span><span class="p">).</span><span class="nx">css</span> <span class="s">&quot;color&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="err">#</span><span class="s">000000&quot;</span>
    <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">errorMessageDiv&quot;</span><span class="p">).</span><span class="nx">text</span> <span class="s">&quot;&quot;</span>

  <span class="nv">soundSystemOk: </span><span class="nf">-&gt;</span>
    <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">soundSystemStatus&quot;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s">&quot;Sound System On&quot;</span><span class="p">).</span><span class="nx">removeClass</span><span class="p">(</span><span class="s">&quot;off&quot;</span><span class="p">)</span>

  <span class="nv">hideStatsWidget: </span><span class="nf">-&gt;</span>
    <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">statsWidget&quot;</span><span class="p">).</span><span class="nx">hide</span><span class="p">()</span>

  </pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>console.log('hiding stats widget');</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">showStatsWidget: </span><span class="nf">-&gt;</span>
    </pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>I wish I could tell you why showing the widget straight away doesn't work.
Postponing a little bit makes this work. It doesn't make any sense.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">setTimeout</span> <span class="s">&quot;$(\&quot;</span><span class="err">#</span><span class="s">statsWidget\&quot;).show()&quot;</span><span class="p">,</span> <span class="mi">1</span>

  </pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>console.log('showing stats widget');</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">setup: </span><span class="nf">-&gt;</span>
    <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span> <span class="o">=&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>we need a way to reference the eventRouter without
resorting to "@", because the "@"s below need to stick
to the UI elements that generated the events</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nv">eventRouter = </span><span class="nx">@eventRouter</span>
      
      <span class="nx">$</span><span class="p">(</span><span class="s">&#39;&lt;span &gt;LiveCodeLab&lt;/span&gt;&#39;</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span>
        <span class="nx">$</span><span class="p">(</span><span class="s">&#39;&lt;li&gt;&#39;</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span>
          <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#nav&#39;</span><span class="p">)</span>
        <span class="p">)</span>
      <span class="p">).</span><span class="nx">click</span> <span class="o">=&gt;</span>
        <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">aboutWindow&quot;</span><span class="p">).</span><span class="nx">modal</span><span class="p">()</span>
        <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">simplemodal-container&quot;</span><span class="p">).</span><span class="nx">height</span> <span class="mi">250</span>
        <span class="kc">false</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>DEMOS
(note that the code for the tutorials is the same,
just with "tutorial" instead of "demo")
insert all the demos in the menu</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">$</span><span class="p">(</span><span class="s">&#39;&lt;span &gt;Demos&lt;/span&gt;&#39;</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span>
        <span class="nx">$</span><span class="p">(</span><span class="s">&#39;&lt;li&gt;&#39;</span><span class="p">)</span>
          <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">,</span> <span class="s">&#39;demos&#39;</span><span class="p">)</span>
          <span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="s">&#39;current&#39;</span><span class="p">)</span>
          <span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="s">&#39;sf-parent&#39;</span><span class="p">)</span>
          <span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s">&#39;#nav&#39;</span><span class="p">))</span>
      <span class="p">)</span>

      <span class="nx">$</span><span class="p">(</span><span class="s">&quot;&lt;ul id=&#39;ulForDemos&#39;&gt;&lt;/ul&gt;&quot;</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span>
        <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#demos&#39;</span><span class="p">)</span>
      <span class="p">)</span>

      <span class="nv">allDemos = </span><span class="nx">@programLoader</span><span class="p">.</span><span class="nx">programs</span><span class="p">.</span><span class="nx">demos</span></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <p>Create an object with a property for each submenu.
That property contains an array with all the demos that belong to
that submenu.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nv">demoSubmenus = </span><span class="p">{}</span>
      <span class="k">for</span> <span class="nx">demo</span> <span class="k">of</span> <span class="nx">allDemos</span>
        <span class="nv">submenuOfThisDemo = </span><span class="nx">allDemos</span><span class="p">[</span><span class="nx">demo</span><span class="p">].</span><span class="nx">submenu</span>
        <span class="nx">demoSubmenus</span><span class="p">[</span><span class="nx">submenuOfThisDemo</span><span class="p">]</span> <span class="o">?=</span> <span class="p">[]</span> <span class="c1"># create array if it didn&#39;t exist</span>
        <span class="nx">demoSubmenus</span><span class="p">[</span><span class="nx">submenuOfThisDemo</span><span class="p">].</span><span class="nx">push</span><span class="p">(</span><span class="nx">demo</span><span class="p">)</span>

      <span class="k">for</span> <span class="nx">demoSubmenu</span> <span class="k">of</span> <span class="nx">demoSubmenus</span>
        
        <span class="nv">demoSubmenuNoSpaces = </span><span class="nx">demoSubmenu</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">,</span><span class="s">&quot;_&quot;</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>insert the submenu in the first level</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">$</span><span class="p">(</span><span class="s">&quot;&lt;li&gt;&lt;/li&gt;&quot;</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span>
          <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#ulForDemos&#39;</span><span class="p">)</span>
        <span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">,</span> <span class="s">&#39;hookforDemos&#39;</span> <span class="o">+</span> <span class="nx">demoSubmenuNoSpaces</span><span class="p">)</span>

        <span class="nx">$</span><span class="p">(</span><span class="s">&quot;&lt;span&gt;</span><span class="si">#{</span><span class="nx">demoSubmenu</span><span class="si">}</span><span class="s">&lt;/span&gt;&quot;</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span>
          <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#hookforDemos&#39;</span> <span class="o">+</span> <span class="nx">demoSubmenuNoSpaces</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="nx">$</span><span class="p">(</span><span class="s">&quot;&lt;ul id=&#39;</span><span class="si">#{</span><span class="nx">demoSubmenuNoSpaces</span><span class="si">}</span><span class="s">&#39;&gt;&lt;/ul&gt;&quot;</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span>
          <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#hookforDemos&#39;</span> <span class="o">+</span> <span class="nx">demoSubmenuNoSpaces</span><span class="p">)</span>
        <span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <p>now take each demo that belongs to this submenu and put it there</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">for</span> <span class="nx">demo</span> <span class="k">in</span> <span class="nx">demoSubmenus</span><span class="p">[</span><span class="nx">demoSubmenu</span><span class="p">]</span>
          <span class="nv">a = </span><span class="s">&quot;&quot;&quot;&lt;li&gt;</span>
<span class="s">                 &lt;a id=&#39;</span><span class="si">#{</span><span class="nx">demo</span><span class="si">}</span><span class="s">&#39;&gt;</span>
<span class="s">                 </span><span class="si">#{</span><span class="nx">@programLoader</span><span class="p">.</span><span class="nx">programs</span><span class="p">.</span><span class="nx">demos</span><span class="p">[</span><span class="nx">demo</span><span class="p">].</span><span class="nx">title</span><span class="si">}</span><span class="s"></span>
<span class="s">                 &lt;/a&gt;</span>
<span class="s">                 &lt;/li&gt;&quot;&quot;&quot;</span>
          <span class="nx">$</span><span class="p">(</span><span class="nx">a</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#&#39;</span><span class="o">+</span><span class="nx">demoSubmenuNoSpaces</span><span class="p">)</span>
          <span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p>TUTORIALS
(note that the code for the demos is the same,
just with "demo" instead of "tutorial")
insert all the tutorials in the menu</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">$</span><span class="p">(</span><span class="s">&#39;&lt;span &gt;Tutorials&lt;/span&gt;&#39;</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span>
        <span class="nx">$</span><span class="p">(</span><span class="s">&#39;&lt;li&gt;&#39;</span><span class="p">)</span>
          <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">,</span> <span class="s">&#39;tutorials&#39;</span><span class="p">)</span>
          <span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="s">&#39;current&#39;</span><span class="p">)</span>
          <span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="s">&#39;sf-parent&#39;</span><span class="p">)</span>
          <span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s">&#39;#nav&#39;</span><span class="p">))</span>
      <span class="p">)</span>

      <span class="nx">$</span><span class="p">(</span><span class="s">&quot;&lt;ul id=&#39;ulForTutorials&#39;&gt;&lt;/ul&gt;&quot;</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span>
        <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#tutorials&#39;</span><span class="p">)</span>
      <span class="p">)</span>

      <span class="nv">allTutorials = </span><span class="nx">@programLoader</span><span class="p">.</span><span class="nx">programs</span><span class="p">.</span><span class="nx">tutorials</span></pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <p>Create an object with a property for each submenu.
That property contains an array with all the tutorials that belong to
that submenu.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nv">tutorialSubmenus = </span><span class="p">{}</span>
      <span class="k">for</span> <span class="nx">tutorial</span> <span class="k">of</span> <span class="nx">allTutorials</span>
        <span class="nv">submenuOfThisTutorial = </span><span class="nx">allTutorials</span><span class="p">[</span><span class="nx">tutorial</span><span class="p">].</span><span class="nx">submenu</span></pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <p>create array if it didn't exist</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">tutorialSubmenus</span><span class="p">[</span><span class="nx">submenuOfThisTutorial</span><span class="p">]</span> <span class="o">?=</span> <span class="p">[]</span>
        <span class="nx">tutorialSubmenus</span><span class="p">[</span><span class="nx">submenuOfThisTutorial</span><span class="p">].</span><span class="nx">push</span><span class="p">(</span><span class="nx">tutorial</span><span class="p">)</span>

      <span class="k">for</span> <span class="nx">tutorialSubmenu</span> <span class="k">of</span> <span class="nx">tutorialSubmenus</span>
        
        <span class="nv">tutorialSubmenuNoSpaces = </span><span class="nx">tutorialSubmenu</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">,</span><span class="s">&quot;_&quot;</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <p>insert the submenu in the first level</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">$</span><span class="p">(</span><span class="s">&quot;&lt;li&gt;&lt;/li&gt;&quot;</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span>
          <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#ulForTutorials&#39;</span><span class="p">)</span>
        <span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">,</span> <span class="s">&#39;hookforTutorials&#39;</span> <span class="o">+</span> <span class="nx">tutorialSubmenuNoSpaces</span><span class="p">)</span>

        <span class="nx">$</span><span class="p">(</span><span class="s">&quot;&lt;span&gt;</span><span class="si">#{</span><span class="nx">tutorialSubmenu</span><span class="si">}</span><span class="s">&lt;/span&gt;&quot;</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span>
          <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#hookforTutorials&#39;</span> <span class="o">+</span> <span class="nx">tutorialSubmenuNoSpaces</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="nx">$</span><span class="p">(</span><span class="s">&quot;&lt;ul id=&#39;</span><span class="si">#{</span><span class="nx">tutorialSubmenuNoSpaces</span><span class="si">}</span><span class="s">&#39;&gt;&lt;/ul&gt;&quot;</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span>
          <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#hookforTutorials&#39;</span> <span class="o">+</span> <span class="nx">tutorialSubmenuNoSpaces</span><span class="p">)</span>
        <span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-21">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-21">&#182;</a>               </div>               <p>now take each tutorial that belongs to this submenu and put it there</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">for</span> <span class="nx">tutorial</span> <span class="k">in</span> <span class="nx">tutorialSubmenus</span><span class="p">[</span><span class="nx">tutorialSubmenu</span><span class="p">]</span>
          <span class="nv">a = </span><span class="s">&quot;&quot;&quot;&lt;li&gt;</span>
<span class="s">                 &lt;a id=&#39;</span><span class="si">#{</span><span class="nx">tutorial</span><span class="si">}</span><span class="s">&#39;&gt;</span>
<span class="s">                 </span><span class="si">#{</span><span class="nx">@programLoader</span><span class="p">.</span><span class="nx">programs</span><span class="p">.</span><span class="nx">tutorials</span><span class="p">[</span><span class="nx">tutorial</span><span class="p">].</span><span class="nx">title</span><span class="si">}</span><span class="s"></span>
<span class="s">                 &lt;/a&gt;</span>
<span class="s">                 &lt;/li&gt;&quot;&quot;&quot;</span>
          <span class="nx">$</span><span class="p">(</span><span class="nx">a</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#&#39;</span><span class="o">+</span><span class="nx">tutorialSubmenuNoSpaces</span><span class="p">)</span>
          <span class="p">)</span>

      </pre></div>             </td>           </tr>                               <tr id="section-22">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-22">&#182;</a>               </div>               <p>Now that all the menu items are in place in the DOM, invoke sooperfish,
which does some more transformations of its own.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">$</span><span class="p">(</span><span class="s">&#39;ul.sf-menu&#39;</span><span class="p">).</span><span class="nx">sooperfish</span><span class="p">()</span>

      <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">demos ul li a&quot;</span><span class="p">).</span><span class="nx">click</span> <span class="nf">-&gt;</span>
        <span class="nx">eventRouter</span><span class="p">.</span><span class="nx">trigger</span> <span class="s">&quot;load-program&quot;</span><span class="p">,</span> <span class="nx">$</span><span class="p">(</span><span class="nx">@</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s">&quot;id&quot;</span><span class="p">)</span>
        <span class="kc">false</span>

      <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">tutorials li a&quot;</span><span class="p">).</span><span class="nx">click</span> <span class="nf">-&gt;</span>
        <span class="nx">eventRouter</span><span class="p">.</span><span class="nx">trigger</span> <span class="s">&quot;load-program&quot;</span><span class="p">,</span> <span class="nx">$</span><span class="p">(</span><span class="nx">@</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s">&quot;id&quot;</span><span class="p">)</span>
        <span class="kc">false</span>

      <span class="nx">$</span><span class="p">(</span><span class="s">&#39;&lt;span &gt;Autocode&lt;/span&gt;&#39;</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span>
        <span class="nx">$</span><span class="p">(</span><span class="s">&#39;&lt;li&gt;&#39;</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span>
          <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#nav&#39;</span><span class="p">)</span>
        <span class="p">)</span>
      <span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">,</span> <span class="s">&#39;autocodeIndicatorContainer&#39;</span><span class="p">)</span>
      <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">autocodeIndicatorContainer&quot;</span><span class="p">).</span><span class="nx">click</span> <span class="o">=&gt;</span>
        <span class="nx">eventRouter</span><span class="p">.</span><span class="nx">trigger</span> <span class="s">&quot;toggle-autocoder&quot;</span>
        <span class="kc">false</span>

      <span class="nx">$</span><span class="p">(</span><span class="s">&#39;&lt;span &gt;Hide Code: on&lt;/span&gt;&#39;</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span>
        <span class="nx">$</span><span class="p">(</span><span class="s">&#39;&lt;li&gt;&#39;</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span>
          <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#nav&#39;</span><span class="p">)</span>
        <span class="p">)</span>
      <span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">,</span> <span class="s">&#39;dimCodeButtonContainer&#39;</span><span class="p">)</span>
      <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">dimCodeButtonContainer&quot;</span><span class="p">).</span><span class="nx">click</span> <span class="o">=&gt;</span>
        <span class="nx">eventRouter</span><span class="p">.</span><span class="nx">trigger</span> <span class="s">&quot;editor-toggle-dim&quot;</span>
        <span class="kc">false</span>

      <span class="nx">$</span><span class="p">(</span><span class="s">&#39;&lt;span &gt;Reset&lt;/span&gt;&#39;</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span>
        <span class="nx">$</span><span class="p">(</span><span class="s">&#39;&lt;li&gt;&#39;</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span>
          <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#nav&#39;</span><span class="p">)</span>
        <span class="p">)</span>
      <span class="p">).</span><span class="nx">click</span> <span class="o">=&gt;</span>
        <span class="nx">eventRouter</span><span class="p">.</span><span class="nx">trigger</span> <span class="s">&quot;reset&quot;</span>
        <span class="nx">$</span><span class="p">(</span><span class="nx">@</span><span class="p">).</span><span class="nx">stop</span><span class="p">().</span><span class="nx">fadeOut</span><span class="p">(</span><span class="mi">100</span><span class="p">).</span><span class="nx">fadeIn</span> <span class="mi">100</span>
        <span class="kc">false</span>

      <span class="nx">$</span><span class="p">(</span><span class="s">&#39;&lt;span id=&quot;errorMessageDiv&quot;&gt;msg will go here&lt;/span&gt;&#39;</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span>
        <span class="nx">$</span><span class="p">(</span><span class="s">&#39;&lt;li&gt;&#39;</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span>
          <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#nav&#39;</span><span class="p">)</span>
        <span class="p">)</span>
      <span class="p">)</span>

      </pre></div>             </td>           </tr>                               <tr id="section-23">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-23">&#182;</a>               </div>               <p>Align bottom-left</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">@stats</span><span class="p">.</span><span class="nx">getDomElement</span><span class="p">().</span><span class="nv">style.position = </span><span class="s">&quot;absolute&quot;</span>
      <span class="nx">@stats</span><span class="p">.</span><span class="nx">getDomElement</span><span class="p">().</span><span class="nv">style.right = </span><span class="s">&quot;0px&quot;</span>
      <span class="nx">@stats</span><span class="p">.</span><span class="nx">getDomElement</span><span class="p">().</span><span class="nv">style.top = </span><span class="s">&quot;0px&quot;</span>
      <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span> <span class="nx">@stats</span><span class="p">.</span><span class="nx">getDomElement</span><span class="p">()</span>
      <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">startingCourtainScreen&quot;</span><span class="p">).</span><span class="nx">fadeOut</span><span class="p">()</span>
      <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">formCode&quot;</span><span class="p">).</span><span class="nx">css</span> <span class="s">&quot;opacity&quot;</span><span class="p">,</span> <span class="mi">0</span>
      <span class="nx">@fullscreenify</span> <span class="s">&quot;</span><span class="err">#</span><span class="s">backGroundCanvas&quot;</span>
      <span class="nx">@adjustCodeMirrorHeight</span><span class="p">()</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 