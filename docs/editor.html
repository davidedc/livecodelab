<!DOCTYPE html>  <html> <head>   <title>editor.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               editor.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <p>Editor, Mouse wheel handling, fullscreen and resizing management</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">changesHappened</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
  
  <span class="kd">var</span> <span class="nx">cursorActivity</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">editor</span> <span class="o">=</span> <span class="nx">CodeMirror</span><span class="p">.</span><span class="nx">fromTextArea</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;code&quot;</span><span class="p">),</span> <span class="p">{</span>
    <span class="nx">lineNumbers</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="nx">indentWithTabs</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nx">tabSize</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="nx">indentUnit</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="nx">lineWrapping</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>We want the code editor to always have focus
since there is nothing else to type into.
One of those little wonders: you have to pause a little
before giving the editor focus, otherwise for some reason
the focus is not regained. Go figure.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">onBlur</span><span class="o">:</span> <span class="p">(</span><span class="kd">function</span><span class="p">(){</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="s1">&#39;editor.focus()&#39;</span><span class="p">,</span><span class="mi">30</span><span class="p">)</span> <span class="p">}),</span>
        <span class="nx">onChange</span><span class="o">:</span> <span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="nx">registerCode</span><span class="p">();}),</span>
        <span class="nx">mode</span><span class="o">:</span> <span class="s2">&quot;livecodelab&quot;</span><span class="p">,</span>
        <span class="nx">onCursorActivity</span><span class="o">:</span> <span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="nx">suspendDimmingAndCheckIfLink</span><span class="p">();}),</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>onScroll: (function(){alert('scroll')})</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="p">});</span>

  
  <span class="nx">editor</span><span class="p">.</span><span class="nx">setOption</span><span class="p">(</span><span class="s2">&quot;theme&quot;</span><span class="p">,</span> <span class="s1">&#39;night&#39;</span><span class="p">);</span>
  <span class="kd">function</span> <span class="nx">selectTheme</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">theme</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">options</span><span class="p">[</span><span class="nx">node</span><span class="p">.</span><span class="nx">selectedIndex</span><span class="p">].</span><span class="nx">innerHTML</span><span class="p">;</span>
    <span class="nx">editor</span><span class="p">.</span><span class="nx">setOption</span><span class="p">(</span><span class="s2">&quot;theme&quot;</span><span class="p">,</span> <span class="nx">theme</span><span class="p">);</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>resizing the text area is necessary otherwise
as the user types to the end of it, instead of just scrolling
the content leaving all the other parts of the page where
they are, it expands and it pushes down
the view of the page, meaning that the canvas goes up and
the menu disappears
so we have to resize it at launch and also every time the window
is resized.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">function</span> <span class="nx">adjustCodeMirrorHeight</span><span class="p">()</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>alert("code height:" + $('#code').height());
alert("window height:" + window.innerHeight);
alert("code height:" + $('.CodeMirror-scroll').css('height'));
alert("menu height:" + $('#theMenu').height());</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.CodeMirror-scroll&#39;</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">,</span><span class="nb">window</span><span class="p">.</span><span class="nx">innerHeight</span> <span class="o">-</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#theMenu&#39;</span><span class="p">).</span><span class="nx">height</span><span class="p">());</span> 
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">fakeCursorInterval</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">fakeCursorBlinking</span><span class="p">()</span> 
<span class="p">{</span>
  <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#fakeStartingBlinkingCursor&quot;</span><span class="p">).</span><span class="nx">animate</span><span class="p">(</span>
  <span class="p">{</span>
    <span class="nx">opacity</span><span class="o">:</span> <span class="mf">0.2</span>
  <span class="p">},</span> <span class="s2">&quot;fast&quot;</span><span class="p">,</span> <span class="s2">&quot;swing&quot;</span><span class="p">).</span><span class="nx">animate</span><span class="p">(</span>
  <span class="p">{</span>
    <span class="nx">opacity</span><span class="o">:</span> <span class="mi">1</span>
  <span class="p">},</span> <span class="s2">&quot;fast&quot;</span><span class="p">,</span> <span class="s2">&quot;swing&quot;</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>/////////// START OF MOUSEWHEEL HANDLER CODE</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>I couldn't quote get the exact Javascript plugin below to
work in its original form, so I only took the
"calculation" routine.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">function</span> <span class="nx">wheel</span><span class="p">(</span><span class="nx">event</span><span class="p">){</span>

  <span class="cm">/*! Copyright (c) 2011 Brandon Aaron (http://brandonaaron.net)</span>
<span class="cm">   * Licensed under the MIT License (LICENSE.txt).</span>
<span class="cm">   *</span>
<span class="cm">   * Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.</span>
<span class="cm">   * Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.</span>
<span class="cm">   * Thanks to: Seamus Leahy for adding deltaX and deltaY</span>
<span class="cm">   *</span>
<span class="cm">   * Version: 3.0.6</span>
<span class="cm">   * </span>
<span class="cm">   * Requires: 1.2.2+</span>
<span class="cm">   */</span>
 
  <span class="kd">var</span> <span class="nx">orgEvent</span> <span class="o">=</span> <span class="nx">event</span> <span class="o">||</span> <span class="nb">window</span><span class="p">.</span><span class="nx">event</span><span class="p">,</span> <span class="nx">args</span> <span class="o">=</span> <span class="p">[].</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span> <span class="nx">arguments</span><span class="p">,</span> <span class="mi">1</span> <span class="p">),</span> <span class="nx">delta</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">returnValue</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span> <span class="nx">deltaX</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">deltaY</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nx">event</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">fix</span><span class="p">(</span><span class="nx">orgEvent</span><span class="p">);</span>
    <span class="nx">event</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s2">&quot;mousewheel&quot;</span><span class="p">;</span>
    </pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>Old school scrollwheel delta</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span> <span class="nx">orgEvent</span><span class="p">.</span><span class="nx">wheelDelta</span> <span class="p">)</span> <span class="p">{</span> <span class="nx">delta</span> <span class="o">=</span> <span class="nx">orgEvent</span><span class="p">.</span><span class="nx">wheelDelta</span><span class="o">/</span><span class="mi">120</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span> <span class="nx">orgEvent</span><span class="p">.</span><span class="nx">detail</span>     <span class="p">)</span> <span class="p">{</span> <span class="nx">delta</span> <span class="o">=</span> <span class="o">-</span><span class="nx">orgEvent</span><span class="p">.</span><span class="nx">detail</span><span class="o">/</span><span class="mi">3</span><span class="p">;</span> <span class="p">}</span>
    </pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>New school multidimensional scroll (touchpads) deltas</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">deltaY</span> <span class="o">=</span> <span class="nx">delta</span><span class="p">;</span>
    </pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>Gecko</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span> <span class="nx">orgEvent</span><span class="p">.</span><span class="nx">axis</span> <span class="o">!==</span> <span class="kc">undefined</span> <span class="o">&amp;&amp;</span> <span class="nx">orgEvent</span><span class="p">.</span><span class="nx">axis</span> <span class="o">===</span> <span class="nx">orgEvent</span><span class="p">.</span><span class="nx">HORIZONTAL_AXIS</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nx">deltaY</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nx">deltaX</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="nx">delta</span><span class="p">;</span>
    <span class="p">}</span>
    </pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>Webkit</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span> <span class="nx">orgEvent</span><span class="p">.</span><span class="nx">wheelDeltaY</span> <span class="o">!==</span> <span class="kc">undefined</span> <span class="p">)</span> <span class="p">{</span> <span class="nx">deltaY</span> <span class="o">=</span> <span class="nx">orgEvent</span><span class="p">.</span><span class="nx">wheelDeltaY</span><span class="o">/</span><span class="mi">120</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span> <span class="nx">orgEvent</span><span class="p">.</span><span class="nx">wheelDeltaX</span> <span class="o">!==</span> <span class="kc">undefined</span> <span class="p">)</span> <span class="p">{</span> <span class="nx">deltaX</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="nx">orgEvent</span><span class="p">.</span><span class="nx">wheelDeltaX</span><span class="o">/</span><span class="mi">120</span><span class="p">;</span> <span class="p">}</span>
    </pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>console.log(""+deltaX+" "+deltaY);</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">deltaY</span> <span class="o">&gt;</span> <span class="mf">0.2</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">cursorPositio</span> <span class="o">=</span> <span class="nx">editor</span><span class="p">.</span><span class="nx">getCursor</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>this is to prevent that when the cursor reaches the
last line, then it goes to the END of the line
we avoid that because of a nasty workaround
where we check whether the cursor is in the
first few characters of the line to avoid
following a "next-tutorial" link.
console.log(cursorPositio.line+" "+editor.lineCount())</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">cursorPositio</span><span class="p">.</span><span class="nx">line</span> <span class="o">!==</span> <span class="nx">editor</span><span class="p">.</span><span class="nx">lineCount</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">editor</span><span class="p">.</span><span class="nx">setCursor</span><span class="p">(</span><span class="nx">cursorPositio</span><span class="p">.</span><span class="nx">line</span> <span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nx">cursorPositio</span><span class="p">.</span><span class="nx">ch</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">deltaY</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">cursorPositio</span> <span class="o">=</span> <span class="nx">editor</span><span class="p">.</span><span class="nx">getCursor</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
    <span class="nx">editor</span><span class="p">.</span><span class="nx">setCursor</span><span class="p">(</span><span class="nx">cursorPositio</span><span class="p">.</span><span class="nx">line</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nx">cursorPositio</span><span class="p">.</span><span class="nx">ch</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="cm">/* Initialization code. */</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">)</span>
  <span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;DOMMouseScroll&#39;</span><span class="p">,</span> <span class="nx">wheel</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
<span class="nb">window</span><span class="p">.</span><span class="nx">onmousewheel</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">onmousewheel</span> <span class="o">=</span> <span class="nx">wheel</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <p>/////////// END OF MOUSEWHEEL HANDLER CODE</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>this function is called when the cursor moves
and we handle this in two ways
1) we suspend the dimming countdown
2) we undim the editor if it is dimmed
3) we check whether the user moved the cursor over a link</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">function</span> <span class="nx">suspendDimmingAndCheckIfLink</span><span class="p">(){</span></pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <p>Now this is kind of a nasty hack: we check where the
cursor is, and if it's over a line containing the
link then we follow it.
There was no better way, for some reason some onClick
events are lost, so what happened is that one would click on
the link and nothing would happen.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">cursorP</span> <span class="o">=</span> <span class="nx">editor</span><span class="p">.</span><span class="nx">getCursor</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">cursorP</span><span class="p">.</span><span class="nx">ch</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">currentLineContent</span> <span class="o">=</span> <span class="nx">editor</span><span class="p">.</span><span class="nx">getLine</span><span class="p">(</span><span class="nx">cursorP</span><span class="p">.</span><span class="nx">line</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">currentLineContent</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;// next-tutorial:&#39;</span><span class="p">)</span> <span class="o">===</span> <span class="mi">0</span><span class="p">){</span>
      <span class="nx">currentLineContent</span> <span class="o">=</span> <span class="nx">currentLineContent</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mi">17</span><span class="p">);</span>    
      <span class="nx">currentLineContent</span> <span class="o">=</span> <span class="nx">currentLineContent</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p>alert(""+url);</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">setTimeout</span><span class="p">(</span><span class="s1">&#39;loadDemoOrTutorial(&quot;&#39;</span><span class="o">+</span><span class="nx">currentLineContent</span><span class="o">+</span><span class="s1">&#39;Tutorial&quot;);&#39;</span><span class="p">,</span><span class="mi">200</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">fakeText</span> <span class="o">||</span> <span class="nx">editor</span><span class="p">.</span><span class="nx">getValue</span><span class="p">()</span> <span class="o">===</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <p>console.log('cursor activity! opacity: ' + $("#formCode").css('opacity'));</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">cursorActivity</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
  <span class="nx">undimEditor</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">undimEditor</span><span class="p">(){</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">fakeText</span> <span class="o">||</span> <span class="nx">editor</span><span class="p">.</span><span class="nx">getValue</span><span class="p">()</span> <span class="o">===</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#formCode&quot;</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;opacity&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#formCode&quot;</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;opacity&#39;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.99</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <p>console.log('undimming the editor');</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#formCode&quot;</span><span class="p">).</span><span class="nx">animate</span><span class="p">(</span>
      <span class="p">{</span>
      <span class="nx">opacity</span><span class="o">:</span> <span class="mi">1</span>
      <span class="p">},</span> <span class="s2">&quot;fast&quot;</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <p>Now that there is a manual switch to toggle it off and on
the dimming goes to full INvisibility
see toggleDimCode() 
not sure about that, want to try it on people -- julien </p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">function</span> <span class="nx">dimEditor</span><span class="p">(){</span></pre></div>             </td>           </tr>                               <tr id="section-21">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-21">&#182;</a>               </div>               <p>TODO there is a chance that the animation library
doesn't bring the opacity completely to zero
but rather to a value close to it.
Make the animation step to print something
just to make sure that this is not the case.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#formCode&quot;</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;opacity&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-22">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-22">&#182;</a>               </div>               <p>console.log('starting fadeout animation');</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#formCode&quot;</span><span class="p">).</span><span class="nx">animate</span><span class="p">(</span>
        <span class="p">{</span>
        <span class="nx">opacity</span><span class="o">:</span> <span class="mi">0</span>
        <span class="p">},</span> <span class="s2">&quot;slow&quot;</span><span class="p">);</span>
      <span class="p">}</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">dimIfNoCursorActivity</span><span class="p">(){</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">fakeText</span> <span class="o">||</span> <span class="nx">editor</span><span class="p">.</span><span class="nx">getValue</span><span class="p">()</span> <span class="o">===</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">cursorActivity</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-23">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-23">&#182;</a>               </div>               <p>console.log('marking cursor activity = false. Will check again in the next interval');</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">cursorActivity</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-24">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-24">&#182;</a>               </div>               <p>console.log('no activity in the last interval. Dimming now, starting opacity is: ' + $("#formCode").css('opacity') );</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">dimEditor</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-25">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-25">&#182;</a>               </div>               <p>a function to toggle code diming on and off -- julien </p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">function</span> <span class="nx">toggleDimCode</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">dimcodeOn</span> <span class="o">=</span> <span class="o">!</span><span class="nx">dimcodeOn</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">dimcodeOn</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">clearInterval</span> <span class="p">(</span><span class="nx">dimIntervalID</span><span class="p">);</span>
    <span class="nx">undimEditor</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">frenchVersion</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#dimCodeIndicator&quot;</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="s2">&quot;Code Caché: inactif&quot;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#dimCodeIndicator&quot;</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="s2">&quot;Hide Code: off&quot;</span><span class="p">);</span>
    <span class="p">}</span>

  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-26">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-26">&#182;</a>               </div>               <p>we restart a setInterval</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">dimIntervalID</span> <span class="o">=</span> <span class="nx">setInterval</span> <span class="p">(</span> <span class="s2">&quot;dimIfNoCursorActivity()&quot;</span><span class="p">,</span> <span class="mi">5000</span> <span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">frenchVersion</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#dimCodeIndicator&quot;</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="s2">&quot;Code Caché: actif&quot;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#dimCodeIndicator&quot;</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="s2">&quot;Hide Code: on&quot;</span><span class="p">);</span>
    <span class="p">}</span>

  <span class="p">}</span>
<span class="p">}</span>


<span class="kd">var</span> <span class="nx">closeAndCheckAudio</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span></pre></div>             </td>           </tr>                               <tr id="section-27">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-27">&#182;</a>               </div>               <p>$('#noWebGLMessage').close();</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">$</span><span class="p">.</span><span class="nx">modal</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
    <span class="nx">setTimeout</span><span class="p">(</span><span class="s1">&#39;checkAudio();&#39;</span><span class="p">,</span><span class="mi">500</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">checkAudio</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">buzz</span><span class="p">.</span><span class="nx">isSupported</span><span class="p">())</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-28">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-28">&#182;</a>               </div>               <p>if (true) {</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#noAudioMessage&#39;</span><span class="p">).</span><span class="nx">modal</span><span class="p">();</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#simplemodal-container&#39;</span><span class="p">).</span><span class="nx">height</span><span class="p">(</span><span class="mi">200</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">loadAndTestAllTheSounds</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-29">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-29">&#182;</a>               </div>               <p>console.log("loading and testing all sounds");</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">cycleSoundDefs</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">cycleSoundDefs</span> <span class="o">&lt;</span> <span class="nx">numberOfSounds</span><span class="p">;</span> <span class="nx">cycleSoundDefs</span><span class="o">++</span><span class="p">){</span>
  
    <span class="k">if</span> <span class="p">(</span><span class="nx">buzz</span><span class="p">.</span><span class="nx">isMP3Supported</span><span class="p">())</span> <span class="nx">soundDef</span><span class="p">[</span><span class="nx">cycleSoundDefs</span><span class="p">].</span><span class="nx">soundFile</span> <span class="o">=</span> <span class="nx">soundDef</span><span class="p">[</span><span class="nx">cycleSoundDefs</span><span class="p">].</span><span class="nx">soundFile</span><span class="o">+</span><span class="s2">&quot;.mp3&quot;</span><span class="p">;</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">buzz</span><span class="p">.</span><span class="nx">isOGGSupported</span><span class="p">())</span> <span class="nx">soundDef</span><span class="p">[</span><span class="nx">cycleSoundDefs</span><span class="p">].</span><span class="nx">soundFile</span> <span class="o">=</span> <span class="nx">soundDef</span><span class="p">[</span><span class="nx">cycleSoundDefs</span><span class="p">].</span><span class="nx">soundFile</span><span class="o">+</span><span class="s2">&quot;.ogg&quot;</span><span class="p">;</span>
    <span class="k">else</span> <span class="p">{</span><span class="k">break</span><span class="p">}</span>
  
    <span class="nx">soundBank</span><span class="p">[</span><span class="nx">soundDef</span><span class="p">[</span><span class="nx">cycleSoundDefs</span><span class="p">].</span><span class="nx">soundName</span><span class="p">]</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="nx">soundFiles</span><span class="p">[</span><span class="nx">soundDef</span><span class="p">[</span><span class="nx">cycleSoundDefs</span><span class="p">].</span><span class="nx">soundName</span><span class="p">]</span> <span class="o">=</span> <span class="nx">soundDef</span><span class="p">[</span><span class="nx">cycleSoundDefs</span><span class="p">].</span><span class="nx">soundFile</span><span class="p">;</span>
    </pre></div>             </td>           </tr>                               <tr id="section-30">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-30">&#182;</a>               </div>               <p>Chrome can deal with dynamic loading
of many files but doesn't like loading too many audio objects
so fast - it crashes.
At the opposite end, Safari doesn't like loading sound dynamically
and instead works fine by loading sound all at the beginning.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">userAgent</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;chrome&#39;</span><span class="p">)</span> <span class="o">===</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="p">(</span><span class="sr">/MSIE (\d+\.\d+);/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">userAgent</span><span class="p">))</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">preloadSounds</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">preloadSounds</span> <span class="o">&lt;</span> <span class="nx">CHANNELSPERSOUND</span><span class="p">;</span> <span class="nx">preloadSounds</span><span class="o">++</span><span class="p">){</span></pre></div>             </td>           </tr>                               <tr id="section-31">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-31">&#182;</a>               </div>               <p>if you load and play all the channels of all the sounds all together
the browser freezes, and the OS doesn't feel too well either
so better stagger the checks in time.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">setTimeout</span><span class="p">(</span><span class="s2">&quot;checkSound(&quot;</span><span class="o">+</span><span class="nx">cycleSoundDefs</span><span class="o">+</span><span class="s2">&quot;);&quot;</span><span class="p">,</span> <span class="mi">200</span><span class="o">*</span> <span class="nx">cycleSoundDefs</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
  
  <span class="p">}</span> <span class="c1">// end of the for loop</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">userAgent</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;chrome&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span> <span class="o">||</span> <span class="p">(</span><span class="sr">/MSIE (\d+\.\d+);/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">userAgent</span><span class="p">))</span> <span class="p">)</span> <span class="p">{</span>
    <span class="nx">startEnvironment</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">checkSound</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">cycleSoundDefs</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">newSound</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">buzz</span><span class="p">.</span><span class="nx">sound</span><span class="p">(</span><span class="nx">soundDef</span><span class="p">[</span><span class="nx">cycleSoundDefs</span><span class="p">].</span><span class="nx">soundFile</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-32">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-32">&#182;</a>               </div>               <p>console.log("loading sound "+ soundDef[cycleSoundDefs].soundFile);</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">newSound</span><span class="p">.</span><span class="nx">mute</span><span class="p">()</span>
    <span class="nx">newSound</span><span class="p">.</span><span class="nx">load</span><span class="p">();</span>
    <span class="nx">newSound</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="s2">&quot;ended&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">unbind</span><span class="p">(</span><span class="s2">&quot;ended&quot;</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">unmute</span><span class="p">();</span>
      <span class="nx">endedFirstPlay</span><span class="o">++</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">endedFirstPlay</span><span class="o">%</span><span class="mi">10</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#loading&#39;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-33">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-33">&#182;</a>               </div>               <p>console.log("tested "+endedFirstPlay+" sounds");</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="nx">endedFirstPlay</span> <span class="o">===</span> <span class="nx">numberOfSounds</span> <span class="o">*</span> <span class="nx">CHANNELSPERSOUND</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-34">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-34">&#182;</a>               </div>               <p>console.log("tested all sounds");</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">startEnvironment</span><span class="p">();</span>
      <span class="p">}</span>
    <span class="p">});</span>
    <span class="nx">newSound</span><span class="p">.</span><span class="nx">play</span><span class="p">();</span>
    <span class="nx">soundBank</span><span class="p">[</span><span class="nx">soundDef</span><span class="p">[</span><span class="nx">cycleSoundDefs</span><span class="p">].</span><span class="nx">soundName</span><span class="p">].</span><span class="nx">push</span><span class="p">(</span><span class="nx">newSound</span><span class="p">);</span>
<span class="p">}</span>
  
<span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span></pre></div>             </td>           </tr>                               <tr id="section-35">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-35">&#182;</a>               </div>               <p>console.log("document ready");</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">isCanvasSupported</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#noCanvasMessage&#39;</span><span class="p">).</span><span class="nx">modal</span><span class="p">({</span><span class="nx">onClose</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#loading&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s1">&#39;sorry :-(&#39;</span><span class="p">);</span><span class="nx">$</span><span class="p">.</span><span class="nx">modal</span><span class="p">.</span><span class="nx">close</span><span class="p">();}});</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#simplemodal-container&#39;</span><span class="p">).</span><span class="nx">height</span><span class="p">(</span><span class="mi">200</span><span class="p">);</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nx">loadAndTestAllTheSounds</span><span class="p">();</span>
<span class="p">});</span>

<span class="nx">startEnvironment</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="nx">pickRandomDefaultGradient</span><span class="p">();</span>
    </pre></div>             </td>           </tr>                               <tr id="section-36">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-36">&#182;</a>               </div>               <p>console.log("startEnvironment");</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="nx">init</span><span class="p">()</span> <span class="p">)</span> <span class="nx">animate</span><span class="p">();</span>

  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">Detector</span><span class="p">.</span><span class="nx">webgl</span> <span class="o">||</span> <span class="nx">forceCanvasRenderer</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-37">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-37">&#182;</a>               </div>               <p>$('#noWebGLMessage').modal()</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#noWebGLMessage&#39;</span><span class="p">).</span><span class="nx">modal</span><span class="p">({</span><span class="nx">onClose</span><span class="o">:</span> <span class="nx">closeAndCheckAudio</span><span class="p">});</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#simplemodal-container&#39;</span><span class="p">).</span><span class="nx">height</span><span class="p">(</span><span class="mi">200</span><span class="p">);</span>
  <span class="p">}</span>
  </pre></div>             </td>           </tr>                               <tr id="section-38">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-38">&#182;</a>               </div>               <p>alert('resizing canvas');</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">canvas</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;backGroundCanvas&#39;</span><span class="p">);</span>
  
  <span class="k">if</span> <span class="p">(</span><span class="nx">fullScreenifyBackground</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">fullscreenify</span><span class="p">(</span><span class="nx">canvas</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="nx">resetGradientStack</span><span class="p">();</span>
  <span class="nx">simpleGradientUpdateIfChanged</span><span class="p">();</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">frenchVersion</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#demoMenu&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;Démos&quot;</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#tutorialsMenu&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;Tutoriaux&quot;</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#resetButton&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;Effacer&quot;</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#autocodeIndicator&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;Autocode: inactif&quot;</span><span class="p">);</span>

    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#simpleCubeDemo&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;Cube simple&quot;</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#webgltwocubesDemo&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;WebGL: Deux cubes&quot;</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#cubesAndSpikes&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;Cubes et piques&quot;</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#webglturbineDemo&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;WebGL: Turbine&quot;</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#webglzfightartDemo&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;WebGL: Z-fight art!&quot;</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#littleSpiralOfCubes&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;Petite spirale&quot;</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#tentacleDemo&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;Tentacule&quot;</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#lampDemo&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;Lampe&quot;</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#trillionfeathersDemo&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;Mille milliards de plumes&quot;</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#monsterblobDemo&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;Monstre blob&quot;</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#industrialMusicDemo&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;Son: Industriel&quot;</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#trySoundsDemo&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;Son: Essayez les tous&quot;</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#springysquaresDemo&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;Carrés rebondissants&quot;</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#diceDemo&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;Dé&quot;</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#webglalmostvoronoiDemo&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;WebGL: Presque Voronoi&quot;</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#webglshardsDemo&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;WebGL: Échardes&quot;</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#webglredthreadsDemo&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;WebGL: Fils rouges&quot;</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#webglnuclearOctopusDemo&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;WebGL: Pieuvre nucléaire&quot;</span><span class="p">);</span>
    
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#introTutorial&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;intro&quot;</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#helloworldTutorial&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;hello world&quot;</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#somenotesTutorial&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;quelques notes&quot;</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#rotateTutorial&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;tourne&quot;</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#frameTutorial&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;image&quot;</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#timeTutorial&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;temps&quot;</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#moveTutorial&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;déplace&quot;</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#scaleTutorial&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;taille&quot;</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#timesTutorial&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;fois&quot;</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#fillTutorial&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;remplissage&quot;</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#strokeTutorial&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;trait&quot;</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#colornamesTutorial&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;les couleurs par leur nom&quot;</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#lightsTutorial&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;éclairages&quot;</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#backgroundTutorial&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;fond&quot;</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#gradientTutorial&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;degradeSimple&quot;</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#lineTutorial&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;ligne&quot;</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#ballTutorial&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;balle&quot;</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#pushpopMatrixTutorial&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;matrice&quot;</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#animationstyleTutorial&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;styleAnimation&quot;</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#doonceTutorial&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;uneFois&quot;</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#autocodeTutorial&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;autocode&quot;</span><span class="p">);</span>
  <span class="p">}</span>
    

  <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#startingCourtainScreen&#39;</span><span class="p">).</span><span class="nx">fadeOut</span><span class="p">();</span>
  <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#formCode&quot;</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;opacity&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>

  <span class="nx">editor</span><span class="p">.</span><span class="nx">focus</span><span class="p">();</span>
  <span class="nx">adjustCodeMirrorHeight</span><span class="p">();</span>
  </pre></div>             </td>           </tr>                               <tr id="section-39">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-39">&#182;</a>               </div>               <p>check if the url points to a particular demo,
in which case we load the demo directly.
otherwise we do as usual.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">if</span> <span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">hash</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;bookmark&quot;</span><span class="p">)</span><span class="o">!==-</span><span class="mi">1</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">demoToLoad</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">hash</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="s2">&quot;bookmark&quot;</span><span class="p">.</span><span class="nx">length</span> <span class="o">+</span> <span class="mi">2</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-40">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-40">&#182;</a>               </div>               <p>setTimeout ( "loadDemoOrTutorial('"+demoToLoad+"');",500);</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">loadDemoOrTutorial</span><span class="p">(</span><span class="nx">demoToLoad</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="nx">fakeCursorInterval</span> <span class="o">=</span> <span class="nx">setInterval</span> <span class="p">(</span> <span class="s2">&quot;fakeCursorBlinking()&quot;</span><span class="p">,</span> <span class="mi">800</span> <span class="p">);</span>
  
  </pre></div>             </td>           </tr>                               <tr id="section-41">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-41">&#182;</a>               </div>               <p>Init of the dim code toggle.
set it to false, then immediately toggle it to true with the managing function
that way we can easily invert the default: just change false to true -- julien</p>             </td>             <td class="code">               <div class="highlight"><pre>  
  <span class="nx">dimcodeOn</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
  <span class="nx">toggleDimCode</span><span class="p">();</span>
  
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-42">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-42">&#182;</a>               </div>               <p>/////////////////////////////////////////////</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">function</span> <span class="nx">fullscreenify</span><span class="p">(</span><span class="nx">canvas</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">style</span> <span class="o">=</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;style&#39;</span><span class="p">)</span> <span class="o">||</span> <span class="s1">&#39;&#39;</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-43">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-43">&#182;</a>               </div>               <p>alert('style: ' +  style);</p>             </td>             <td class="code">               <div class="highlight"><pre>    
    <span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;resize&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> <span class="nx">adjustCodeMirrorHeight</span><span class="p">();</span> <span class="nx">resize</span><span class="p">(</span><span class="nx">canvas</span><span class="p">);},</span> <span class="kc">false</span><span class="p">);</span>

    <span class="nx">resize</span><span class="p">(</span><span class="nx">canvas</span><span class="p">);</span>

    <span class="kd">function</span> <span class="nx">resize</span><span class="p">(</span><span class="nx">canvas</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">scale</span> <span class="o">=</span> <span class="p">{</span><span class="nx">x</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="mi">1</span><span class="p">};</span>
        <span class="nx">scale</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">innerWidth</span> <span class="o">+</span> <span class="mi">40</span><span class="p">)</span> <span class="o">/</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">width</span><span class="p">;</span>
        <span class="nx">scale</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">innerHeight</span> <span class="o">+</span> <span class="mi">40</span><span class="p">)</span> <span class="o">/</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">height</span><span class="p">;</span>
        
        <span class="nx">scale</span> <span class="o">=</span> <span class="nx">scale</span><span class="p">.</span><span class="nx">x</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">;</span>
        </pre></div>             </td>           </tr>                               <tr id="section-44">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-44">&#182;</a>               </div>               <p>this code below is if one wants to keep the aspect ratio
but I mean one doesn't necessarily resize the window
keeping the same aspect ratio.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="cm">/*</span>
<span class="cm">        if (scale.x &lt; 1 || scale.y &lt; 1) {</span>
<span class="cm">            scale = &#39;1, 1&#39;;</span>
<span class="cm">        } else if (scale.x &lt; scale.y) {</span>
<span class="cm">            scale = scale.x + &#39;, &#39; + scale.x;</span>
<span class="cm">        } else {</span>
<span class="cm">            scale = scale.y + &#39;, &#39; + scale.y;</span>
<span class="cm">        }</span>
<span class="cm">        */</span>
        
        <span class="nx">canvas</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;style&#39;</span><span class="p">,</span> <span class="nx">style</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="s1">&#39;-ms-transform-origin: left top; -webkit-transform-origin: left top; -moz-transform-origin: left top; -o-transform-origin: left top; transform-origin: left top; -ms-transform: scale(&#39;</span> <span class="o">+</span> <span class="nx">scale</span> <span class="o">+</span> <span class="s1">&#39;); -webkit-transform: scale3d(&#39;</span> <span class="o">+</span> <span class="nx">scale</span> <span class="o">+</span> <span class="s1">&#39;, 1); -moz-transform: scale(&#39;</span> <span class="o">+</span> <span class="nx">scale</span> <span class="o">+</span> <span class="s1">&#39;); -o-transform: scale(&#39;</span> <span class="o">+</span> <span class="nx">scale</span> <span class="o">+</span> <span class="s1">&#39;); transform: scale(&#39;</span> <span class="o">+</span> <span class="nx">scale</span> <span class="o">+</span> <span class="s1">&#39;);&#39;</span><span class="p">);</span>
    </pre></div>             </td>           </tr>                               <tr id="section-45">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-45">&#182;</a>               </div>               <p>TODO In theory we want to re-draw the background because the
aspect ration might have changed.
But for the time being we only have vertical
gradients so that's not going to be a problem.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="p">}</span>
<span class="p">}</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 