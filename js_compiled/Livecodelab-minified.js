// Livecodelab-minified.js - https://github.com/davidedc/livecodelab
'use strict';function McState(){var a=[],b=function(b){return function(f){a.push(new McRule(b,f))}};b.rules=a;b.lex=function(a){for(a=b.run(a);"function"==typeof a;)a=a();return a};b.run=McRunMethod;b.continuation=function(a){return function(){return b.run(a)}};return b}function McRule(a,b){this.regex=RegExp("^("+a.source+")");this.regex.compile&&this.regex.compile(this.regex);this.action=b}McRule.prototype.matches=function(a){(a=a.match(this.regex))&&a.shift();return a};
function McRunMethod(a){for(var b=null,c=null,f=-1,h=this.rules.length-1;0<=h;--h){var i=this.rules[h],j=i.matches(a);j&&j[0].length>=f&&(b=i,c=j,f=j[0].length)}if(b)return b.action(c,a.substring(f),this);throw"Lexing error; no match found for: '"+a+"'";}function McCONTINUE(a){return function(b,c){return a.run(c)}}
var McLexer={State:McState},Detector={canvas:!!window.CanvasRenderingContext2D,webgl:function(){try{return!!window.WebGLRenderingContext&&!!document.createElement("canvas").getContext("experimental-webgl")}catch(a){return!1}}(),workers:!!window.Worker,fileapi:window.File&&window.FileReader&&window.FileList&&window.Blob,getWebGLErrorMessage:function(){var a=document.createElement("div");a.style.fontFamily="monospace";a.style.fontSize="13px";a.style.textAlign="center";a.style.background="#eee";a.style.color=
"#000";a.style.padding="1em";a.style.width="475px";a.style.margin="5em auto 0";this.webgl||(a.innerHTML=window.WebGLRenderingContext?'Your graphics card does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation">WebGL</a>.<br />\nFind out how to get it <a href="http://get.webgl.org/">here</a>.':'Your browser does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation">WebGL</a>.<br/>\nFind out how to get it <a href="http://get.webgl.org/">here</a>.');
return a},addGetWebGLMessage:function(a){var b,c,a=a||{};b=void 0!==a.parent?a.parent:document.body;a=void 0!==a.id?a.id:"oldie";c=Detector.getWebGLErrorMessage();c.id=a;b.appendChild(c)}},badgeHeight=16,Stats=function(){var a,b,c=1,f=0,h=Date.now(),i=h,j=h,g=0,d=1E3,e=0,o,k,l,m=[[0,0,0],[255,255,255]],n=0,s=1E3,r=0,p,q,t,u=[[0,0,0],[255,255,255]];a=document.createElement("div");a.style.cursor="pointer";a.style.width="74px";a.style.zIndex="6";a.addEventListener("mousedown",function(a){a.preventDefault();
c=(c+1)%2;0==c?(o.style.display="block",p.style.display="none"):(o.style.display="none",p.style.display="block")},!1);o=document.createElement("div");o.style.textAlign="right";o.style.lineHeight="1.2em";o.style.backgroundColor="rgb(0,0,0)";o.style.padding="0 0 0px 0px";o.style.display="none";a.appendChild(o);k=document.createElement("div");k.style.fontFamily="Helvetica, Arial, sans-serif";k.style.fontSize="9px";k.style.color="rgb("+m[1][0]+","+m[1][1]+","+m[1][2]+")";k.style.fontWeight="bold";k.innerHTML=
"FPS";o.appendChild(k);l=document.createElement("div");l.style.position="relative";l.style.width="74px";l.style.height=badgeHeight+"px";l.style.backgroundColor="rgb("+m[1][0]+","+m[1][1]+","+m[1][2]+")";for(o.appendChild(l);74>l.children.length;)b=document.createElement("span"),b.style.width="1px",b.style.height=badgeHeight+"px",b.style.cssFloat="left",b.style.backgroundColor="rgb("+m[0][0]+","+m[0][1]+","+m[0][2]+")",l.appendChild(b);p=document.createElement("div");p.style.textAlign="right";p.style.lineHeight=
"1.2em";p.style.backgroundColor="rgb(0,0,0)";p.style.padding="0 0 0px 0px";p.style.display="block";a.appendChild(p);q=document.createElement("div");q.style.fontFamily="Helvetica, Arial, sans-serif";q.style.fontSize="9px";q.style.color="rgb("+u[1][0]+","+u[1][1]+","+u[1][2]+")";q.style.fontWeight="bold";q.innerHTML="MS";p.appendChild(q);t=document.createElement("div");t.style.position="relative";t.style.width="74px";t.style.height=badgeHeight+"px";t.style.backgroundColor="rgb("+u[1][0]+","+u[1][1]+
","+u[1][2]+")";for(p.appendChild(t);74>t.children.length;)b=document.createElement("span"),b.style.width="1px",b.style.height=Math.random()*badgeHeight+"px",b.style.cssFloat="left",b.style.backgroundColor="rgb("+u[0][0]+","+u[0][1]+","+u[0][2]+")",t.appendChild(b);return{getDomElement:function(){return a},getFps:function(){return g},getFpsMin:function(){return d},getFpsMax:function(){return e},getMs:function(){return n},getMsMin:function(){return s},getMsMax:function(){return r},update:function(){h=
Date.now();n=h-i;s=Math.min(s,n);r=Math.max(r,n);q.textContent=n+" MS ";var a=Math.min(badgeHeight,badgeHeight-n/200*badgeHeight);t.appendChild(t.firstChild).style.height=a+"px";i=h;f++;h>j+1E3&&(g=Math.round(1E3*f/(h-j)),d=Math.min(d,g),e=Math.max(e,g),k.textContent=g+" FPS ("+d+"-"+e+")",a=Math.min(badgeHeight,badgeHeight-g/100*badgeHeight),l.appendChild(l.firstChild).style.height=a+"px",j=h,f=0)}}},THREEx=THREEx||{};
THREEx.WindowResize=function(a,b){var c=function(){a.setSize(window.innerWidth,window.innerHeight);b.aspect=window.innerWidth/window.innerHeight;b.updateProjectionMatrix()};window.addEventListener("resize",c,!1);return{stop:function(){window.removeEventListener("resize",c)}}};THREEx.WindowResize.bind=function(a,b){return THREEx.WindowResize(a,b)};
THREE.ShaderExtras={screen:{uniforms:{tDiffuse:{type:"t",value:0,texture:null},opacity:{type:"f",value:1}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = vec2( uv.x, 1.0 - uv.y );\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform float opacity;\nuniform sampler2D tDiffuse;\nvarying vec2 vUv;\nvoid main() {\nvec4 texel = texture2D( tDiffuse, vUv );\ngl_FragColor = opacity * texel;\n}"},convolution:{uniforms:{tDiffuse:{type:"t",value:0,texture:null},
uImageIncrement:{type:"v2",value:new THREE.Vector2(0.001953125,0)},cKernel:{type:"fv1",value:[]}},vertexShader:"uniform vec2 uImageIncrement;\nvarying vec2 vUv;\nvoid main() {\nvUv = uv - ( ( KERNEL_SIZE - 1.0 ) / 2.0 ) * uImageIncrement;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform float cKernel[ KERNEL_SIZE ];\nuniform sampler2D tDiffuse;\nuniform vec2 uImageIncrement;\nvarying vec2 vUv;\nvoid main() {\nvec2 imageCoord = vUv;\nvec4 sum = vec4( 0.0, 0.0, 0.0, 0.0 );\nfor( int i = 0; i < KERNEL_SIZE; i ++ ) {\nsum += texture2D( tDiffuse, imageCoord ) * cKernel[ i ];\nimageCoord += uImageIncrement;\n}\ngl_FragColor = sum;\n}"},
film:{uniforms:{tDiffuse:{type:"t",value:0,texture:null},time:{type:"f",value:0},nIntensity:{type:"f",value:0.5},sIntensity:{type:"f",value:0.05},sCount:{type:"f",value:4096},grayscale:{type:"i",value:1}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = vec2( uv.x, 1.0 - uv.y );\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform float time;\nuniform bool grayscale;\nuniform float nIntensity;\nuniform float sIntensity;\nuniform float sCount;\nuniform sampler2D tDiffuse;\nvarying vec2 vUv;\nvoid main() {\nvec4 cTextureScreen = texture2D( tDiffuse, vUv );\nfloat x = vUv.x * vUv.y * time *  1000.0;\nx = mod( x, 13.0 ) * mod( x, 123.0 );\nfloat dx = mod( x, 0.01 );\nvec3 cResult = cTextureScreen.rgb + cTextureScreen.rgb * clamp( 0.1 + dx * 100.0, 0.0, 1.0 );\nvec2 sc = vec2( sin( vUv.y * sCount ), cos( vUv.y * sCount ) );\ncResult += cTextureScreen.rgb * vec3( sc.x, sc.y, sc.x ) * sIntensity;\ncResult = cTextureScreen.rgb + clamp( nIntensity, 0.0,1.0 ) * ( cResult - cTextureScreen.rgb );\nif( grayscale ) {\ncResult = vec3( cResult.r * 0.3 + cResult.g * 0.59 + cResult.b * 0.11 );\n}\ngl_FragColor =  vec4( cResult, cTextureScreen.a );\n}"},
bokeh:{uniforms:{tColor:{type:"t",value:0,texture:null},tDepth:{type:"t",value:1,texture:null},focus:{type:"f",value:1},aspect:{type:"f",value:1},aperture:{type:"f",value:0.025},maxblur:{type:"f",value:1}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = vec2( uv.x, 1.0 - uv.y );\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"varying vec2 vUv;\nuniform sampler2D tColor;\nuniform sampler2D tDepth;\nuniform float maxblur;\nuniform float aperture;\nuniform float focus;\nuniform float aspect;\nvoid main() {\nvec2 aspectcorrect = vec2( 1.0, aspect );\nvec4 depth1 = texture2D( tDepth, vUv );\nfloat factor = depth1.x - focus;\nvec2 dofblur = vec2 ( clamp( factor * aperture, -maxblur, maxblur ) );\nvec2 dofblur9 = dofblur * 0.9;\nvec2 dofblur7 = dofblur * 0.7;\nvec2 dofblur4 = dofblur * 0.4;\nvec4 col = vec4( 0.0 );\ncol += texture2D( tColor, vUv.xy );\ncol += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur );\ncol += texture2D( tColor, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur );\ncol += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur );\ncol += texture2D( tColor, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur );\ncol += texture2D( tColor, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur );\ncol += texture2D( tColor, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur );\ncol += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur );\ncol += texture2D( tColor, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur );\ncol += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur );\ncol += texture2D( tColor, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur );\ncol += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur );\ncol += texture2D( tColor, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur );\ncol += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur );\ncol += texture2D( tColor, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur );\ncol += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur );\ncol += texture2D( tColor, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur );\ncol += texture2D( tColor, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur9 );\ncol += texture2D( tColor, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur9 );\ncol += texture2D( tColor, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur9 );\ncol += texture2D( tColor, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur9 );\ncol += texture2D( tColor, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur9 );\ncol += texture2D( tColor, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur9 );\ncol += texture2D( tColor, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur9 );\ncol += texture2D( tColor, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur9 );\ncol += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur7 );\ncol += texture2D( tColor, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur7 );\ncol += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur7 );\ncol += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur7 );\ncol += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur7 );\ncol += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur7 );\ncol += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur7 );\ncol += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur7 );\ncol += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur4 );\ncol += texture2D( tColor, vUv.xy + ( vec2(  0.4,   0.0  ) * aspectcorrect ) * dofblur4 );\ncol += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur4 );\ncol += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur4 );\ncol += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur4 );\ncol += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur4 );\ncol += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur4 );\ncol += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur4 );\ngl_FragColor = col / 41.0;\ngl_FragColor.a = 1.0;\n}"},
dofmipmap:{uniforms:{tColor:{type:"t",value:0,texture:null},tDepth:{type:"t",value:1,texture:null},focus:{type:"f",value:1},maxblur:{type:"f",value:1}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = vec2( uv.x, 1.0 - uv.y );\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform float focus;\nuniform float maxblur;\nuniform sampler2D tColor;\nuniform sampler2D tDepth;\nvarying vec2 vUv;\nvoid main() {\nvec4 depth = texture2D( tDepth, vUv );\nfloat factor = depth.x - focus;\nvec4 col = texture2D( tColor, vUv, 2.0 * maxblur * abs( focus - depth.x ) );\ngl_FragColor = col;\ngl_FragColor.a = 1.0;\n}"},
sepia:{uniforms:{tDiffuse:{type:"t",value:0,texture:null},amount:{type:"f",value:1}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = vec2( uv.x, 1.0 - uv.y );\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform float amount;\nuniform sampler2D tDiffuse;\nvarying vec2 vUv;\nvoid main() {\nvec4 color = texture2D( tDiffuse, vUv );\nvec3 c = color.rgb;\ncolor.r = dot( c, vec3( 1.0 - 0.607 * amount, 0.769 * amount, 0.189 * amount ) );\ncolor.g = dot( c, vec3( 0.349 * amount, 1.0 - 0.314 * amount, 0.168 * amount ) );\ncolor.b = dot( c, vec3( 0.272 * amount, 0.534 * amount, 1.0 - 0.869 * amount ) );\ngl_FragColor = vec4( min( vec3( 1.0 ), color.rgb ), color.a );\n}"},
dotscreen:{uniforms:{tDiffuse:{type:"t",value:0,texture:null},tSize:{type:"v2",value:new THREE.Vector2(256,256)},center:{type:"v2",value:new THREE.Vector2(0.5,0.5)},angle:{type:"f",value:1.57},scale:{type:"f",value:1}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = vec2( uv.x, 1.0 - uv.y );\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform vec2 center;\nuniform float angle;\nuniform float scale;\nuniform vec2 tSize;\nuniform sampler2D tDiffuse;\nvarying vec2 vUv;\nfloat pattern() {\nfloat s = sin( angle ), c = cos( angle );\nvec2 tex = vUv * tSize - center;\nvec2 point = vec2( c * tex.x - s * tex.y, s * tex.x + c * tex.y ) * scale;\nreturn ( sin( point.x ) * sin( point.y ) ) * 4.0;\n}\nvoid main() {\nvec4 color = texture2D( tDiffuse, vUv );\nfloat average = ( color.r + color.g + color.b ) / 3.0;\ngl_FragColor = vec4( vec3( average * 10.0 - 5.0 + pattern() ), color.a );\n}"},
vignette:{uniforms:{tDiffuse:{type:"t",value:0,texture:null},offset:{type:"f",value:1},darkness:{type:"f",value:1}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = vec2( uv.x, 1.0 - uv.y );\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform float offset;\nuniform float darkness;\nuniform sampler2D tDiffuse;\nvarying vec2 vUv;\nvoid main() {\nvec4 texel = texture2D( tDiffuse, vUv );\nvec2 uv = ( vUv - vec2( 0.5 ) ) * vec2( offset );\ngl_FragColor = vec4( mix( texel.rgb, vec3( 1.0 - darkness ), dot( uv, uv ) ), texel.a );\n}"},
bleachbypass:{uniforms:{tDiffuse:{type:"t",value:0,texture:null},opacity:{type:"f",value:1}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = vec2( uv.x, 1.0 - uv.y );\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform float opacity;\nuniform sampler2D tDiffuse;\nvarying vec2 vUv;\nvoid main() {\nvec4 base = texture2D( tDiffuse, vUv );\nvec3 lumCoeff = vec3( 0.25, 0.65, 0.1 );\nfloat lum = dot( lumCoeff, base.rgb );\nvec3 blend = vec3( lum );\nfloat L = min( 1.0, max( 0.0, 10.0 * ( lum - 0.45 ) ) );\nvec3 result1 = 2.0 * base.rgb * blend;\nvec3 result2 = 1.0 - 2.0 * ( 1.0 - blend ) * ( 1.0 - base.rgb );\nvec3 newColor = mix( result1, result2, L );\nfloat A2 = opacity * base.a;\nvec3 mixRGB = A2 * newColor.rgb;\nmixRGB += ( ( 1.0 - A2 ) * base.rgb );\ngl_FragColor = vec4( mixRGB, base.a );\n}"},
focus:{uniforms:{tDiffuse:{type:"t",value:0,texture:null},screenWidth:{type:"f",value:1024},screenHeight:{type:"f",value:1024},sampleDistance:{type:"f",value:0.94},waveFactor:{type:"f",value:0.00125}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = vec2( uv.x, 1.0 - uv.y );\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform float screenWidth;\nuniform float screenHeight;\nuniform float sampleDistance;\nuniform float waveFactor;\nuniform sampler2D tDiffuse;\nvarying vec2 vUv;\nvoid main() {\nvec4 color, org, tmp, add;\nfloat sample_dist, f;\nvec2 vin;\nvec2 uv = vUv;\nadd += color = org = texture2D( tDiffuse, uv );\nvin = ( uv - vec2( 0.5 ) ) * vec2( 1.4 );\nsample_dist = dot( vin, vin ) * 2.0;\nf = ( waveFactor * 100.0 + sample_dist ) * sampleDistance * 4.0;\nvec2 sampleSize = vec2(  1.0 / screenWidth, 1.0 / screenHeight ) * vec2( f );\nadd += tmp = texture2D( tDiffuse, uv + vec2( 0.111964, 0.993712 ) * sampleSize );\nif( tmp.b < color.b ) color = tmp;\nadd += tmp = texture2D( tDiffuse, uv + vec2( 0.846724, 0.532032 ) * sampleSize );\nif( tmp.b < color.b ) color = tmp;\nadd += tmp = texture2D( tDiffuse, uv + vec2( 0.943883, -0.330279 ) * sampleSize );\nif( tmp.b < color.b ) color = tmp;\nadd += tmp = texture2D( tDiffuse, uv + vec2( 0.330279, -0.943883 ) * sampleSize );\nif( tmp.b < color.b ) color = tmp;\nadd += tmp = texture2D( tDiffuse, uv + vec2( -0.532032, -0.846724 ) * sampleSize );\nif( tmp.b < color.b ) color = tmp;\nadd += tmp = texture2D( tDiffuse, uv + vec2( -0.993712, -0.111964 ) * sampleSize );\nif( tmp.b < color.b ) color = tmp;\nadd += tmp = texture2D( tDiffuse, uv + vec2( -0.707107, 0.707107 ) * sampleSize );\nif( tmp.b < color.b ) color = tmp;\ncolor = color * vec4( 2.0 ) - ( add / vec4( 8.0 ) );\ncolor = color + ( add / vec4( 8.0 ) - color ) * ( vec4( 1.0 ) - vec4( sample_dist * 0.5 ) );\ngl_FragColor = vec4( color.rgb * color.rgb * vec3( 0.95 ) + color.rgb, 1.0 );\n}"},
triangleBlur:{uniforms:{texture:{type:"t",value:0,texture:null},delta:{type:"v2",value:new THREE.Vector2(1,1)}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = vec2( uv.x, 1.0 - uv.y );\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"#define ITERATIONS 10.0\nuniform sampler2D texture;\nuniform vec2 delta;\nvarying vec2 vUv;\nfloat random( vec3 scale, float seed ) {\nreturn fract( sin( dot( gl_FragCoord.xyz + seed, scale ) ) * 43758.5453 + seed );\n}\nvoid main() {\nvec4 color = vec4( 0.0 );\nfloat total = 0.0;\nfloat offset = random( vec3( 12.9898, 78.233, 151.7182 ), 0.0 );\nfor ( float t = -ITERATIONS; t <= ITERATIONS; t ++ ) {\nfloat percent = ( t + offset - 0.5 ) / ITERATIONS;\nfloat weight = 1.0 - abs( percent );\ncolor += texture2D( texture, vUv + delta * percent ) * weight;\ntotal += weight;\n}\ngl_FragColor = color / total;\n}"},
basic:{uniforms:{},vertexShader:"void main() {\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"void main() {\ngl_FragColor = vec4( 1.0, 0.0, 0.0, 0.5 );\n}"},horizontalBlur:{uniforms:{tDiffuse:{type:"t",value:0,texture:null},h:{type:"f",value:1/512}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = vec2( uv.x, 1.0 - uv.y );\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D tDiffuse;\nuniform float h;\nvarying vec2 vUv;\nvoid main() {\nvec4 sum = vec4( 0.0 );\nsum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;\nsum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;\nsum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;\nsum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;\nsum += texture2D( tDiffuse, vec2( vUv.x, \t\t  \tvUv.y ) ) * 0.1633;\nsum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;\nsum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;\nsum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;\nsum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;\ngl_FragColor = sum;\n}"},
verticalBlur:{uniforms:{tDiffuse:{type:"t",value:0,texture:null},v:{type:"f",value:1/512}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = vec2( uv.x, 1.0 - uv.y );\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D tDiffuse;\nuniform float v;\nvarying vec2 vUv;\nvoid main() {\nvec4 sum = vec4( 0.0 );\nsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;\nsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;\nsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;\nsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;\nsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y\t\t\t  ) ) * 0.1633;\nsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;\nsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;\nsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;\nsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;\ngl_FragColor = sum;\n}"},
horizontalTiltShift:{uniforms:{tDiffuse:{type:"t",value:0,texture:null},h:{type:"f",value:1/512},r:{type:"f",value:0.35}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = vec2( uv.x, 1.0 - uv.y );\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D tDiffuse;\nuniform float h;\nuniform float r;\nvarying vec2 vUv;\nvoid main() {\nvec4 sum = vec4( 0.0 );\nfloat hh = h * abs( r - vUv.y );\nsum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * hh, vUv.y ) ) * 0.051;\nsum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * hh, vUv.y ) ) * 0.0918;\nsum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * hh, vUv.y ) ) * 0.12245;\nsum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * hh, vUv.y ) ) * 0.1531;\nsum += texture2D( tDiffuse, vec2( vUv.x, \t\t  \t vUv.y ) ) * 0.1633;\nsum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * hh, vUv.y ) ) * 0.1531;\nsum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * hh, vUv.y ) ) * 0.12245;\nsum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * hh, vUv.y ) ) * 0.0918;\nsum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * hh, vUv.y ) ) * 0.051;\ngl_FragColor = sum;\n}"},
verticalTiltShift:{uniforms:{tDiffuse:{type:"t",value:0,texture:null},v:{type:"f",value:1/512},r:{type:"f",value:0.35}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = vec2( uv.x, 1.0 - uv.y );\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D tDiffuse;\nuniform float v;\nuniform float r;\nvarying vec2 vUv;\nvoid main() {\nvec4 sum = vec4( 0.0 );\nfloat vv = v * abs( r - vUv.y );\nsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * vv ) ) * 0.051;\nsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * vv ) ) * 0.0918;\nsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * vv ) ) * 0.12245;\nsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * vv ) ) * 0.1531;\nsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y\t\t\t   ) ) * 0.1633;\nsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * vv ) ) * 0.1531;\nsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * vv ) ) * 0.12245;\nsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * vv ) ) * 0.0918;\nsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * vv ) ) * 0.051;\ngl_FragColor = sum;\n}"},
blend:{uniforms:{tDiffuse1:{type:"t",value:0,texture:null},tDiffuse2:{type:"t",value:1,texture:null},mixRatio:{type:"f",value:0.5},opacity:{type:"f",value:1}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = vec2( uv.x, 1.0 - uv.y );\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform float opacity;\nuniform float mixRatio;\nuniform sampler2D tDiffuse1;\nuniform sampler2D tDiffuse2;\nvarying vec2 vUv;\nvoid main() {\nvec4 texel1 = texture2D( tDiffuse1, vUv );\nvec4 texel2 = texture2D( tDiffuse2, vUv );\nvec3 ca = vec3(texel1.x,texel1.y,texel1.z);\nvec3 cb = vec3(texel2.x,texel2.y,texel2.z);\nfloat alphaa = texel1.w ;\nfloat alphab = texel2.w*mixRatio;\nfloat alphao = (alphaa + alphab * (1.0-alphaa));\nvec3 co = (1.0/alphao) * (ca * alphaa + cb*alphab*(1.0-alphaa));\nvec4 mixxx = vec4(co, alphao );\ngl_FragColor =  mixxx;\n}"},
fxaa:{uniforms:{tDiffuse:{type:"t",value:0,texture:null},resolution:{type:"v2",value:new THREE.Vector2(1/1024,1/512)}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = vec2( uv.x, 1.0 - uv.y );\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D tDiffuse;\nuniform vec2 resolution;\nvarying vec2 vUv;\n#define FXAA_REDUCE_MIN   (1.0/128.0)\n#define FXAA_REDUCE_MUL   (1.0/8.0)\n#define FXAA_SPAN_MAX     8.0\nvoid main() {\nvec3 rgbNW = texture2D( tDiffuse, ( gl_FragCoord.xy + vec2( -1.0, -1.0 ) ) * resolution ).xyz;\nvec3 rgbNE = texture2D( tDiffuse, ( gl_FragCoord.xy + vec2( 1.0, -1.0 ) ) * resolution ).xyz;\nvec3 rgbSW = texture2D( tDiffuse, ( gl_FragCoord.xy + vec2( -1.0, 1.0 ) ) * resolution ).xyz;\nvec3 rgbSE = texture2D( tDiffuse, ( gl_FragCoord.xy + vec2( 1.0, 1.0 ) ) * resolution ).xyz;\nvec4 rgbaM  = texture2D( tDiffuse,  gl_FragCoord.xy  * resolution );\nvec3 rgbM  = rgbaM.xyz;\nfloat opacity  = rgbaM.w;\nvec3 luma = vec3( 0.299, 0.587, 0.114 );\nfloat lumaNW = dot( rgbNW, luma );\nfloat lumaNE = dot( rgbNE, luma );\nfloat lumaSW = dot( rgbSW, luma );\nfloat lumaSE = dot( rgbSE, luma );\nfloat lumaM  = dot( rgbM,  luma );\nfloat lumaMin = min( lumaM, min( min( lumaNW, lumaNE ), min( lumaSW, lumaSE ) ) );\nfloat lumaMax = max( lumaM, max( max( lumaNW, lumaNE) , max( lumaSW, lumaSE ) ) );\nvec2 dir;\ndir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\ndir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\nfloat dirReduce = max( ( lumaNW + lumaNE + lumaSW + lumaSE ) * ( 0.25 * FXAA_REDUCE_MUL ), FXAA_REDUCE_MIN );\nfloat rcpDirMin = 1.0 / ( min( abs( dir.x ), abs( dir.y ) ) + dirReduce );\ndir = min( vec2( FXAA_SPAN_MAX,  FXAA_SPAN_MAX),\nmax( vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\ndir * rcpDirMin)) * resolution;\nvec3 rgbA = 0.5 * (\ntexture2D( tDiffuse, gl_FragCoord.xy  * resolution + dir * ( 1.0 / 3.0 - 0.5 ) ).xyz +\ntexture2D( tDiffuse, gl_FragCoord.xy  * resolution + dir * ( 2.0 / 3.0 - 0.5 ) ).xyz );\nvec3 rgbB = rgbA * 0.5 + 0.25 * (\ntexture2D( tDiffuse, gl_FragCoord.xy  * resolution + dir * -0.5 ).xyz +\ntexture2D( tDiffuse, gl_FragCoord.xy  * resolution + dir * 0.5 ).xyz );\nfloat lumaB = dot( rgbB, luma );\nif ( ( lumaB < lumaMin ) || ( lumaB > lumaMax ) ) {\ngl_FragColor = vec4( rgbA, opacity );\n} else {\ngl_FragColor = vec4( rgbB, opacity );\n}\n}"},
luminosity:{uniforms:{tDiffuse:{type:"t",value:0,texture:null}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = vec2( uv.x, 1.0 - uv.y );\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D tDiffuse;\nvarying vec2 vUv;\nvoid main() {\nvec4 texel = texture2D( tDiffuse, vUv );\nvec3 luma = vec3( 0.299, 0.587, 0.114 );\nfloat v = dot( texel.xyz, luma );\ngl_FragColor = vec4( v, v, v, texel.w );\n}"},colorCorrection:{uniforms:{tDiffuse:{type:"t",
value:0,texture:null},powRGB:{type:"v3",value:new THREE.Vector3(2,2,2)},mulRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = vec2( uv.x, 1.0 - uv.y );\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D tDiffuse;\nuniform vec3 powRGB;\nuniform vec3 mulRGB;\nvarying vec2 vUv;\nvoid main() {\ngl_FragColor = texture2D( tDiffuse, vUv );\ngl_FragColor.rgb = mulRGB * pow( gl_FragColor.rgb, powRGB );\n}"},
normalmap:{uniforms:{heightMap:{type:"t",value:0,texture:null},resolution:{type:"v2",value:new THREE.Vector2(512,512)},scale:{type:"v2",value:new THREE.Vector2(1,1)},height:{type:"f",value:0.05}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = vec2( uv.x, 1.0 - uv.y );\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform float height;\nuniform vec2 resolution;\nuniform sampler2D heightMap;\nvarying vec2 vUv;\nvoid main() {\nfloat val = texture2D( heightMap, vUv ).x;\nfloat valU = texture2D( heightMap, vUv + vec2( 1.0 / resolution.x, 0.0 ) ).x;\nfloat valV = texture2D( heightMap, vUv + vec2( 0.0, 1.0 / resolution.y ) ).x;\ngl_FragColor = vec4( ( 0.5 * normalize( vec3( val - valU, val - valV, height  ) ) + 0.5 ), 1.0 );\n}"},
ssao:{uniforms:{tDiffuse:{type:"t",value:0,texture:null},tDepth:{type:"t",value:1,texture:null},size:{type:"v2",value:new THREE.Vector2(512,512)},cameraNear:{type:"f",value:1},cameraFar:{type:"f",value:100},fogNear:{type:"f",value:5},fogFar:{type:"f",value:100},fogEnabled:{type:"i",value:0},aoClamp:{type:"f",value:0.3}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = vec2( uv.x, 1.0 - uv.y );\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform float cameraNear;\nuniform float cameraFar;\nuniform float fogNear;\nuniform float fogFar;\nuniform bool fogEnabled;\nuniform vec2 size;\nuniform float aoClamp;\nuniform sampler2D tDiffuse;\nuniform sampler2D tDepth;\nvarying vec2 vUv;\n#define DL 2.399963229728653\n#define EULER 2.718281828459045\nfloat width = size.x;\nfloat height = size.y;\nfloat cameraFarPlusNear = cameraFar + cameraNear;\nfloat cameraFarMinusNear = cameraFar - cameraNear;\nfloat cameraCoef = 2.0 * cameraNear;\nconst int samples = 8;\nconst float radius = 5.0;\nconst bool useNoise = false;\nconst float noiseAmount = 0.0002;\nconst float diffArea = 0.4;\nconst float gDisplace = 0.4;\nconst bool onlyAO = false;\nconst float lumInfluence = 0.3;\nfloat unpackDepth( const in vec4 rgba_depth ) {\nconst vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\nfloat depth = dot( rgba_depth, bit_shift );\nreturn depth;\n}\nvec2 rand( const vec2 coord ) {\nvec2 noise;\nif ( useNoise ) {\nfloat nx = dot ( coord, vec2( 12.9898, 78.233 ) );\nfloat ny = dot ( coord, vec2( 12.9898, 78.233 ) * 2.0 );\nnoise = clamp( fract ( 43758.5453 * sin( vec2( nx, ny ) ) ), 0.0, 1.0 );\n} else {\nfloat ff = fract( 1.0 - coord.s * ( width / 2.0 ) );\nfloat gg = fract( coord.t * ( height / 2.0 ) );\nnoise = vec2( 0.25, 0.75 ) * vec2( ff ) + vec2( 0.75, 0.25 ) * gg;\n}\nreturn ( noise * 2.0  - 1.0 ) * noiseAmount;\n}\nfloat doFog() {\nfloat zdepth = unpackDepth( texture2D( tDepth, vUv ) );\nfloat depth = -cameraFar * cameraNear / ( zdepth * cameraFarMinusNear - cameraFar );\nreturn smoothstep( fogNear, fogFar, depth );\n}\nfloat readDepth( const in vec2 coord ) {\nreturn cameraCoef / ( cameraFarPlusNear - unpackDepth( texture2D( tDepth, coord ) ) * cameraFarMinusNear );\n}\nfloat compareDepths( const in float depth1, const in float depth2, inout int far ) {\nfloat garea = 2.0;\nfloat diff = ( depth1 - depth2 ) * 100.0;\nif ( diff < gDisplace ) {\ngarea = diffArea;\n} else {\nfar = 1;\n}\nfloat dd = diff - gDisplace;\nfloat gauss = pow( EULER, -2.0 * dd * dd / ( garea * garea ) );\nreturn gauss;\n}\nfloat calcAO( float depth, float dw, float dh ) {\nfloat dd = radius - depth * radius;\nvec2 vv = vec2( dw, dh );\nvec2 coord1 = vUv + dd * vv;\nvec2 coord2 = vUv - dd * vv;\nfloat temp1 = 0.0;\nfloat temp2 = 0.0;\nint far = 0;\ntemp1 = compareDepths( depth, readDepth( coord1 ), far );\nif ( far > 0 ) {\ntemp2 = compareDepths( readDepth( coord2 ), depth, far );\ntemp1 += ( 1.0 - temp1 ) * temp2;\n}\nreturn temp1;\n}\nvoid main() {\nvec2 noise = rand( vUv );\nfloat depth = readDepth( vUv );\nfloat tt = clamp( depth, aoClamp, 1.0 );\nfloat w = ( 1.0 / width )  / tt + ( noise.x * ( 1.0 - noise.x ) );\nfloat h = ( 1.0 / height ) / tt + ( noise.y * ( 1.0 - noise.y ) );\nfloat pw;\nfloat ph;\nfloat ao;\nfloat dz = 1.0 / float( samples );\nfloat z = 1.0 - dz / 2.0;\nfloat l = 0.0;\nfor ( int i = 0; i <= samples; i ++ ) {\nfloat r = sqrt( 1.0 - z );\npw = cos( l ) * r;\nph = sin( l ) * r;\nao += calcAO( depth, pw * w, ph * h );\nz = z - dz;\nl = l + DL;\n}\nao /= float( samples );\nao = 1.0 - ao;\nif ( fogEnabled ) {\nao = mix( ao, 1.0, doFog() );\n}\nvec3 color = texture2D( tDiffuse, vUv ).rgb;\nvec3 lumcoeff = vec3( 0.299, 0.587, 0.114 );\nfloat lum = dot( color.rgb, lumcoeff );\nvec3 luminance = vec3( lum );\nvec3 final = vec3( color * mix( vec3( ao ), vec3( 1.0 ), luminance * lumInfluence ) );\nif ( onlyAO ) {\nfinal = vec3( mix( vec3( ao ), vec3( 1.0 ), luminance * lumInfluence ) );\n}\ngl_FragColor = vec4( final, 1.0 );\n}"},
colorify:{uniforms:{tDiffuse:{type:"t",value:0,texture:null},color:{type:"c",value:new THREE.Color(16777215)}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = vec2( uv.x, 1.0 - uv.y );\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform vec3 color;\nuniform sampler2D tDiffuse;\nvarying vec2 vUv;\nvoid main() {\nvec4 texel = texture2D( tDiffuse, vUv );\nvec3 luma = vec3( 0.299, 0.587, 0.114 );\nfloat v = dot( texel.xyz, luma );\ngl_FragColor = vec4( v * color, texel.w );\n}"},
unpackDepthRGBA:{uniforms:{tDiffuse:{type:"t",value:0,texture:null},opacity:{type:"f",value:1}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = vec2( uv.x, 1.0 - uv.y );\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform float opacity;\nuniform sampler2D tDiffuse;\nvarying vec2 vUv;\nfloat unpackDepth( const in vec4 rgba_depth ) {\nconst vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\nfloat depth = dot( rgba_depth, bit_shift );\nreturn depth;\n}\nvoid main() {\nfloat depth = 1.0 - unpackDepth( texture2D( tDiffuse, vUv ) );\ngl_FragColor = opacity * vec4( vec3( depth ), 1.0 );\n}"},
buildKernel:function(a){var b,c,f,h,i=2*Math.ceil(3*a)+1;25<i&&(i=25);h=0.5*(i-1);c=Array(i);for(b=f=0;b<i;++b)c[b]=Math.exp(-((b-h)*(b-h))/(2*a*a)),f+=c[b];for(b=0;b<i;++b)c[b]/=f;return c}};
THREE.EffectComposer=function(a,b){this.renderer=a;this.renderTarget1=b;void 0===this.renderTarget1&&(this.renderTargetParameters={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBFormat,stencilBufer:!1},this.renderTarget1=new THREE.WebGLRenderTarget(window.innerWidth,window.innerHeight,this.renderTargetParameters));this.renderTarget2=this.renderTarget1.clone();this.writeBuffer=this.renderTarget1;this.readBuffer=this.renderTarget2;this.passes=[];this.copyPass=new THREE.ShaderPass(THREE.ShaderExtras.screen)};
THREE.EffectComposer.prototype={swapBuffers:function(){var a=this.readBuffer;this.readBuffer=this.writeBuffer;this.writeBuffer=a},addPass:function(a){this.passes.push(a)},render:function(a){this.writeBuffer=this.renderTarget1;this.readBuffer=this.renderTarget2;var b=!1,c,f,h=this.passes.length;for(f=0;f<h;f++)if(c=this.passes[f],c.enabled){c.render(this.renderer,this.writeBuffer,this.readBuffer,a,b);if(c.needsSwap){if(b){var i=this.renderer.context;i.stencilFunc(i.NOTEQUAL,1,4294967295);this.copyPass.render(this.renderer,
this.writeBuffer,this.readBuffer,a);i.stencilFunc(i.EQUAL,1,4294967295)}this.swapBuffers()}c instanceof THREE.MaskPass?b=!0:c instanceof THREE.ClearMaskPass&&(b=!1)}},reset:function(a){this.renderTarget1=a;void 0===this.renderTarget1&&(this.renderTarget1=new THREE.WebGLRenderTarget(window.innerWidth,window.innerHeight,this.renderTargetParameters));this.renderTarget2=this.renderTarget1.clone();this.writeBuffer=this.renderTarget1;this.readBuffer=this.renderTarget2;THREE.EffectComposer.quad.scale.set(window.innerWidth,
window.innerHeight,1);THREE.EffectComposer.camera.left=window.innerWidth/-2;THREE.EffectComposer.camera.right=window.innerWidth/2;THREE.EffectComposer.camera.top=window.innerHeight/2;THREE.EffectComposer.camera.bottom=window.innerHeight/-2;THREE.EffectComposer.camera.updateProjectionMatrix()}};THREE.EffectComposer.camera=new THREE.OrthographicCamera(window.innerWidth/-2,window.innerWidth/2,window.innerHeight/2,window.innerHeight/-2,-1E4,1E4);
THREE.EffectComposer.geometry=new THREE.PlaneGeometry(1,1);THREE.EffectComposer.quad=new THREE.Mesh(THREE.EffectComposer.geometry,null);THREE.EffectComposer.quad.position.z=-100;THREE.EffectComposer.quad.scale.set(window.innerWidth,window.innerHeight,1);THREE.EffectComposer.scene=new THREE.Scene;THREE.EffectComposer.scene.add(THREE.EffectComposer.quad);THREE.EffectComposer.scene.add(THREE.EffectComposer.camera);
THREE.RenderPass=function(a,b,c,f,h){this.scene=a;this.camera=b;this.overrideMaterial=c;this.clearColor=f;this.clearAlpha=void 0!==h?h:1;this.oldClearColor=new THREE.Color;this.oldClearAlpha=1;this.clear=this.enabled=!0;this.needsSwap=!1};
THREE.RenderPass.prototype={render:function(a,b,c){this.scene.overrideMaterial=this.overrideMaterial;this.clearColor&&(this.oldClearColor.copy(a.getClearColor()),this.oldClearAlpha=a.getClearAlpha(),a.setClearColor(this.clearColor,this.clearAlpha));a.render(this.scene,this.camera,c,this.clear);this.clearColor&&a.setClearColor(this.oldClearColor,this.oldClearAlpha);this.scene.overrideMaterial=null}};
THREE.ShaderPass=function(a,b){this.textureID=void 0!==b?b:"tDiffuse";this.uniforms=THREE.UniformsUtils.clone(a.uniforms);this.material=new THREE.ShaderMaterial({uniforms:this.uniforms,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader});this.renderToScreen=!1;this.needsSwap=this.enabled=!0;this.clear=!1};
THREE.ShaderPass.prototype={render:function(a,b,c){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].texture=c);THREE.EffectComposer.quad.material=this.material;this.renderToScreen?a.render(THREE.EffectComposer.scene,THREE.EffectComposer.camera):a.render(THREE.EffectComposer.scene,THREE.EffectComposer.camera,b,this.clear)}};THREE.MaskPass=function(a,b){this.scene=a;this.camera=b;this.clear=this.enabled=!0;this.inverse=this.needsSwap=!1};
THREE.MaskPass.prototype={render:function(a,b,c){var f=a.context;f.colorMask(!1,!1,!1,!1);f.depthMask(!1);var h,i;this.inverse?(h=0,i=1):(h=1,i=0);f.enable(f.STENCIL_TEST);f.stencilOp(f.REPLACE,f.REPLACE,f.REPLACE);f.stencilFunc(f.ALWAYS,h,4294967295);f.clearStencil(i);a.render(this.scene,this.camera,c,this.clear);a.render(this.scene,this.camera,b,this.clear);f.colorMask(!0,!0,!0,!0);f.depthMask(!0);f.stencilFunc(f.EQUAL,1,4294967295);f.stencilOp(f.KEEP,f.KEEP,f.KEEP)}};
THREE.ClearMaskPass=function(){this.enabled=!0};THREE.ClearMaskPass.prototype={render:function(a){a=a.context;a.disable(a.STENCIL_TEST)}};
THREE.SavePass=function(a){var b=THREE.ShaderExtras.screen;this.textureID="tDiffuse";this.uniforms=THREE.UniformsUtils.clone(b.uniforms);this.material=new THREE.ShaderMaterial({uniforms:this.uniforms,vertexShader:b.vertexShader,fragmentShader:b.fragmentShader});this.renderTarget=a;void 0===this.renderTarget&&(this.renderTargetParameters={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBFormat,stencilBufer:!1},this.renderTarget=new THREE.WebGLRenderTarget(window.innerWidth,
window.innerHeight,this.renderTargetParameters));this.enabled=!0;this.clear=this.needsSwap=!1};THREE.SavePass.prototype={render:function(a,b,c){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].texture=c);THREE.EffectComposer.quad.material=this.material;a.render(THREE.EffectComposer.scene,THREE.EffectComposer.camera,this.renderTarget,this.clear)}};
CodeMirror.defineMode("livecodelab",function(a){function b(a){return RegExp("^(("+a.join(")|(")+"))\\b")}function c(a,b){if(a.sol()){var c=b.scopes[0].offset;if(a.eatSpace()){var h=a.indentation();return h>c?"indent":h<c?"dedent":null}0<c&&i(a,b)}if(a.eatSpace())return null;c=a.peek();if("#"===c||"/"===c&&a.match(/\/\//i))return a.skipToEnd(),"comment";if(a.match(/^-?[0-9\.]/,!1)){c=!1;a.match(/^-?\d*\.\d+(e[\+\-]?\d+)?/i)&&(c=!0);a.match(/^-?\d+\.\d*/)&&(c=!0);a.match(/^-?\.\d+/)&&(c=!0);if(c)return"number";
c=!1;a.match(/^-?0x[0-9a-f]+/i)&&(c=!0);a.match(/^-?[1-9]\d*(e[\+\-]?\d+)?/)&&(c=!0);a.match(/^-?0(?![\dx])/i)&&(c=!0);if(c)return"number"}if(a.match(p))return b.tokenize=f(a.current(),"string"),b.tokenize(a,b);if(a.match(q)){if("/"!=a.current()||a.match(/^.*\//,!1))return b.tokenize=f(a.current(),"string-2"),b.tokenize(a,b);a.backUp(1)}if(a.match(l)||a.match(k))return"punctuation";if(a.match(o)||a.match(d)||a.match(n))return"operator";if(a.match(e))return"punctuation";if(a.match(t))return"atom";
if(a.match(r))return"keyword";if(a.match(m))return"variable";a.next();return g}function f(b,d){var e=RegExp(b),f=1==b.length;return function(b,h){for(;!b.eol();)if(b.eatWhile(/[^'"\/\\]/),b.eat("\\")){if(b.next(),f&&b.eol())return d}else{if(b.match(e))return h.tokenize=c,d;b.eat(/['"\/]/)}f&&(a.mode.singleLineStringErrors?d=g:h.tokenize=c);return d}}function h(b,c,d){var d=d||"coffee",e=0;if("coffee"===d)for(b=0;b<c.scopes.length;b++){if("coffee"===c.scopes[b].type){e=c.scopes[b].offset+a.indentUnit;
break}}else e=b.column()+b.current().length;c.scopes.unshift({offset:e,type:d})}function i(a,b){if(1!=b.scopes.length){if("coffee"===b.scopes[0].type){for(var c=a.indentation(),d=-1,e=0;e<b.scopes.length;++e)if(c===b.scopes[e].offset){d=e;break}if(-1===d)return!0;for(;b.scopes[0].offset!==c;)b.scopes.shift()}else b.scopes.shift();return!1}}function j(a,b){var c=b.tokenize(a,b),d=a.current();if("."===d)return c=b.tokenize(a,b),a.current(),"variable"===c?"variable":g;if("@"===d)return c=b.tokenize(a,
b),a.current(),"variable"===c?"variable-2":g;"return"===d&&(b.dedent+=1);(("->"===d||"=>"===d)&&!b.lambda&&"coffee"==b.scopes[0].type&&""===a.peek()||"indent"===c)&&h(a,b);var e="[({".indexOf(d);-1!==e&&h(a,b,"])}".slice(e,e+1));s.exec(d)&&h(a,b);"then"==d&&i(a,b);if("dedent"===c&&i(a,b))return g;e="])}".indexOf(d);if(-1!==e&&i(a,b))return g;0<b.dedent&&a.eol()&&"coffee"==b.scopes[0].type&&(1<b.scopes.length&&b.scopes.shift(),b.dedent-=1);return c}var g="error",d=/^[\+\-\*/%&|\^~<>!?]/,e=/^[\(\)\[\]\{\}@,:`=;\.]/,
o=RegExp("^((->)|(=>)|(\\+\\+)|(\\+\\=)|(\\-\\-)|(\\-\\=)|(\\*\\*)|(\\*\\=)|(\\/\\/)|(\\/\\=)|(==)|(!=)|(<=)|(>=)|(<>)|(<<)|(>>)|(//))"),k=/^((\.\.)|(\+=)|(\-=)|(\*=)|(%=)|(\/=)|(&=)|(\|=)|(\^=))/,l=/^((\.\.\.)|(\/\/=)|(>>=)|(<<=)|(\*\*=))/,m=/^[_A-Za-z][_A-Za-z0-9]*/,n=b("and,or,not,is,isnt,in,instanceof,typeof".split(",")),s="draw,for,while,loop,if,unless,else,switch,try,catch,finally,class".split(","),r=b(s.concat("break,by,continue,debugger,delete,do,in,of,new,return,then,this,throw,when,until".split(","))),
s=b(s),p=/^('{3}|"{3}|['"])/,q=/^(\/{3}|\/)/,t=b("Infinity,NaN,undefined,null,true,false,on,off,yes,no".split(","));return{startState:function(a){return{tokenize:c,scopes:[{offset:a||0,type:"coffee"}],lastToken:null,lambda:!1,dedent:0}},token:function(a,b){if(a.match(/\/\/\s*(next-tutorial:([^\s]+))\b/))return"link";var c=j(a,b);b.lastToken={style:c,content:a.current()};a.eol()&&a.lambda&&(b.lambda=!1);return c},indent:function(a){return a.tokenize!=c?0:a.scopes[0].offset}}});
CodeMirror.defineMIME("text/x-coffeescript","coffeescript");
var stats,scene,renderer,camera,isWebGLUsed=!1,linesPool=[],rectanglesPool=[],boxesPool=[],cylindersPool=[],spheresPool={},sphereGeometriesPool={},ambientLightsPool=[],pointLightsPool=[],usedLines=0,usedRectangles=0,usedBoxes=0,usedCylinders=0,usedAmbientLights=0,usedPointLights=0,usedSpheres={},ballDefaultDetLevel,ballDetLevel,currentStrokeSize=1,cubeGeometry=new THREE.CubeGeometry(1,1,1),planeGeometry=new THREE.PlaneGeometry(1,1),lineGeometry=new THREE.Geometry,cylinderGeometry=new THREE.CylinderGeometry(0.5,
0.5,1,32);lineGeometry.vertices.push(new THREE.Vertex(new THREE.Vector3(0,-0.5,0)));lineGeometry.vertices.push(new THREE.Vertex(new THREE.Vector3(0,0.5,0)));
var worldMatrix=new THREE.Matrix4,frenchVersion=!1,forceCanvasRenderer=!1,backgroundScene,backgroundSceneContext,sceneRenderingCanvas,sceneRenderingCanvasContext,previousRenderForBlending,previousRenderForBlendingContext,finalRenderWithSceneAndBlend,finalRenderWithSceneAndBlendContext,useRequestAnimationFrame=!0,wantedFramesPerSecond=-1,backGroundFraction=15,scaledBackgroundWidth,scaledBackgroundHeight,repaintBackroundEveryFrame=!0,fullScreenifyBackground=!0,animationStyleValue=0,previousanimationStyleValue=
0,currentGradientStackValue="",previousGradientStackValue=0,blendAmount=0,normal=0,paintOver=1,motionBlur=2,soundLoops=[];soundLoops.soundIDs=[];soundLoops.beatStrings=[];var programHasBasicError=!1,reasonOfBasicError="",consecutiveFramesWithoutRunTimeError=0,out,lastStableProgram,doTheSpinThingy=!0,resetTheSpinThingy=!1,SPINFRAMES=30,userWarnedAboutWebglExamples=!1,dimIntervalID;function isCanvasSupported(){var a=document.createElement("canvas");return!(!a.getContext||!a.getContext("2d"))}
var aliceblue=4293982463,antiquewhite=4294634455,aqua=4278255615,aquamarine=4286578644,azure=4293984255,beige=4294309340,bisque=4294960324,black=4278190080,blanchedalmond=4294962125,blue=4278190335,blueviolet=4287245282,brown=4289014314,burlywood=4292786311,cadetblue=4284456608,chartreuse=4286578432,chocolate=4291979550,coral=4294934352,cornflowerblue=4284782061,cornsilk=4294965468,crimson=4292613180,cyan=4278255615,darkblue=4278190219,darkcyan=4278225803,darkgoldenrod=4290283019,darkgray=4289309097,
darkgrey=4289309097,darkgreen=4278215680,darkkhaki=4290623339,darkmagenta=4287299723,darkolivegreen=4283788079,darkorange=4294937600,darkorchid=4288230092,darkred=4287299584,darksalmon=4293498490,darkseagreen=4287609999,darkslateblue=4282924427,darkslategray=4281290575,darkslategrey=4281290575,darkturquoise=4278243025,darkviolet=4287889619,deeppink=4294907027,deepskyblue=4278239231,dimgray=4285098345,dimgrey=4285098345,dodgerblue=4280193279,firebrick=4289864226,floralwhite=4294966E3,forestgreen=4280453922,
fuchsia=4294902015,gainsboro=4292664540,ghostwhite=4294506751,gold=4294956800,goldenrod=4292519200,gray=4286611584,grey=4286611584,green=4278222848,greenyellow=4289593135,honeydew=4293984240,hotpink=4294928820,indianred=4291648604,indigo=4283105410,ivory=4294967280,khaki=4293977740,lavender=4293322490,lavenderblush=4294963445,lawngreen=4286381056,lemonchiffon=4294965965,lightblue=4289583334,lightcoral=4293951616,lightcyan=4292935679,lightgoldenrodyellow=4294638290,lightgrey=4292072403,lightgray=4292072403,
lightgreen=4287688336,lightpink=4294948545,lightsalmon=4294942842,lightseagreen=4280332970,lightskyblue=4287090426,lightslategray=4286023833,lightslategrey=4286023833,lightsteelblue=4289774814,lightyellow=4294967264,lime=4278255360,limegreen=4281519410,linen=4294635750,magenta=4294902015,maroon=4286578688,mediumaquamarine=4284927402,mediumblue=4278190285,mediumorchid=4290401747,mediumpurple=4287852760,mediumseagreen=4282168177,mediumslateblue=4286277870,mediumspringgreen=4278254234,mediumturquoise=
4282962380,mediumvioletred=4291237253,midnightblue=4279834992,mintcream=4294311930,mistyrose=4294960353,moccasin=4294960309,navajowhite=4294958765,navy=4278190208,oldlace=4294833638,olive=4286611456,olivedrab=4285238819,orange=4294944E3,orangered=4294919424,orchid=4292505814,palegoldenrod=4293847210,palegreen=4288215960,paleturquoise=4289720046,palevioletred=4292374675,papayawhip=4294963157,peachpuff=4294957753,peru=4291659071,pink=4294951115,plum=4292714717,powderblue=4289781990,purple=4286578816,
red=4294901760,rosybrown=4290547599,royalblue=4282477025,saddlebrown=4287317267,salmon=4294606962,sandybrown=4294222944,seagreen=4281240407,seashell=4294964718,sienna=4288696877,silver=4290822336,skyblue=4287090411,slateblue=4285160141,slategray=4285563024,slategrey=4285563024,snow=4294966010,springgreen=4278255487,steelblue=4282811060,tan=4291998860,teal=4278222976,thistle=4292394968,tomato=4294927175,turquoise=4282441936,violet=4293821166,wheat=4294303411,white=4294967295,whitesmoke=4294309365,
yellow=4294967040,yellowgreen=4288335154,Constants={RGB:1,ARGB:2,HSB:3,ALPHA:4,CMYK:5,REPLACE:0,BLEND:1,ADD:2,SUBTRACT:4,LIGHTEST:8,DARKEST:16,DIFFERENCE:32,EXCLUSION:64,MULTIPLY:128,SCREEN:256,OVERLAY:512,HARD_LIGHT:1024,SOFT_LIGHT:2048,DODGE:4096,BURN:8192,ALPHA_MASK:4278190080,RED_MASK:16711680,GREEN_MASK:65280,BLUE_MASK:255},doFill=!0,fillStyle=[1,1,1,1],isFillDirty=!0,doStroke=!0,strokeStyle=[0,0,0,1],isStrokeDirty=!0,lineWidth=1,colorModeA=255,colorModeX=255,colorModeY=255,colorModeZ=255,curColorMode=
Constants.RGB,max=function(){if(2===arguments.length)return arguments[0]<arguments[1]?arguments[1]:arguments[0];var a=1===arguments.length?arguments[0]:arguments;if(!("length"in a&&0<a.length))throw"Non-empty array is expected";for(var b=a[0],c=a.length,f=1;f<c;++f)b<a[f]&&(b=a[f]);return b},min=function(){if(2===arguments.length)return arguments[0]<arguments[1]?arguments[0]:arguments[1];var a=1===arguments.length?arguments[0]:arguments;if(!("length"in a&&0<a.length))throw"Non-empty array is expected";
for(var b=a[0],c=a.length,f=1;f<c;++f)b>a[f]&&(b=a[f]);return b};function color$4(a,b,c,f){curColorMode===Constants.HSB?(c=color.toRGB(a,b,c),a=c[0],b=c[1],c=c[2]):(a=Math.round(255*(a/colorModeX)),b=Math.round(255*(b/colorModeY)),c=Math.round(255*(c/colorModeZ)));f=Math.round(255*(f/colorModeA));a=0>a?0:a;b=0>b?0:b;c=0>c?0:c;f=0>f?0:f;return(255<f?255:f)<<24&Constants.ALPHA_MASK|(255<a?255:a)<<16&Constants.RED_MASK|(255<b?255:b)<<8&Constants.GREEN_MASK|(255<c?255:c)&Constants.BLUE_MASK}
function color$2(a,b){var c;if(a===angleColor)return angleColor;if(a&Constants.ALPHA_MASK)return c=Math.round(255*(b/colorModeA)),c=255<c?255:c,a-(a&Constants.ALPHA_MASK)+((0>c?0:c)<<24&Constants.ALPHA_MASK);if(curColorMode===Constants.RGB)return color$4(a,a,a,b);if(curColorMode===Constants.HSB)return color$4(0,0,a/colorModeX*colorModeZ,b)}
function color$1(a){if(a<=colorModeX&&0<=a){if(curColorMode===Constants.RGB)return color$4(a,a,a,colorModeA);if(curColorMode===Constants.HSB)return color$4(0,0,a/colorModeX*colorModeZ,colorModeA)}if(a)return 2147483647<a&&(a-=4294967296),a}
var color=function(a,b,c,f){return void 0!==a&&void 0!==b&&void 0!==c&&void 0!==f?color$4(a,b,c,f):void 0!==a&&void 0!==b&&void 0!==c?color$4(a,b,c,colorModeA):void 0!==a&&void 0!==b?color$2(a,b):"number"===typeof a?color$1(a):color$4(colorModeX,colorModeY,colorModeZ,colorModeA)};color.toString=function(a){return"rgba("+((a&Constants.RED_MASK)>>>16)+","+((a&Constants.GREEN_MASK)>>>8)+","+(a&Constants.BLUE_MASK)+","+((a&Constants.ALPHA_MASK)>>>24)/255+")"};
color.toInt=function(a,b,c,f){return f<<24&Constants.ALPHA_MASK|a<<16&Constants.RED_MASK|b<<8&Constants.GREEN_MASK|c&Constants.BLUE_MASK};color.toArray=function(a){return[(a&Constants.RED_MASK)>>>16,(a&Constants.GREEN_MASK)>>>8,a&Constants.BLUE_MASK,(a&Constants.ALPHA_MASK)>>>24]};color.toGLArray=function(a){return[((a&Constants.RED_MASK)>>>16)/255,((a&Constants.GREEN_MASK)>>>8)/255,(a&Constants.BLUE_MASK)/255,((a&Constants.ALPHA_MASK)>>>24)/255]};
color.toRGB=function(a,b,c){var a=a>colorModeX?colorModeX:a,b=b>colorModeY?colorModeY:b,c=c>colorModeZ?colorModeZ:c,a=360*(a/colorModeX),b=100*(b/colorModeY),c=100*(c/colorModeZ),f=Math.round(255*(c/100));if(0===b)return[f,f,f];var a=a%360,h=a%60,i=Math.round(255*(c*(100-b)/1E4)),j=Math.round(255*(c*(6E3-b*h)/6E5)),b=Math.round(255*(c*(6E3-b*(60-h))/6E5));switch(Math.floor(a/60)){case 0:return[f,b,i];case 1:return[j,f,i];case 2:return[i,f,b];case 3:return[i,j,f];case 4:return[b,i,f];case 5:return[f,
i,j]}};function colorToHSB(a){var b,c;b=((a&Constants.RED_MASK)>>>16)/255;c=((a&Constants.GREEN_MASK)>>>8)/255;var a=(a&Constants.BLUE_MASK)/255,f=f(f(b,c),a),h=h(h(b,c),a);if(h===f)return[0,0,f*colorModeZ];b=(b===f?(c-a)/(f-h):c===f?2+(a-b)/(f-h):4+(b-c)/(f-h))/6;0>b?b+=1:1<b&&(b-=1);return[b*colorModeX,(f-h)/f*colorModeY,f*colorModeZ]}
var brightness=function(a){return colorToHSB(a)[2]},saturation=function(a){return colorToHSB(a)[1]},hue=function(a){return colorToHSB(a)[0]},redF=function(a){return((a&Constants.RED_MASK)>>>16)/255*colorModeX},greenF=function(a){return((a&Constants.GREEN_MASK)>>>8)/255*colorModeY},blueF=function(a){return(a&Constants.BLUE_MASK)/255*colorModeZ},alpha=function(a){return((a&Constants.ALPHA_MASK)>>>24)/255*colorModeA},alphaZeroToOne=function(a){return((a&Constants.ALPHA_MASK)>>>24)/255},lerp=function(a,
b,c){return(b-a)*c+a},lerpColor=function(a,b,c){var f,h,i,j,g,d,a=color(a),b=color(b);if(curColorMode===Constants.HSB)return i=colorToHSB(a),a=((a&Constants.ALPHA_MASK)>>>24)/colorModeA,h=colorToHSB(b),b=((b&Constants.ALPHA_MASK)>>>24)/colorModeA,d=lerp(i[0],h[0],c),f=lerp(i[1],h[1],c),i=lerp(i[2],h[2],c),i=color.toRGB(d,f,i),c=lerp(a,b,c)*colorModeA,c<<24&Constants.ALPHA_MASK|i[0]<<16&Constants.RED_MASK|i[1]<<8&Constants.GREEN_MASK|i[2]&Constants.BLUE_MASK;f=(a&Constants.RED_MASK)>>>16;h=(a&Constants.GREEN_MASK)>>>
8;i=a&Constants.BLUE_MASK;a=((a&Constants.ALPHA_MASK)>>>24)/colorModeA;j=(b&Constants.RED_MASK)>>>16;g=(b&Constants.GREEN_MASK)>>>8;d=b&Constants.BLUE_MASK;b=((b&Constants.ALPHA_MASK)>>>24)/colorModeA;f=lerp(f,j,c)|0;h=lerp(h,g,c)|0;i=lerp(i,d,c)|0;c=lerp(a,b,c)*colorModeA;return c<<24&Constants.ALPHA_MASK|f<<16&Constants.RED_MASK|h<<8&Constants.GREEN_MASK|i&Constants.BLUE_MASK},colorMode=function(){curColorMode=arguments[0];1<arguments.length&&(colorModeX=arguments[1],colorModeY=arguments[2]||arguments[1],
colorModeZ=arguments[3]||arguments[1],colorModeA=arguments[4]||arguments[1])},blendColor=function(a,b,c){if(c===Constants.REPLACE)return modes.replace(a,b);if(c===Constants.BLEND)return modes.blend(a,b);if(c===Constants.ADD)return modes.add(a,b);if(c===Constants.SUBTRACT)return modes.subtract(a,b);if(c===Constants.LIGHTEST)return modes.lightest(a,b);if(c===Constants.DARKEST)return modes.darkest(a,b);if(c===Constants.DIFFERENCE)return modes.difference(a,b);if(c===Constants.EXCLUSION)return modes.exclusion(a,
b);if(c===Constants.MULTIPLY)return modes.multiply(a,b);if(c===Constants.SCREEN)return modes.screen(a,b);if(c===Constants.HARD_LIGHT)return modes.hard_light(a,b);if(c===Constants.SOFT_LIGHT)return modes.soft_light(a,b);if(c===Constants.OVERLAY)return modes.overlay(a,b);if(c===Constants.DODGE)return modes.dodge(a,b);if(c===Constants.BURN)return modes.burn(a,b)},currentFillAlpha=1,currentFillColor=16777215,defaultNormalFill=!0,defaultNormalStroke=!0,angleColor=-16777217,fill=function(a,b,c,f){defaultNormalFill=
!1;c=color(a,b,c,f);c===angleColor?(defaultNormalFill=!0,a=c,b=void 0!==b?b/colorModeA:1):(a=color(redF(c),greenF(c),blueF(c)),b=alphaZeroToOne(c));a===currentFillColor&&b===currentFillAlpha&&doFill||(doFill=!0,currentFillColor=a,currentFillAlpha=b)},noFill=function(){defaultNormalFill=doFill=!1},currentStrokeAlpha=1,currentStrokeColor=0,stroke=function(a,b,c,f){defaultNormalStroke=!1;c=color(a,b,c,f);c===angleColor?(defaultNormalStroke=!0,a=c,b=void 0!==b?b/colorModeA:1):(a=color(redF(c),greenF(c),
blueF(c)),b=alphaZeroToOne(c));a===currentStrokeColor&&b===currentStrokeAlpha&&doStroke||(doStroke=!0,currentStrokeColor=a,currentStrokeAlpha=b)},noStroke=function(){doStroke=!1},strokeSize=function(a){void 0===a?a=1:0>a&&(a=0);currentStrokeSize=a},modes=function(){function a(a,b,c,f,h,l,m,n,j,r,p){a=i(((a&4278190080)>>>24)+b,255)<<24;c+=(j-c)*b>>8;f+=(r-f)*b>>8;b=h+((p-h)*b>>8);return a|(0>c?0:255<c?255:c)<<16|(0>f?0:255<f?255:f)<<8|(0>b?0:255<b?255:b)}var b=Constants.ALPHA_MASK,c=Constants.RED_MASK,
f=Constants.GREEN_MASK,h=Constants.BLUE_MASK,i=Math.min,j=Math.max;return{replace:function(a,b){return b},blend:function(a,d){var e=(d&b)>>>24,o=a&c,k=a&f,l=a&h,m=d&c,n=d&f,j=d&h;return i(((a&b)>>>24)+e,255)<<24|o+((m-o)*e>>8)&c|k+((n-k)*e>>8)&f|l+((j-l)*e>>8)&h},add:function(a,d){var e=(d&b)>>>24;return i(((a&b)>>>24)+e,255)<<24|i((a&c)+((d&c)>>8)*e,c)&c|i((a&f)+((d&f)>>8)*e,f)&f|i((a&h)+((d&h)*e>>8),h)},subtract:function(a,d){var e=(d&b)>>>24;return i(((a&b)>>>24)+e,255)<<24|j((a&c)-((d&c)>>8)*
e,f)&c|j((a&f)-((d&f)>>8)*e,h)&f|j((a&h)-((d&h)*e>>8),0)},lightest:function(a,d){var e=(d&b)>>>24;return i(((a&b)>>>24)+e,255)<<24|j(a&c,((d&c)>>8)*e)&c|j(a&f,((d&f)>>8)*e)&f|j(a&h,(d&h)*e>>8)},darkest:function(a,d){var e=(d&b)>>>24,o=a&c,k=a&f,l=a&h,m=i(a&c,((d&c)>>8)*e),n=i(a&f,((d&f)>>8)*e),j=i(a&h,(d&h)*e>>8);return i(((a&b)>>>24)+e,255)<<24|o+((m-o)*e>>8)&c|k+((n-k)*e>>8)&f|l+((j-l)*e>>8)&h},difference:function(g,d){var e=(g&c)>>16,i=(g&f)>>8,k=g&h,l=(d&c)>>16,m=(d&f)>>8,j=d&h;return a(g,(d&
b)>>>24,e,i,k,l,m,j,e>l?e-l:l-e,i>m?i-m:m-i,k>j?k-j:j-k)},exclusion:function(g,d){var e=(g&c)>>16,i=(g&f)>>8,k=g&h,l=(d&c)>>16,m=(d&f)>>8,j=d&h;return a(g,(d&b)>>>24,e,i,k,l,m,j,e+l-(e*l>>7),i+m-(i*m>>7),k+j-(k*j>>7))},multiply:function(g,d){var e=(g&c)>>16,i=(g&f)>>8,k=g&h,l=(d&c)>>16,m=(d&f)>>8,j=d&h;return a(g,(d&b)>>>24,e,i,k,l,m,j,e*l>>8,i*m>>8,k*j>>8)},screen:function(g,d){var e=(g&c)>>16,i=(g&f)>>8,k=g&h,l=(d&c)>>16,m=(d&f)>>8,j=d&h;return a(g,(d&b)>>>24,e,i,k,l,m,j,255-((255-e)*(255-l)>>8),
255-((255-i)*(255-m)>>8),255-((255-k)*(255-j)>>8))},hard_light:function(g,d){var e=(g&c)>>16,i=(g&f)>>8,k=g&h,l=(d&c)>>16,j=(d&f)>>8,n=d&h;return a(g,(d&b)>>>24,e,i,k,l,j,n,128>l?e*l>>7:255-((255-e)*(255-l)>>7),128>j?i*j>>7:255-((255-i)*(255-j)>>7),128>n?k*n>>7:255-((255-k)*(255-n)>>7))},soft_light:function(g,d){var e=(g&c)>>16,i=(g&f)>>8,k=g&h,l=(d&c)>>16,j=(d&f)>>8,n=d&h;return a(g,(d&b)>>>24,e,i,k,l,j,n,(e*l>>7)+(e*e>>8)-(e*e*l>>15),(i*j>>7)+(i*i>>8)-(i*i*j>>15),(k*n>>7)+(k*k>>8)-(k*k*n>>15))},
overlay:function(g,d){var e=(g&c)>>16,i=(g&f)>>8,k=g&h,l=(d&c)>>16,j=(d&f)>>8,n=d&h;return a(g,(d&b)>>>24,e,i,k,l,j,n,128>e?e*l>>7:255-((255-e)*(255-l)>>7),128>i?i*j>>7:255-((255-i)*(255-j)>>7),128>k?k*n>>7:255-((255-k)*(255-n)>>7))},dodge:function(g,d){var e=(d&b)>>>24,i=(g&c)>>16,k=(g&f)>>8,l=g&h,j=(d&c)>>16,n=(d&f)>>8,s=d&h,r=255;255!==j&&(r=(i<<8)/(255-j),r=0>r?0:255<r?255:r);var p=255;255!==n&&(p=(k<<8)/(255-n),p=0>p?0:255<p?255:p);var q=255;255!==s&&(q=(l<<8)/(255-s),q=0>q?0:255<q?255:q);return a(g,
e,i,k,l,j,n,s,r,p,q)},burn:function(g,d){var e=(d&b)>>>24,i=(g&c)>>16,k=(g&f)>>8,j=g&h,m=(d&c)>>16,n=(d&f)>>8,s=d&h,r=0;0!==m&&(r=(255-i<<8)/m,r=255-(0>r?0:255<r?255:r));var p=0;0!==n&&(p=(255-k<<8)/n,p=255-(0>p?0:255<p?255:p));var q=0;0!==s&&(q=(255-j<<8)/s,q=255-(0>q?0:255<q?255:q));return a(g,e,i,k,j,m,n,s,r,p,q)}}}(),frame=0,doLNOnce=[],loopInterval,time,timeAtStart,anyCodeReactingTobpm;
function animate(){useRequestAnimationFrame?-1===wantedFramesPerSecond?requestAnimationFrame(animate):void 0===loopInterval&&(loopInterval=setInterval("window.requestAnimationFrame(animate)",1E3/wantedFramesPerSecond)):setTimeout("animate();",1E3/wantedFramesPerSecond);matrixStack=[];worldMatrix.identity();soundLoops.soundIDs=[];soundLoops.beatStrings=[];if("undefined"!=typeof draw){var a=new Date;0===frame?(timeAtStart=a.getTime(),time=0):time=a.getTime()-timeAtStart;doLNOnce=[];anyCodeReactingTobpm=
!1;fill(4294967295);stroke(4278190080);currentStrokeSize=1;defaultNormalStroke=defaultNormalFill=!0;ballDetLevel=ballDefaultDetLevel;noLights();usedPointLights=usedAmbientLights=usedBoxes=usedRectangles=usedLines=0;updatesPerMinute=240;usedSpheres={};animationStyleValue=normal;resetGradientStack();try{draw()}catch(b){if(autocodeOn){editor.undo();return}checkErrorAndReport(b);consecutiveFramesWithoutRunTimeError=0;out=lastStableProgram;window.eval(lastStableProgram);return}0===frame&&(timeAtStart=
a.getTime(),time=0);anyCodeReactingTobpm&&changeUpdatesPerMinuteIfNeeded();animationStyleUpdateIfChanged();simpleGradientUpdateIfChanged();changeUpdatesPerMinuteIfNeeded();frame++;consecutiveFramesWithoutRunTimeError++;5==consecutiveFramesWithoutRunTimeError&&(lastStableProgram=out)}combDisplayList();render();stats.update();if(0!==doLNOnce.length){a=editor.getValue();frenchVersion&&(a=a.replace(/uneFois/g,"doOnce"));for(var a=a.split("\n"),c=0;c<doLNOnce.length;c++)a[doLNOnce[c]]=a[doLNOnce[c]].replace(/^(\s*)doOnce([ ]*\->[ ]*.+)$/gm,
"$1\u2713doOnce$2"),a[doLNOnce[c]]=a[doLNOnce[c]].replace(/^(\s*)doOnce([ ]*\->[ ]*)$/gm,"$1\u2713doOnce$2");a=a.join("\n");c=editor.getCursor();c.ch+=1;frenchVersion&&(a=a.replace(/doOnce/g,"uneFois"));editor.setValue(a);editor.setCursor(c);registerCode()}}var composer;
function render(){isWebGLUsed?composer.render():(renderer.render(scene,camera),finalRenderWithSceneAndBlendContext.globalAlpha=1,finalRenderWithSceneAndBlendContext.clearRect(0,0,window.innerWidth,window.innerHeight),finalRenderWithSceneAndBlendContext.globalAlpha=blendAmount,finalRenderWithSceneAndBlendContext.drawImage(previousRenderForBlending,0,0),finalRenderWithSceneAndBlendContext.globalAlpha=1,finalRenderWithSceneAndBlendContext.drawImage(sceneRenderingCanvas,0,0),previousRenderForBlendingContext.globalCompositeOperation=
"copy",previousRenderForBlendingContext.drawImage(finalRenderWithSceneAndBlend,0,0),sceneRenderingCanvasContext.clearRect(0,0,window.innerWidth,window.innerHeight))}var dimcodeOn=!1;function triggerReset(){pickRandomDefaultGradient();autocodeOn&&toggleAutocodeAndUpdateButtonAndBlinking();editor.setValue("");$("#resetButtonContainer").css("background-color","#FF0000");setTimeout('$("#resetButtonContainer").css("background-color","");',200)}var changesHappened=!1,cursorActivity=!0;
function selectTheme(a){editor.setOption("theme",a.options[a.selectedIndex].innerHTML)}function adjustCodeMirrorHeight(){$(".CodeMirror-scroll").css("height",window.innerHeight-$("#theMenu").height())}
function fullscreenify(a){function b(a){var b={x:1,y:1};b.x=(window.innerWidth+40)/a.width;b.y=(window.innerHeight+40)/a.height;b=b.x+", "+b.y;a.setAttribute("style",c+" -ms-transform-origin: left top; -webkit-transform-origin: left top; -moz-transform-origin: left top; -o-transform-origin: left top; transform-origin: left top; -ms-transform: scale("+b+"); -webkit-transform: scale3d("+b+", 1); -moz-transform: scale("+b+"); -o-transform: scale("+b+"); transform: scale("+b+");")}var c=a.getAttribute("style")||
"";window.addEventListener("resize",function(){adjustCodeMirrorHeight();b(a)},!1);b(a)}
function combDisplayList(){for(var a=0;a<scene.objects.length;++a){var b=scene.objects[a];b.isLine?0<usedLines?(b.visible=!0,usedLines--):b.visible=!1:b.isRectangle?0<usedRectangles?(b.visible=!0,usedRectangles--):b.visible=!1:b.isBox?0<usedBoxes?(b.visible=!0,usedBoxes--):b.visible=!1:b.isCylinder?0<usedCylinders?(b.visible=!0,usedCylinders--):b.visible=!1:b.isAmbientLight?0<usedAmbientLights?(b.visible=!0,usedAmbientLights--):b.visible=!1:0!==b.isSphere&&(0<usedSpheres[""+b.isSphere]?(b.visible=
!0,usedSpheres[""+b.isSphere]-=1):b.visible=!1)}}function clearDisplayList(){}
var foo=function(a){if(autocodeOn)editor.undo();else return-1<a.indexOf("Uncaught ReferenceError: ")&&(a=a.substring(25)),$("#dangerSignText").css("color","red"),$("#errorMessageText").text(a),consecutiveFramesWithoutRunTimeError=6,window.eval(lastStableProgram),!0},updatesPerMinute=0,oldupdatesPerMinute=0,soundLoopTimer,beatNumber=0,bpm=function(a){void 0!==a&&(125<a&&(a=125),0>a&&(a=0),updatesPerMinute=4*a)},changeUpdatesPerMinuteIfNeeded=function(){oldupdatesPerMinute!==updatesPerMinute&&(clearTimeout(soundLoopTimer),
0!==updatesPerMinute&&(soundLoopTimer=setInterval("soundLoop();",6E4/updatesPerMinute)),oldupdatesPerMinute=updatesPerMinute)},soundLoop=function(){if(!soundSystemIsMangled){beatNumber++;beatNumber%=16;log("about to loop in "+soundLoops.soundIDs+" of length "+soundLoops.soundIDs.length);for(var a=0;a<soundLoops.soundIDs.length;a++){var b=soundLoops.soundIDs[a],c;c=soundLoops.beatStrings[a].charAt(beatNumber);log("checking sound loop "+soundLoops.beatStrings[a]+" beat "+beatNumber+" : "+c);if("x"===
c){c=soundBank[b];var f=c.length,h=void 0;log("playing  "+b+" length: "+f);for(var i=0;i<f;i++){var j=c[i];if(j.isEnded()){h=j;log("sound bank "+i+" is available ");break}else log("sound bank "+i+" has not ended ")}void 0===h&&(log("creating new sound object "),31<totalCreatedSoundObjects&&(soundSystemIsMangled=!0,$("#soundSystemIsMangledMessage").modal(),$("#simplemodal-container").height(250)),h=new buzz.sound(soundFiles[b]),soundBank[b].push(h),totalCreatedSoundObjects++);h.play()}}}},play=function(a,
b){anyCodeReactingTobpm=!0;b=b.replace(/\s*/g,"");soundLoops.soundIDs.push(a);soundLoops.beatStrings.push(b);log("pushing "+a+" beat: "+b)},buzz={defaults:{autoplay:!1,duration:5E3,formats:[],loop:!1,placeholder:"--",preload:"metadata",volume:80},types:{mp3:"audio/mpeg",ogg:"audio/ogg",wav:"audio/wav",aac:"audio/aac",m4a:"audio/x-m4a"},sounds:[],el:document.createElement("audio"),sound:function(a,b){function c(a){for(var b=[],c=a.length-1,d=0;d<=c;d++)b.push({start:a.start(c),end:a.end(c)});return b}
function f(a,b){var c=document.createElement("source");c.src=b;buzz.types[b.split(".").pop()]&&(c.type=buzz.types[b.split(".").pop()]);a.appendChild(c)}var b=b||{},h=0,i=[],j={},g=buzz.isSupported();this.load=function(){if(!g)return this;this.sound.load();return this};this.play=function(){if(!g)return this;this.sound.play();return this};this.togglePlay=function(){if(!g)return this;this.sound.paused?this.sound.play():this.sound.pause();return this};this.pause=function(){if(!g)return this;this.sound.pause();
return this};this.isPaused=function(){return!g?null:this.sound.paused};this.stop=function(){if(!g)return this;this.setTime(0);this.sound.pause();return this};this.isEnded=function(){return!g?null:this.sound.ended};this.loop=function(){if(!g)return this;this.sound.loop="loop";this.bind("ended.buzzloop",function(){this.currentTime=0;this.play()});return this};this.unloop=function(){if(!g)return this;this.sound.removeAttribute("loop");this.unbind("ended.buzzloop");return this};this.mute=function(){if(!g)return this;
this.sound.muted=!0;return this};this.unmute=function(){if(!g)return this;this.sound.muted=!1;return this};this.toggleMute=function(){if(!g)return this;this.sound.muted=!this.sound.muted;return this};this.isMuted=function(){return!g?null:this.sound.muted};this.setVolume=function(a){if(!g)return this;0>a&&(a=0);100<a&&(a=100);this.volume=a;this.sound.volume=a/100;return this};this.getVolume=function(){return!g?this:this.volume};this.increaseVolume=function(a){return this.setVolume(this.volume+(a||
1))};this.decreaseVolume=function(a){return this.setVolume(this.volume-(a||1))};this.setTime=function(a){if(!g)return this;this.whenReady(function(){this.sound.currentTime=a});return this};this.getTime=function(){if(!g)return null;var a=Math.round(100*this.sound.currentTime)/100;return isNaN(a)?buzz.defaults.placeholder:a};this.setPercent=function(a){return!g?this:this.setTime(buzz.fromPercent(a,this.sound.duration))};this.getPercent=function(){if(!g)return null;var a=Math.round(buzz.toPercent(this.sound.currentTime,
this.sound.duration));return isNaN(a)?buzz.defaults.placeholder:a};this.setSpeed=function(a){if(!g)return this;this.sound.playbackRate=a};this.getSpeed=function(){return!g?null:this.sound.playbackRate};this.getDuration=function(){if(!g)return null;var a=Math.round(100*this.sound.duration)/100;return isNaN(a)?buzz.defaults.placeholder:a};this.getPlayed=function(){return!g?null:c(this.sound.played)};this.getBuffered=function(){return!g?null:c(this.sound.buffered)};this.getSeekable=function(){return!g?
null:c(this.sound.seekable)};this.getErrorCode=function(){return g&&this.sound.error?this.sound.error.code:0};this.getErrorMessage=function(){if(!g)return null;switch(this.getErrorCode()){case 1:return"MEDIA_ERR_ABORTED";case 2:return"MEDIA_ERR_NETWORK";case 3:return"MEDIA_ERR_DECODE";case 4:return"MEDIA_ERR_SRC_NOT_SUPPORTED";default:return null}};this.getStateCode=function(){return!g?null:this.sound.readyState};this.getStateMessage=function(){if(!g)return null;switch(this.getStateCode()){case 0:return"HAVE_NOTHING";
case 1:return"HAVE_METADATA";case 2:return"HAVE_CURRENT_DATA";case 3:return"HAVE_FUTURE_DATA";case 4:return"HAVE_ENOUGH_DATA";default:return null}};this.getNetworkStateCode=function(){return!g?null:this.sound.networkState};this.getNetworkStateMessage=function(){if(!g)return null;switch(this.getNetworkStateCode()){case 0:return"NETWORK_EMPTY";case 1:return"NETWORK_IDLE";case 2:return"NETWORK_LOADING";case 3:return"NETWORK_NO_SOURCE";default:return null}};this.set=function(a,b){if(!g)return this;this.sound[a]=
b;return this};this.get=function(a){return!g?null:a?this.sound[a]:this.sound};this.bind=function(a,b){if(!g)return this;for(var a=a.split(" "),c=this,d=function(a){b.call(c,a)},e=0;e<a.length;e++){var f=a[e],h=f,f=h.split(".")[0];i.push({idx:h,func:d});this.sound.addEventListener(f,d,!0)}return this};this.unbind=function(a){if(!g)return this;for(var a=a.split(" "),b=0;b<a.length;b++)for(var c=a[b],d=c.split(".")[0],e=0;e<i.length;e++){var f=i[e].idx.split(".");if(i[e].idx==c||f[1]&&f[1]==c.replace(".",
""))this.sound.removeEventListener(d,i[e].func,!0),i.splice(e,1)}return this};this.bindOnce=function(a,b){if(!g)return this;var c=this;j[h++]=!1;this.bind(a+"."+h,function(){j[h]||(j[h]=!0,b.call(c));c.unbind(a+"."+h)})};this.trigger=function(a){if(!g)return this;for(var a=a.split(" "),b=0;b<a.length;b++)for(var c=a[b],d=0;d<i.length;d++){var e=i[d].idx.split(".");if(i[d].idx==c||e[0]&&e[0]==c.replace(".","")){var f=document.createEvent("HTMLEvents");f.initEvent(e[0],!1,!0);this.sound.dispatchEvent(f)}}return this};
this.fadeTo=function(a,b,c){function d(){setTimeout(function(){e<a&&h.volume<a?(h.setVolume(h.volume+=1),d()):e>a&&h.volume>a?(h.setVolume(h.volume-=1),d()):c instanceof Function&&c.apply(h)},f)}if(!g)return this;b instanceof Function?(c=b,b=buzz.defaults.duration):b=b||buzz.defaults.duration;var e=this.volume,f=b/Math.abs(e-a),h=this;this.play();this.whenReady(function(){d()});return this};this.fadeIn=function(a,b){return!g?this:this.setVolume(0).fadeTo(100,a,b)};this.fadeOut=function(a,b){return!g?
this:this.fadeTo(0,a,b)};this.fadeWith=function(a,b){if(!g)return this;this.fadeOut(b,function(){this.stop()});a.play().fadeIn(b);return this};this.whenReady=function(a){if(!g)return null;var b=this;0===this.sound.readyState?this.bind("canplay.buzzwhenready",function(){a.call(b)}):a.call(b)};if(g&&a){for(var d in buzz.defaults)buzz.defaults.hasOwnProperty(d)&&(b[d]=b[d]||buzz.defaults[d]);this.sound=document.createElement("audio");if(a instanceof Array)for(var e in a)a.hasOwnProperty(e)&&f(this.sound,
a[e]);else if(b.formats.length)for(var o in b.formats)b.formats.hasOwnProperty(o)&&f(this.sound,a+"."+b.formats[o]);else f(this.sound,a);b.loop&&this.loop();b.autoplay&&(this.sound.autoplay="autoplay");this.sound.preload=!0===b.preload?"auto":!1===b.preload?"none":b.preload;this.setVolume(b.volume);buzz.sounds.push(this)}},group:function(a){function b(){for(var b=c(null,arguments),h=b.shift(),i=0;i<a.length;i++)a[i][h].apply(a[i],b)}function c(a,b){return a instanceof Array?a:Array.prototype.slice.call(b)}
a=c(a,arguments);this.getSounds=function(){return a};this.add=function(b){for(var b=c(b,arguments),h=0;h<b.length;h++)a.push(b[h])};this.remove=function(b){for(var b=c(b,arguments),h=0;h<b.length;h++)for(var i=0;i<a.length;i++)if(a[i]==b[h]){a.splice(i,1);break}};this.load=function(){b("load");return this};this.play=function(){b("play");return this};this.togglePlay=function(){b("togglePlay");return this};this.pause=function(a){b("pause",a);return this};this.stop=function(){b("stop");return this};
this.mute=function(){b("mute");return this};this.unmute=function(){b("unmute");return this};this.toggleMute=function(){b("toggleMute");return this};this.setVolume=function(a){b("setVolume",a);return this};this.increaseVolume=function(a){b("increaseVolume",a);return this};this.decreaseVolume=function(a){b("decreaseVolume",a);return this};this.loop=function(){b("loop");return this};this.unloop=function(){b("unloop");return this};this.setTime=function(a){b("setTime",a);return this};this.set=function(a,
c){b("set",a,c);return this};this.bind=function(a,c){b("bind",a,c);return this};this.unbind=function(a){b("unbind",a);return this};this.bindOnce=function(a,c){b("bindOnce",a,c);return this};this.trigger=function(a){b("trigger",a);return this};this.fade=function(a,c,i,j){b("fade",a,c,i,j);return this};this.fadeIn=function(a,c){b("fadeIn",a,c);return this};this.fadeOut=function(a,c){b("fadeOut",a,c);return this}},all:function(){return new buzz.group(buzz.sounds)},isSupported:function(){return!!buzz.el.canPlayType},
isOGGSupported:function(){return!!buzz.el.canPlayType&&buzz.el.canPlayType('audio/ogg; codecs="vorbis"')},isWAVSupported:function(){return!!buzz.el.canPlayType&&buzz.el.canPlayType('audio/wav; codecs="1"')},isMP3Supported:function(){return!!buzz.el.canPlayType&&buzz.el.canPlayType("audio/mpeg;")},isAACSupported:function(){return!!buzz.el.canPlayType&&(buzz.el.canPlayType("audio/x-m4a;")||buzz.el.canPlayType("audio/aac;"))},toTimer:function(a,b){var c,f,h;c=Math.floor(a/3600);c=isNaN(c)?"--":10<=c?
c:"0"+c;f=b?Math.floor(a/60%60):Math.floor(a/60);f=isNaN(f)?"--":10<=f?f:"0"+f;h=Math.floor(a%60);h=isNaN(h)?"--":10<=h?h:"0"+h;return b?c+":"+f+":"+h:f+":"+h},fromTimer:function(a){var b=a.toString().split(":");b&&3==b.length&&(a=3600*parseInt(b[0],10)+60*parseInt(b[1],10)+parseInt(b[2],10));b&&2==b.length&&(a=60*parseInt(b[0],10)+parseInt(b[1],10));return a},toPercent:function(a,b,c){c=Math.pow(10,c||0);return Math.round(100*a/b*c)/c},fromPercent:function(a,b,c){c=Math.pow(10,c||0);return Math.round(b/
100*a*c)/c}},totalCreatedSoundObjects=0,soundSystemIsMangled=!1,CHANNELSPERSOUND=6,soundDef=[],soundDefCounter=0;soundDef[soundDefCounter++]={soundName:"bing",soundFile:"./sound/audioFiles/start_bing"};soundDef[soundDefCounter++]={soundName:"toc",soundFile:"./sound/audioFiles/AMB_BD_1"};soundDef[soundDefCounter++]={soundName:"highHatClosed",soundFile:"./sound/audioFiles/AMB_HHCL"};soundDef[soundDefCounter++]={soundName:"highHatOpen",soundFile:"./sound/audioFiles/AMB_HHOP"};
soundDef[soundDefCounter++]={soundName:"toc2",soundFile:"./sound/audioFiles/AMB_HTM"};soundDef[soundDefCounter++]={soundName:"toc3",soundFile:"./sound/audioFiles/AMB_LTM2"};soundDef[soundDefCounter++]={soundName:"toc4",soundFile:"./sound/audioFiles/AMB_RIM1"};soundDef[soundDefCounter++]={soundName:"snare",soundFile:"./sound/audioFiles/AMB_SN13"};soundDef[soundDefCounter++]={soundName:"snare2",soundFile:"./sound/audioFiles/AMB_SN_5"};soundDef[soundDefCounter++]={soundName:"china",soundFile:"./sound/audioFiles/CHINA_1"};
soundDef[soundDefCounter++]={soundName:"crash",soundFile:"./sound/audioFiles/CRASH_1"};soundDef[soundDefCounter++]={soundName:"crash2",soundFile:"./sound/audioFiles/CRASH_5"};soundDef[soundDefCounter++]={soundName:"crash3",soundFile:"./sound/audioFiles/CRASH_6"};soundDef[soundDefCounter++]={soundName:"ride",soundFile:"./sound/audioFiles/RIDE_1"};soundDef[soundDefCounter++]={soundName:"glass",soundFile:"./sound/audioFiles/glass2"};soundDef[soundDefCounter++]={soundName:"glass1",soundFile:"./sound/audioFiles/glass3"};
soundDef[soundDefCounter++]={soundName:"glass2",soundFile:"./sound/audioFiles/glass4"};soundDef[soundDefCounter++]={soundName:"glass3",soundFile:"./sound/audioFiles/glass5"};soundDef[soundDefCounter++]={soundName:"thump",soundFile:"./sound/audioFiles/8938__patchen__piano-hits-hand-03v2"};soundDef[soundDefCounter++]={soundName:"lowFlash",soundFile:"./sound/audioFiles/9569__thanvannispen__industrial-low-flash04"};soundDef[soundDefCounter++]={soundName:"lowFlash2",soundFile:"./sound/audioFiles/9570__thanvannispen__industrial-low-flash07"};
soundDef[soundDefCounter++]={soundName:"tranceKick2",soundFile:"./sound/audioFiles/24004__laya__dance-kick3"};soundDef[soundDefCounter++]={soundName:"tranceKick",soundFile:"./sound/audioFiles/33325__laya__trance-kick01"};soundDef[soundDefCounter++]={soundName:"wosh",soundFile:"./sound/audioFiles/33960__krlox__pudricion-4"};soundDef[soundDefCounter++]={soundName:"voltage",soundFile:"./sound/audioFiles/49255__keinzweiter__bonobob-funk"};soundDef[soundDefCounter++]={soundName:"beepA",soundFile:"./sound/audioFiles/100708__steveygos93__bleep_a"};
soundDef[soundDefCounter++]={soundName:"beepB",soundFile:"./sound/audioFiles/100708__steveygos93__bleep_b"};soundDef[soundDefCounter++]={soundName:"beepC",soundFile:"./sound/audioFiles/100708__steveygos93__bleep_c"};soundDef[soundDefCounter++]={soundName:"beepD",soundFile:"./sound/audioFiles/100708__steveygos93__bleep_d"};soundDef[soundDefCounter++]={soundName:"beep",soundFile:"./sound/audioFiles/116508_Beep"};soundDef[soundDefCounter++]={soundName:"hello",soundFile:"./sound/audioFiles/116508_Hello"};
soundDef[soundDefCounter++]={soundName:"alienBeep",soundFile:"./sound/audioFiles/132389__blackie666__alienbleep"};
var numberOfSounds=soundDefCounter,soundBank={},soundFiles={},endedFirstPlay=0,startingSound,closeAndCheckAudio=function(){$.modal.close();setTimeout("checkAudio();",500)},checkAudio=function(){buzz.isSupported()||($("#noAudioMessage").modal(),$("#simplemodal-container").height(200))},loadAndTestAllTheSounds=function(){log("loading and testing all sounds");for(var a=0;a<numberOfSounds;a++){if(buzz.isMP3Supported())soundDef[a].soundFile+=".mp3";else if(buzz.isOGGSupported())soundDef[a].soundFile+=
".ogg";else break;soundBank[soundDef[a].soundName]=[];soundFiles[soundDef[a].soundName]=soundDef[a].soundFile;if(-1===navigator.userAgent.toLowerCase().indexOf("chrome")&&!/MSIE (\d+\.\d+);/.test(navigator.userAgent))for(var b=0;b<CHANNELSPERSOUND;b++)setTimeout("checkSound("+a+");",200*a)}(-1<navigator.userAgent.toLowerCase().indexOf("chrome")||/MSIE (\d+\.\d+);/.test(navigator.userAgent))&&startEnvironment()},checkSound=function(a){var b=new buzz.sound(soundDef[a].soundFile);log("loading sound "+
soundDef[a].soundFile);b.mute();b.load();b.bind("ended",function(){this.unbind("ended");this.unmute();endedFirstPlay++;0===endedFirstPlay%10&&$("#loading").append("/");log("tested "+endedFirstPlay+" sounds");endedFirstPlay===numberOfSounds*CHANNELSPERSOUND&&(log("tested all sounds"),startEnvironment())});b.play();soundBank[soundDef[a].soundName].push(b)},editor,startEnvironment=function(){pickRandomDefaultGradient();log("startEnvironment");initThreeJs()||animate();if(!Detector.webgl||forceCanvasRenderer)$("#noWebGLMessage").modal({onClose:closeAndCheckAudio}),
$("#simplemodal-container").height(200);var a=document.getElementById("backGroundCanvas");fullScreenifyBackground&&fullscreenify(a);resetGradientStack();simpleGradientUpdateIfChanged();frenchVersion&&($("#demoMenu").text("D\u00e9mos"),$("#tutorialsMenu").text("Tutoriaux"),$("#resetButton").text("Effacer"),$("#autocodeIndicator").text("Autocode: inactif"),$("#simpleCubeDemo").text("Cube simple"),$("#webgltwocubesDemo").text("WebGL: Deux cubes"),$("#cubesAndSpikes").text("Cubes et piques"),$("#webglturbineDemo").text("WebGL: Turbine"),
$("#webglzfightartDemo").text("WebGL: Z-fight art!"),$("#littleSpiralOfCubes").text("Petite spirale"),$("#tentacleDemo").text("Tentacule"),$("#lampDemo").text("Lampe"),$("#trillionfeathersDemo").text("Mille milliards de plumes"),$("#monsterblobDemo").text("Monstre blob"),$("#industrialMusicDemo").text("Son: Industriel"),$("#trySoundsDemo").text("Son: Essayez les tous"),$("#springysquaresDemo").text("Carr\u00e9s rebondissants"),$("#diceDemo").text("D\u00e9"),$("#webglalmostvoronoiDemo").text("WebGL: Presque Voronoi"),
$("#webglshardsDemo").text("WebGL: \u00c9chardes"),$("#webglredthreadsDemo").text("WebGL: Fils rouges"),$("#webglnuclearOctopusDemo").text("WebGL: Pieuvre nucl\u00e9aire"),$("#introTutorial").text("intro"),$("#helloworldTutorial").text("hello world"),$("#somenotesTutorial").text("quelques notes"),$("#rotateTutorial").text("tourne"),$("#frameTutorial").text("image"),$("#timeTutorial").text("temps"),$("#moveTutorial").text("d\u00e9place"),$("#scaleTutorial").text("taille"),$("#timesTutorial").text("fois"),
$("#fillTutorial").text("remplissage"),$("#strokeTutorial").text("trait"),$("#colornamesTutorial").text("les couleurs par leur nom"),$("#lightsTutorial").text("\u00e9clairages"),$("#backgroundTutorial").text("fond"),$("#gradientTutorial").text("degradeSimple"),$("#lineTutorial").text("ligne"),$("#ballTutorial").text("balle"),$("#pushpopMatrixTutorial").text("matrice"),$("#animationstyleTutorial").text("styleAnimation"),$("#doonceTutorial").text("uneFois"),$("#autocodeTutorial").text("autocode"));
$("#startingCourtainScreen").fadeOut();$("#formCode").css("opacity",0);editor=CodeMirror.fromTextArea(document.getElementById("code"),{lineNumbers:!1,indentWithTabs:!0,tabSize:1,indentUnit:1,lineWrapping:!0,onBlur:function(){setTimeout("editor.focus()",30)},onChange:function(){registerCode()},mode:"livecodelab",onCursorActivity:function(){suspendDimmingAndCheckIfLink()}});editor.setOption("theme","night");editor.focus();adjustCodeMirrorHeight();-1!==window.location.hash.indexOf("bookmark")?(a=window.location.hash.substring(10),
loadDemoOrTutorial(a)):(startingSound=new buzz.sound("./sound/audioFiles/start_bing",{formats:["ogg","mp3"]}),setTimeout("startingSound.play();",650));fakeCursorInterval=setInterval("fakeCursorBlinking()",800);dimcodeOn=!1;toggleDimCode()};$(document).ready(function(){log("document ready");isCanvasSupported?loadAndTestAllTheSounds():($("#noCanvasMessage").modal({onClose:function(){$("#loading").text("sorry :-(");$.modal.close()}}),$("#simplemodal-container").height(200))});var parentObject,rootObject;
rootObject=parentObject=0;var currentObject,matrixStack=[],pushMatrix=function(){matrixStack.push(worldMatrix);worldMatrix=(new THREE.Matrix4).copy(worldMatrix)},popMatrix=function(){0!==matrixStack.length?worldMatrix=matrixStack.pop():worldMatrix.identity()},resetMatrix=function(){worldMatrix.identity()},move=function(a,b,c){0===arguments.length?(a=Math.sin(time/500),b=Math.cos(time/500),c=a):1==arguments.length?c=b=a:2==arguments.length&&(c=0);worldMatrix.translate(new THREE.Vector3(a,b,c))};
function rotate(a,b,c){0===arguments.length?c=b=a=time/1E3:1==arguments.length?c=b=a:2==arguments.length&&(c=0);worldMatrix.rotateX(a).rotateY(b).rotateZ(c)}
var scale=function(a,b,c){0===arguments.length?c=b=a=1+Math.sin(time/500)/4:1==arguments.length?c=b=a:2==arguments.length&&(c=1);-1.0E-9<a&&1.0E-9>a&&(a=1.0E-9);-1.0E-9<b&&1.0E-9>b&&(b=1.0E-9);-1.0E-9<c&&1.0E-9>c&&(c=1.0E-9);worldMatrix.scale(new THREE.Vector3(a,b,c))},gradStack=[],defaultGradientColor1=orange,defaultGradientColor2=red,defaultGradientColor3=black,whichDefaultBackground,pickRandomDefaultGradient=function(){whichDefaultBackground=void 0===whichDefaultBackground?Math.floor(5*Math.random()):
(whichDefaultBackground+1)%5;0===whichDefaultBackground?(defaultGradientColor1=orange,defaultGradientColor2=red,defaultGradientColor3=black,$("#fakeStartingBlinkingCursor").css("color","white")):1===whichDefaultBackground?(defaultGradientColor1=white,defaultGradientColor2=khaki,defaultGradientColor3=peachpuff,$("#fakeStartingBlinkingCursor").css("color","LightPink")):2===whichDefaultBackground?(defaultGradientColor1=lightsteelblue,defaultGradientColor2=lightcyan,defaultGradientColor3=paleturquoise,
$("#fakeStartingBlinkingCursor").css("color","CadetBlue")):3===whichDefaultBackground?(defaultGradientColor1=silver,defaultGradientColor2=lightgrey,defaultGradientColor3=gainsboro,$("#fakeStartingBlinkingCursor").css("color","white")):4===whichDefaultBackground&&(defaultGradientColor1=color(155,255,155),defaultGradientColor2=color(155,255,155),defaultGradientColor3=color(155,255,155),$("#fakeStartingBlinkingCursor").css("color","DarkOliveGreen"))},resetGradientStack=function(){currentGradientStackValue=
"";gradStack=[];simpleGradient(defaultGradientColor1,defaultGradientColor2,defaultGradientColor3)},background=function(a,b,c,f){a=color(a,b,c,f);currentGradientStackValue=currentGradientStackValue+" null null null null "+a+" ";gradStack.push({gradStacka:void 0,gradStackb:void 0,gradStackc:void 0,gradStackd:void 0,solid:a})},simpleGradient=function(a,b,c,f){currentGradientStackValue=currentGradientStackValue+" "+a+""+b+""+c+""+f+"null ";gradStack.push({gradStacka:a,gradStackb:b,gradStackc:c,gradStackd:f,
solid:null})},simpleGradientUpdateIfChanged=function(){if(currentGradientStackValue!==previousGradientStackValue){previousGradientStackValue=currentGradientStackValue;log("repainting background");Math.sqrt(Math.pow(scaledBackgroundWidth/2,2)+Math.pow(scaledBackgroundHeight/2,2));for(var a,b=0;b<gradStack.length;b++)void 0!==gradStack[b].gradStacka?(a=backgroundSceneContext.createLinearGradient(scaledBackgroundWidth/2,0,scaledBackgroundWidth/2,scaledBackgroundHeight),a.addColorStop(0,color.toString(gradStack[b].gradStacka)),
a.addColorStop(0.5,color.toString(gradStack[b].gradStackb)),a.addColorStop(1,color.toString(gradStack[b].gradStackc)),backgroundSceneContext.globalAlpha=1,backgroundSceneContext.fillStyle=a):(log("solid background: "+gradStack[b].solid),backgroundSceneContext.globalAlpha=1,backgroundSceneContext.fillStyle=color.toString(gradStack[b].solid)),backgroundSceneContext.fillRect(0,0,scaledBackgroundWidth,scaledBackgroundHeight)}},line=function(a){if(doStroke){void 0===a&&(a=1);var b=linesPool[usedLines];
void 0===b?(b=new THREE.LineBasicMaterial({opacity:currentStrokeAlpha,linewidth:currentStrokeSize}),b=new THREE.Line(lineGeometry,b),b.isLine=!0,b.isRectangle=!1,b.isBox=!1,b.isCylinder=!1,b.isAmbientLight=!1,b.isPointLight=!1,b.isSphere=0,linesPool.push(b),scene.add(b)):(b.material.opacity=currentStrokeAlpha,b.material.linewidth=currentStrokeSize);usedLines++;b.matrixAutoUpdate=!1;b.matrix.copy(worldMatrix);b.matrixWorldNeedsUpdate=!0;1!==a&&b.matrix.scale(new THREE.Vector3(1,a,1));currentStrokeColor===
angleColor||defaultNormalStroke?(a=b.matrix.multiplyVector3(new THREE.Vector3(0,1,0)).normalize(),log(a.x+" "+a.y+" "+a.z),b.material.color.setHex(color(255*((a.x+1)/2),255*((a.y+1)/2),255*((a.z+1)/2)))):b.material.color.setHex(currentStrokeColor)}},rect=function(a,b){var c=0,f=0;if(doFill||doStroke){doFill&&(0===currentStrokeSize||!doStroke||1>=currentStrokeSize&&!defaultNormalFill&&!defaultNormalStroke&&currentStrokeColor===currentFillColor&&1===currentFillAlpha&&1===currentStrokeAlpha)||1>=currentStrokeSize&&
defaultNormalFill&&defaultNormalStroke?(c=0,f=1):(c=!doFill&&doStroke?1:0,f=2);void 0===a?b=a=1:1===arguments.length&&(b=a);for(var h=!1,i,j=!1,g=c;g<f;g++){1===g?(h=!0,c=currentStrokeColor,i=currentStrokeAlpha):(c=currentFillColor,i=currentFillAlpha);var d=rectanglesPool[usedRectangles];void 0===d&&(d={basicMaterial:void 0,lambertMaterial:void 0,normalMaterial:void 0,neverUsed:!0,mesh:void 0},j=!0,rectanglesPool.push(d));var e=!1,e=h?defaultNormalStroke?!0:!1:defaultNormalFill?!0:!1;log("rect: default normal color: "+
e);log("rect: alphaToBeUsed: "+i);d.neverUsed||c===angleColor||e?(d.neverUsed=!1,void 0===d.normalMaterial?(log("creating normal material"),d.normalMaterial=new THREE.MeshNormalMaterial({opacity:i,wireframe:h,wireframeLinewidth:currentStrokeSize})):(d.normalMaterial.opacity=i,d.normalMaterial.wireframe=h,d.normalMaterial.doubleSided=!0,d.normalMaterial.wireframeLinewidth=currentStrokeSize),void 0===d.mesh)?(d.mesh=new THREE.Mesh(planeGeometry,d.normalMaterial),d.startCountdown=SPINFRAMES):d.mesh.material=
d.normalMaterial:lightsAreOn?(log("rect: lights are on"),void 0===d.lambertMaterial?(log("creating lambert:"+currentFillColor+" "+currentFillAlpha+" "+ambientColor+" "+reflectValue+" "+refractValue),d.lambertMaterial=new THREE.MeshLambertMaterial({color:c,opacity:i,ambient:ambientColor,reflectivity:reflectValue,refractionRatio:refractValue,wireframe:h,wireframeLinewidth:currentStrokeSize})):(d.lambertMaterial.color.setHex(c),d.lambertMaterial.opacity=i,d.lambertMaterial.wireframe=h,d.lambertMaterial.wireframeLinewidth=
currentStrokeSize,d.lambertMaterial.doubleSided=!0,d.lambertMaterial.ambient.setHex(ambientColor),d.lambertMaterial.reflectivity=reflectValue,d.lambertMaterial.refractionRatio=refractValue),void 0===d.mesh)?(d.mesh=new THREE.Mesh(planeGeometry,d.lambertMaterial),d.startCountdown=SPINFRAMES):d.mesh.material=d.lambertMaterial:(log("rect: lights are not on"),void 0===d.basicMaterial?d.basicMaterial=new THREE.MeshBasicMaterial({color:c,opacity:i,wireframe:h,wireframeLinewidth:currentStrokeSize}):(d.basicMaterial.color.setHex(c),
d.basicMaterial.opacity=i,d.basicMaterial.wireframe=h,d.basicMaterial.doubleSided=!0,d.basicMaterial.wireframeLinewidth=currentStrokeSize),void 0===d.mesh)?(d.mesh=new THREE.Mesh(planeGeometry,d.basicMaterial),d.startCountdown=SPINFRAMES):d.mesh.material=d.basicMaterial;resetTheSpinThingy&&(d.startCountdown=SPINFRAMES,resetTheSpinThingy=!1,doTheSpinThingy=!0);doTheSpinThingy&&d.startCountdown--; -1===d.startCountdown&&(doTheSpinThingy=!1);d.mesh.isLine=!1;d.mesh.isRectangle=!0;d.mesh.isBox=!1;d.mesh.isCylinder=
!1;d.mesh.isAmbientLight=!1;d.mesh.isPointLight=!1;d.mesh.isSphere=0;d.mesh.doubleSided=!0;usedRectangles++;doTheSpinThingy&&0<d.startCountdown&&(pushMatrix(),rotate(d.startCountdown/50),log(""+d.startCountdown));d.mesh.matrixAutoUpdate=!1;d.mesh.matrix.copy(worldMatrix);d.mesh.matrixWorldNeedsUpdate=!0;doTheSpinThingy&&0<d.startCountdown&&popMatrix();(1!==a||1!==b)&&d.mesh.matrix.scale(new THREE.Vector3(a,b,1));j&&scene.add(d.mesh)}}},box=function(a,b,c){var f=0,h=0;if(doFill||doStroke){doFill&&
(0===currentStrokeSize||!doStroke||1>=currentStrokeSize&&!defaultNormalFill&&!defaultNormalStroke&&currentStrokeColor===currentFillColor&&1===currentFillAlpha&&1===currentStrokeAlpha)||1>=currentStrokeSize&&defaultNormalFill&&defaultNormalStroke?(f=0,h=1):(f=!doFill&&doStroke?1:0,h=2);void 0===a?c=b=a=1:1===arguments.length&&(c=b=a);for(var i=!1,j,g=!1,d=f;d<h;d++){1===d?(i=!0,f=currentStrokeColor,j=currentStrokeAlpha):(f=currentFillColor,j=currentFillAlpha);var e=boxesPool[usedBoxes];void 0===e&&
(e={basicMaterial:void 0,lambertMaterial:void 0,normalMaterial:void 0,neverUsed:!0,mesh:void 0},g=!0,boxesPool.push(e));var o=!1,o=i?defaultNormalStroke?!0:!1:defaultNormalFill?!0:!1;e.neverUsed||f===angleColor||o?(e.neverUsed=!1,void 0===e.normalMaterial?(log("creating normal material"),e.normalMaterial=new THREE.MeshNormalMaterial({opacity:j,wireframe:i,wireframeLinewidth:currentStrokeSize})):(e.normalMaterial.opacity=j,e.normalMaterial.wireframe=i,e.normalMaterial.wireframeLinewidth=currentStrokeSize,
e.normalMaterial.doubleSided=!1),void 0===e.mesh)?(e.mesh=new THREE.Mesh(cubeGeometry,e.normalMaterial),e.startCountdown=SPINFRAMES):e.mesh.material=e.normalMaterial:lightsAreOn?(void 0===e.lambertMaterial?(log("creating lambert:"+currentFillColor+" "+currentFillAlpha+" "+ambientColor+" "+reflectValue+" "+refractValue),e.lambertMaterial=new THREE.MeshLambertMaterial({color:f,opacity:j,ambient:ambientColor,reflectivity:reflectValue,refractionRatio:refractValue,wireframe:i,wireframeLinewidth:currentStrokeSize})):
(e.lambertMaterial.color.setHex(f),e.lambertMaterial.opacity=j,e.lambertMaterial.wireframe=i,e.lambertMaterial.wireframeLinewidth=currentStrokeSize,e.lambertMaterial.doubleSided=!1,e.lambertMaterial.ambient.setHex(ambientColor),e.lambertMaterial.reflectivity=reflectValue,e.lambertMaterial.refractionRatio=refractValue),void 0===e.mesh)?(e.mesh=new THREE.Mesh(cubeGeometry,e.lambertMaterial),e.startCountdown=SPINFRAMES):e.mesh.material=e.lambertMaterial:(void 0===e.basicMaterial?e.basicMaterial=new THREE.MeshBasicMaterial({color:f,
opacity:j,wireframe:i,wireframeLinewidth:currentStrokeSize}):(e.basicMaterial.color.setHex(f),e.basicMaterial.opacity=j,e.basicMaterial.wireframe=i,e.basicMaterial.wireframeLinewidth=currentStrokeSize,e.basicMaterial.doubleSided=!1),void 0===e.mesh)?(e.mesh=new THREE.Mesh(cubeGeometry,e.basicMaterial),e.startCountdown=SPINFRAMES):e.mesh.material=e.basicMaterial;resetTheSpinThingy&&(e.startCountdown=SPINFRAMES,resetTheSpinThingy=!1,doTheSpinThingy=!0);doTheSpinThingy&&e.startCountdown--; -1===e.startCountdown&&
(doTheSpinThingy=!1);e.mesh.isLine=!1;e.mesh.isRectangle=!1;e.mesh.isBox=!0;e.mesh.isCylinder=!1;e.mesh.isAmbientLight=!1;e.mesh.isPointLight=!1;e.mesh.isSphere=0;e.mesh.doubleSided=!1;usedBoxes++;doTheSpinThingy&&0<e.startCountdown&&(pushMatrix(),rotate(e.startCountdown/50),log(""+e.startCountdown));e.mesh.matrixAutoUpdate=!1;e.mesh.matrix.copy(worldMatrix);e.mesh.matrixWorldNeedsUpdate=!0;doTheSpinThingy&&0<e.startCountdown&&popMatrix();if(1!==a||1!==b||1!==c)i?e.mesh.matrix.scale(new THREE.Vector3(a+
0.0010,b+0.0010,c+0.0010)):e.mesh.matrix.scale(new THREE.Vector3(a,b,c));g&&scene.add(e.mesh)}}},peg=function(a,b,c){var f=0,h=0;if(doFill||doStroke){doFill&&(0===currentStrokeSize||!doStroke||1>=currentStrokeSize&&!defaultNormalFill&&!defaultNormalStroke&&currentStrokeColor===currentFillColor&&1===currentFillAlpha&&1===currentStrokeAlpha)||1>=currentStrokeSize&&defaultNormalFill&&defaultNormalStroke?(f=0,h=1):(f=!doFill&&doStroke?1:0,h=2);void 0===a?c=b=a=1:1===arguments.length&&(c=b=a);for(var i=
!1,j,g=!1,d=f;d<h;d++){1===d?(i=!0,f=currentStrokeColor,j=currentStrokeAlpha):(f=currentFillColor,j=currentFillAlpha);var e=cylindersPool[usedCylinders];void 0===e&&(e={basicMaterial:void 0,lambertMaterial:void 0,normalMaterial:void 0,neverUsed:!0,mesh:void 0},g=!0,cylindersPool.push(e));var o=!1,o=i?defaultNormalStroke?!0:!1:defaultNormalFill?!0:!1;e.neverUsed||f===angleColor||o?(e.neverUsed=!1,void 0===e.normalMaterial?(log("creating normal material"),e.normalMaterial=new THREE.MeshNormalMaterial({opacity:j,
wireframe:i,wireframeLinewidth:currentStrokeSize})):(e.normalMaterial.opacity=j,e.normalMaterial.wireframe=i,e.normalMaterial.wireframeLinewidth=currentStrokeSize,e.normalMaterial.doubleSided=!1),void 0===e.mesh)?(e.mesh=new THREE.Mesh(cylinderGeometry,e.normalMaterial),e.startCountdown=SPINFRAMES):e.mesh.material=e.normalMaterial:lightsAreOn?(void 0===e.lambertMaterial?(log("creating lambert:"+currentFillColor+" "+currentFillAlpha+" "+ambientColor+" "+reflectValue+" "+refractValue),e.lambertMaterial=
new THREE.MeshLambertMaterial({color:f,opacity:j,ambient:ambientColor,reflectivity:reflectValue,refractionRatio:refractValue,wireframe:i,wireframeLinewidth:currentStrokeSize})):(e.lambertMaterial.color.setHex(f),e.lambertMaterial.opacity=j,e.lambertMaterial.wireframe=i,e.lambertMaterial.wireframeLinewidth=currentStrokeSize,e.lambertMaterial.doubleSided=!1,e.lambertMaterial.ambient.setHex(ambientColor),e.lambertMaterial.reflectivity=reflectValue,e.lambertMaterial.refractionRatio=refractValue),void 0===
e.mesh)?(e.mesh=new THREE.Mesh(cylinderGeometry,e.lambertMaterial),e.startCountdown=SPINFRAMES):e.mesh.material=e.lambertMaterial:(void 0===e.basicMaterial?e.basicMaterial=new THREE.MeshBasicMaterial({color:f,opacity:j,wireframe:i,wireframeLinewidth:currentStrokeSize}):(e.basicMaterial.color.setHex(f),e.basicMaterial.opacity=j,e.basicMaterial.wireframe=i,e.basicMaterial.wireframeLinewidth=currentStrokeSize,e.basicMaterial.doubleSided=!1),void 0===e.mesh)?(e.mesh=new THREE.Mesh(cylinderGeometry,e.basicMaterial),
e.startCountdown=SPINFRAMES):e.mesh.material=e.basicMaterial;resetTheSpinThingy&&(e.startCountdown=SPINFRAMES,resetTheSpinThingy=!1,doTheSpinThingy=!0);doTheSpinThingy&&e.startCountdown--; -1===e.startCountdown&&(doTheSpinThingy=!1);e.mesh.isLine=!1;e.mesh.isRectangle=!1;e.mesh.isBox=!1;e.mesh.isCylinder=!0;e.mesh.isAmbientLight=!1;e.mesh.isPointLight=!1;e.mesh.isSphere=0;e.mesh.doubleSided=!1;usedCylinders++;doTheSpinThingy&&0<e.startCountdown&&(pushMatrix(),rotate(e.startCountdown/50),log(""+e.startCountdown));
e.mesh.matrixAutoUpdate=!1;e.mesh.matrix.copy(worldMatrix);e.mesh.matrixWorldNeedsUpdate=!0;doTheSpinThingy&&0<e.startCountdown&&popMatrix();if(1!==a||1!==b||1!==c)i?e.mesh.matrix.scale(new THREE.Vector3(a+0.0010,b+0.0010,c+0.0010)):e.mesh.matrix.scale(new THREE.Vector3(a,b,c));g&&scene.add(e.mesh)}}},ballDetail=function(a){void 0!==a&&(2>a&&(a=2),30<a&&(a=30),ballDetLevel=a)},ball=function(a){var b,c=0,f=0;log("fill: "+doFill+" stroke: "+doStroke+" fillCol "+currentFillColor+" stroke col "+currentStrokeColor+
" fill alpha "+currentFillAlpha);if(doFill||doStroke){doFill&&(0===currentStrokeSize||!doStroke||1>=currentStrokeSize&&!defaultNormalFill&&!defaultNormalStroke&&currentStrokeColor===currentFillColor&&1===currentFillAlpha&&1===currentStrokeAlpha)||1>=currentStrokeSize&&defaultNormalFill&&defaultNormalStroke?(c=0,f=1):(c=!doFill&&doStroke?1:0,f=2);void 0===a&&(a=1);for(var h=!1,i,j=!1;c<f;c++){1===c?(h=!0,b=currentStrokeColor,i=currentStrokeAlpha):(b=currentFillColor,i=currentFillAlpha);void 0===spheresPool[""+
ballDetLevel]&&(spheresPool[""+ballDetLevel]=[],log("creating pool for ball det level "+ballDetLevel));void 0===usedSpheres[""+ballDetLevel]&&(usedSpheres[""+ballDetLevel]=0,log("creating counter for ball det level "+ballDetLevel));var g=spheresPool[""+ballDetLevel][usedSpheres[""+ballDetLevel]];void 0===g&&(g={basicMaterial:void 0,lambertMaterial:void 0,normalMaterial:void 0,neverUsed:!0,mesh:void 0},j=!0,spheresPool[""+ballDetLevel].push(g),log("making space for pool for sphere , size of pool for spheres of detail "+
ballDetLevel+" is "+spheresPool[""+ballDetLevel].length));var d=!1,d=h?defaultNormalStroke?!0:!1:defaultNormalFill?!0:!1;g.neverUsed||b===angleColor||d?(g.neverUsed=!1,void 0===g.normalMaterial?(log("creating normal material"),g.normalMaterial=new THREE.MeshNormalMaterial({opacity:i,wireframe:h,wireframeLinewidth:currentStrokeSize})):(g.normalMaterial.opacity=i,g.normalMaterial.wireframe=h,g.normalMaterial.wireframeLinewidth=currentStrokeSize,g.normalMaterial.doubleSided=!1),void 0===g.mesh)?(b=sphereGeometriesPool[""+
ballDetLevel],void 0===b&&(b=new THREE.SphereGeometry(1,ballDetLevel,ballDetLevel),sphereGeometriesPool[""+ballDetLevel]=b,log("creating ball geometry of detail "+ballDetLevel)),g.mesh=new THREE.Mesh(b,g.normalMaterial),g.startCountdown=SPINFRAMES):g.mesh.material=g.normalMaterial:lightsAreOn?(void 0===g.lambertMaterial?(log("creating lambert:"+currentFillColor+" "+currentFillAlpha+" "+ambientColor+" "+reflectValue+" "+refractValue),g.lambertMaterial=new THREE.MeshLambertMaterial({color:b,opacity:i,
ambient:ambientColor,reflectivity:reflectValue,refractionRatio:refractValue,wireframe:h,wireframeLinewidth:currentStrokeSize})):(g.lambertMaterial.color.setHex(b),g.lambertMaterial.opacity=i,g.lambertMaterial.wireframe=h,g.lambertMaterial.wireframeLinewidth=currentStrokeSize,g.lambertMaterial.doubleSided=!1,g.lambertMaterial.ambient.setHex(ambientColor),g.lambertMaterial.reflectivity=reflectValue,g.lambertMaterial.refractionRatio=refractValue),void 0===g.mesh)?(b=sphereGeometriesPool[""+ballDetLevel],
void 0===b&&(b=new THREE.SphereGeometry(1,ballDetLevel,ballDetLevel),sphereGeometriesPool[""+ballDetLevel]=b,log("creating ball geometry of detail "+ballDetLevel)),g.mesh=new THREE.Mesh(b,g.lambertMaterial),g.startCountdown=SPINFRAMES):g.mesh.material=g.lambertMaterial:(void 0===g.basicMaterial?g.basicMaterial=new THREE.MeshBasicMaterial({color:b,opacity:i,wireframe:h,wireframeLinewidth:currentStrokeSize}):(g.basicMaterial.color.setHex(b),g.basicMaterial.opacity=i,g.basicMaterial.wireframe=h,g.basicMaterial.wireframeLinewidth=
currentStrokeSize,g.basicMaterial.doubleSided=!1),void 0===g.mesh)?(b=sphereGeometriesPool[""+ballDetLevel],void 0===b&&(b=new THREE.SphereGeometry(1,ballDetLevel,ballDetLevel),sphereGeometriesPool[""+ballDetLevel]=b,log("creating ball geometry of detail "+ballDetLevel)),g.mesh=new THREE.Mesh(b,g.basicMaterial),g.startCountdown=SPINFRAMES):g.mesh.material=g.basicMaterial;resetTheSpinThingy&&(g.startCountdown=SPINFRAMES,resetTheSpinThingy=!1,doTheSpinThingy=!0);doTheSpinThingy&&g.startCountdown--;
 -1===g.startCountdown&&(doTheSpinThingy=!1);g.mesh.isLine=!1;g.mesh.isRectangle=!1;g.mesh.isBox=!1;g.mesh.isCylinder=!1;g.mesh.isAmbientLight=!1;g.mesh.isPointLight=!1;g.mesh.isSphere=ballDetLevel;g.mesh.doubleSided=!1;usedSpheres[""+ballDetLevel]+=1;doTheSpinThingy&&0<g.startCountdown&&(pushMatrix(),rotate(g.startCountdown/50),log(""+g.startCountdown));g.mesh.matrixAutoUpdate=!1;g.mesh.matrix.copy(worldMatrix);g.mesh.matrixWorldNeedsUpdate=!0;doTheSpinThingy&&0<g.startCountdown&&popMatrix();1!==
a&&(h?g.mesh.matrix.scale(new THREE.Vector3(a+0.0010,a+0.0010,a+0.0010)):g.mesh.matrix.scale(new THREE.Vector3(a,a,a)));j&&scene.add(g.mesh)}}};Number.prototype.times=function(a,b){for(var c=this.valueOf(),f=0;f<c;f++)a.call(b||window,f)};
function checkErrorAndReport(a){$("#dangerSignText").css("color","red");a=""+a;-1<a.indexOf("Unexpected 'INDENT'")?a="weird indentation":-1<a.indexOf("Unexpected 'TERMINATOR'")?a="line not complete":-1<a.indexOf("Unexpected 'CALL_END'")?a="line not complete":-1<a.indexOf("Unexpected '}'")?a="something wrong":-1<a.indexOf("Unexpected 'MATH'")?a="weird arithmetic there":-1<a.indexOf("Unexpected 'LOGIC'")?a="odd expression thingy":-1<a.indexOf("Unexpected 'NUMBER'")?a="lost number?":-1<a.indexOf("Unexpected 'NUMBER'")?
a="lost number?":-1<a.indexOf("ReferenceError")&&(a=a.replace(/ReferenceError:\s/gm,""));$("#errorMessageText").text(a)}
function registerCode(){try{var a=editor.getValue();""!==a&&!0===fakeText&&shrinkFakeText();""===a&&!fakeText&&(fakeText=resetTheSpinThingy=!0,window.location.hash="",$("#formCode").animate({opacity:0},"fast"),log("unshrinking"),$("#justForFakeCursor").show(),$("#toMove").show(),$("#caption").html("|"),$("#toMove").animate({opacity:1,margin:0,fontSize:350,left:0},"fast",function(){$("#caption").html("");$("#fakeStartingBlinkingCursor").html("|")}));var b,c=!1,f,h;frenchVersion&&(a=a.replace(/\u00e9/g,
"e"),a=a.replace(/\u00ea/g,"e"),a=a.replace(/temps/g,"time"),a=a.replace(/uneFois/g,"doOnce"),a=a.replace(/boite/g,"box"),a=a.replace(/balle/g,"ball"),a=a.replace(/rectangle/g,"rect"),a=a.replace(/ligne/g,"line"),a=a.replace(/deplace/g,"move"),a=a.replace(/tourne/g,"rotate"),a=a.replace(/changeTaille/g,"scale"),a=a.replace(/tailleTrait/g,"strokeSize"),a=a.replace(/taille/g,"scale"),a=a.replace(/fond/g,"background"),a=a.replace(/degradeSimple/g,"simpleGradient"),a=a.replace(/styleAnimation/g,"animationStyle"),
a=a.replace(/flouMouvement/g,"motionBlur"),a=a.replace(/peindreAudessus/g,"paintOver"),a=a.replace(/peindreAuDessus/g,"paintOver"),a=a.replace(/sauveMatrice/g,"pushMatrix"),a=a.replace(/sauveMatrix/g,"pushMatrix"),a=a.replace(/pushMatrice/g,"pushMatrix"),a=a.replace(/restaureMatrice/g,"popMatrix"),a=a.replace(/restaureMatrix/g,"popMatrix"),a=a.replace(/popMatrice/g,"popMatrix"),a=a.replace(/effaceMatrice/g,"resetMatrix"),a=a.replace(/effaceMatrix/g,"resetMatrix"),a=a.replace(/resetMatrice/g,"resetMatrix"),
a=a.replace(/sansRemplissage/g,"noFill"),a=a.replace(/remplissage/g,"fill"),a=a.replace(/trait/g,"stroke"),a=a.replace(/couleur/g,"color"),a=a.replace(/eclairageAmbiant/g,"ambientLight"),a=a.replace(/sansEclairage/g,"noLights"),a=a.replace(/eclairage/g,"lights"),a=a.replace(/ajouteSon/g,"play"),a=a.replace(/fois/g,"times"),a=a.replace(/image/g,"frame"),a=a.replace(/couleurAngle/g,"angleColor"),a=a.replace(/noire/g,"black"),a=a.replace(/noir/g,"black"),a=a.replace(/blanche/g,"white"),a=a.replace(/blanc/g,
"white"),a=a.replace(/grise/g,"gray"),a=a.replace(/gris/g,"gray"),a=a.replace(/rouge/g,"red"),a=a.replace(/bleue/g,"blue"),a=a.replace(/bleu/g,"blue"),a=a.replace(/jaune/g,"yellow"),a=a.replace(/verte/g,"green"),a=a.replace(/vert/g,"green"),a=a.replace(/violet/g,"purple"),a=a.replace(/marron/g,"brown"),a=a.replace(/rose/g,"pink"),a=a.replace(/peche/g,"peachpuff"));a=a.replace(/^(\s)*\u2713[ ]*doOnce[ ]*\-\>[ ]*$/gm,"$1if false");for(b=a=a.replace("\u2713","//");b.length;){f=b.charAt(0);h=b.charAt(1);
if("'"===f||'"'===f||"/"===f&&("*"===h||"/"===h)){c=!0;break}b=b.slice(1)}c?(a=a.replace(/("(?:[^"\\\n]|\\.)*")|('(?:[^'\\\n]|\\.)*')|(\/\/[^\n]*\n)|(\/\*(?:(?!\*\/)(?:.|\n))*\*\/)/g,function(a,b,c,d,e){if(b)return b;if(c)return c;if(d)return"\n";a=e.split("\n").length-1;b="";for(c=0;c<a;c++)b=b+"\n";return b}),b=a.replace(/("(?:[^"\\\n]|\\.)*")|('(?:[^'\\\n]|\\.)*')/g,"")):b=a;for(var i=h=c=0,j=0,g=0;b.length;){f=b.charAt(0);if("'"===f)c+=1;else if('"'===f)h+=1;else if("("===f||")"===f)i+=1;else if("{"===
f||"}"===f)j+=1;else if("["===f||"]"===f)g+=1;b=b.slice(1)}if(c&1||h&1||i&1||j&1||g&1){if(autocodeOn){editor.undo();return}programHasBasicError=!0;$("#dangerSignText").css("color","red");c&1&&(reasonOfBasicError="Missing '");h&1&&(reasonOfBasicError='Missing "');i&1&&(reasonOfBasicError="Unbalanced ()");j&1&&(reasonOfBasicError="Unbalanced {}");g&1&&(reasonOfBasicError="Unbalanced []");$("#errorMessageText").text(reasonOfBasicError);return}var d="\t"+a.replace(/\n/g,"\n\t"),d=("draw = ->\n"+d).replace(/(\d+)[ ]+bpm(\s)/g,
"bpm $1$2"),d=d.replace(/([a-zA-Z]+)[ ]+fill(\s)/g,"fill $1$2"),d=d.replace(/([a-zA-Z]+)[ ]+stroke(\s)/g,"stroke $1$2"),d=d.replace(/([a-zA-Z]+)[ ]+background(\s)/g,"background $1$2"),d=d.replace(/(\d+)\s+times[ ]*\->/g,";( $1 + 0).times ->");if(-1<d.indexOf("doOnce")){for(var e=d.split("\n"),a=0;a<e.length;a++)e[a]=e[a].replace(/^(\s*)doOnce[ ]*\->[ ]*(.+)$/gm,"$1;doLNOnce.push("+(a-1)+"); (1+0).times -> $2"),e[a].match(/^(\s*)doOnce[ ]*\->[ ]*$/gm)&&(e[a]=e[a].replace(/^(\s*)doOnce[ ]*\->[ ]*$/gm,
"$1(1+0).times ->"),e[a+1]=e[a+1].replace(/^(\s*)(.+)$/gm,"$1;doLNOnce.push("+(a-1)+"); $2"));d=e.join("\n")}d=d.replace(/^(\s*)([a-z]+[a-zA-Z0-9]*)[ ]*$/gm,"$1;$2()");d=d.replace(/;\s*([a-z]+[a-zA-Z0-9]*)[ ]*([;\n]+)/g,";$1()$2");d=d.replace(/\->\s*([a-z]+[a-zA-Z0-9]*)[ ]*([;\n]+)/g,";$1()$2");if(d.match(/[\s\+\;]+draw\s*\(/)){if(autocodeOn){editor.undo();return}programHasBasicError=!0;$("#dangerSignText").css("color","red");$("#errorMessageText").text("You can't call draw()");return}d=d.replace(/;if\(\)/g,
";if");d=d.replace(/;else\(\)/g,";else");d=d.replace(/;for\(\)/g,";for");d=d.replace(/\/\//g,"#");d=d.replace(/scale(\s)+/g,";scale$1");d=d.replace(/rotate(\s)+/g,";rotate$1");d=d.replace(/move(\s)+/g,";move$1");d=d.replace(/rect(\s)+/g,";rect$1");d=d.replace(/line(\s)+/g,";line$1");d=d.replace(/bpm(\s)+/g,";bpm$1");d=d.replace(/play(\s)+/g,";play$1");d=d.replace(/pushMatrix(\s)+/g,";pushMatrix$1");d=d.replace(/popMatrix(\s)+/g,";popMatrix$1");d=d.replace(/resetMatrix(\s)+/g,";resetMatrix$1");d=d.replace(/fill(\s)+/g,
";fill$1");d=d.replace(/noFill(\s)+/g,";noFill$1");d=d.replace(/stroke(\s)+/g,";stroke$1");d=d.replace(/noStroke(\s)+/g,";noStroke$1");d=d.replace(/strokeSize(\s)+/g,";strokeSize$1");d=d.replace(/animationStyle(\s)+/g,";animationStyle$1");d=d.replace(/simpleGradient(\s)+/g,";simpleGradient$1");d=d.replace(/background(\s)+/g,";background$1");d=d.replace(/color(\s)+/g,";color$1");d=d.replace(/lights(\s)+/g,";lights$1");d=d.replace(/noLights(\s)+/g,";noLights$1");d=d.replace(/ambientLight(\s)+/g,";ambientLight$1");
d=d.replace(/pointLight(\s)+/g,";pointLight$1");d=d.replace(/ball(\s)+/g,";ball$1");d=d.replace(/ballDetail(\s)+/g,";ballDetail$1");d=d.replace(/peg(\s)+/g,";peg$1");d=d.replace(/->(\s+);/g,"->$1");d=d.replace(/(\s)if\s*(.*)(\s*);/g,"$1if $2$3");d=d.replace(/(\s);else\s*if\s*(.*)(\s*);/g,"$1else if $2$3");d=d.replace(/(\s);else(.*)(\s*);/g,"$1else$2$3");out=CoffeeScript.compile(d,{bare:"on"});log("in javascript: "+out)}catch(o){if(autocodeOn){editor.undo();return}checkErrorAndReport(o);return}e=/([a-z]+[a-zA-Z0-9]*) = function/;
d=[];for(a=out;a=a.match(e);)d.push(a[1]),a=RegExp.rightContext;e=[];for(a=out;a=a.match(/\s([a-z]+[a-zA-Z0-9]*)\(/);)e.push(a[1]),a=RegExp.rightContext;for(a=0;a<e.length;a++)if(!("function"===e[a]||"rotate"===e[a]||"rect"===e[a]||"line"===e[a]||"box"===e[a]||"move"===e[a]||"scale"===e[a]||"alert"===e[a]||"bpm"===e[a]||"play"===e[a]||"pushMatrix"===e[a]||"popMatrix"===e[a]||"resetMatrix"===e[a]||"fill"===e[a]||"noFill"===e[a]||"stroke"===e[a]||"noStroke"===e[a]||"strokeSize"===e[a]||"animationStyle"===
e[a]||"background"===e[a]||"simpleGradient"===e[a]||"color"===e[a]||"lights"===e[a]||"noLights"===e[a]||"ambientLight"===e[a]||"pointLight"===e[a]||"ball"===e[a]||"ballDetail"===e[a]||"peg"===e[a])){if(0===d.length){$("#dangerSignText").css("color","red");$("#errorMessageText").text(e[a]+" doesn't exist");return}for(b=0;b<d.length&&e[a]!==d[b];b++)if(b==d.length-1){$("#dangerSignText").css("color","red");$("#errorMessageText").text(e[a]+" doesn't exist");return}}programHasBasicError=!1;reasonOfBasicError=
"";$("#dangerSignText").css("color","#000000");$("#errorMessageText").text(reasonOfBasicError);consecutiveFramesWithoutRunTimeError=0;out=out.replace(/var frame/,";");window.eval(out)}
if(frenchVersion)simpleCubeDemo="// there you go!\n// a simple cube!\n\nfond jaune\ntourne 0,temps/2000,temps/2000\nboite",webgltwocubesDemo="fond 155,255,255\n2 fois ->\n\ttourne 0, 1, temps/2000\n\tboite",cubesAndSpikes="d\u00e9grad\u00e9Simple fuchsia,couleur(100,200,200),jaune\ntaille 2.1\n5 fois ->\n\ttourne 0,1,temps/5000\n\tboite 0.1,0.1,0.1\n\tdeplace 0,0.1,0.1\n\t3 fois ->\n\t\ttourne 0,1,1\n\t\tboite 0.01,0.01,1",webglturbineDemo="fond 155,55,255\n70 fois ->\n\ttourne temps/100000,1,temps/100000\n\tboite",
webglzfightartDemo="// Explore the artifacts\n// of your GPU!\n// Go Z-fighting, go!\ntaille 5\ntourne\nremplissage rouge\nboite\ntourne 0.000001\nremplissage jaune\nboite",littleSpiralOfCubes="fond orange\ntaille 0.1\n10 fois ->\n\ttourne 0,1,temps/1000\n\tdeplace 1,1,1\n\tboite",tentacleDemo="fond 155,255,155\ntaille 0.15\n3 fois ->\n\ttourne 0,1,1\n\t10 fois ->\n\t\ttourne 0,1,temps/1000\n\t\ttaille 0.9\n\t\tdeplace 1,1,1\n\t\tboite",lampDemo="styleAnimation flouMouvement\nd\u00e9grad\u00e9Simple rouge,jaune,couleur(255,0,255)\n//styleAnimation peindreAuDessus\ntaille 2\ntourne temps/4000, temps/4000,  temps/4000\n90 fois ->\n\ttourne temps/200000, temps/200000,  temps/200000\n\tligne\n\tdeplace 0.5,0,0\n\tligne\n\tdeplace -0.5,0,0\n\tligne\n\tligne",
trillionfeathersDemo="styleAnimation peindreAuDessus\ndeplace 2,0,0\ntaille 2\ntourne\n20 fois ->\n\ttourne\n\tdeplace 0.25,0,0\n\tligne\n\tdeplace -0.5,0,0\n\tligne",monsterblobDemo="balleDetail 6\nstyleAnimation flouMouvement\ntourne temps/5000\nd\u00e9grad\u00e9Simple fuchsia,aqua,jaune\n5 fois ->\n\ttourne 0,1,temps/5000\n\tdeplace 0.2,0,0\n\t3 fois ->\n\t\ttourne 1\n\t\tballe -1",industrialMusicDemo="bpm 88\najouteSon 'alienBeep'  ,'zzxz zzzz zzxz zzzz'\najouteSon 'beepC'  ,'zxzz zzzz xzzx xxxz'\najouteSon 'beepA'  ,'zzxz zzzz zzxz zzzz'\najouteSon 'lowFlash'  ,'zzxz zzzz zzzz zzzz'\najouteSon 'beepB'  ,'xzzx zzzz zxzz zxzz'\najouteSon 'voltage' ,'xzxz zxzz xzxx xzxx'\najouteSon 'tranceKick' ,'zxzx zzzx xzzz zzxx'",
trySoundsDemo="bpm 88\n// leave this one as base\najouteSon 'tranceKick' ,'zxzx zzzx xzzz zzxx'\n\n// uncomment the sounds you want to try\n//ajouteSon 'toc','zzxz zzzz zzxz zzzz'\n//ajouteSon 'highHatClosed','zzxz zzzz zzxz zzzz'\n//ajouteSon 'highHatOpen','zzxz zzzz zzxz zzzz'\n//ajouteSon 'toc2','zzxz zzzz zzxz zzzz'\n//ajouteSon 'toc3','zzxz zzzz zzxz zzzz'\n//ajouteSon 'toc4','zzxz zzzz zzxz zzzz'\n//ajouteSon 'snare','zzxz zzzz zzxz zzzz'\n//ajouteSon 'snare2','zzxz zzzz zzxz zzzz'\n//ajouteSon 'china','zzxz zzzz zzxz zzzz'\n//ajouteSon 'crash','zzxz zzzz zzxz zzzz'\n//ajouteSon 'crash2','zzxz zzzz zzxz zzzz'\n//ajouteSon 'crash3','zzxz zzzz zzxz zzzz'\n//ajouteSon 'ride','zzxz zzzz zzxz zzzz'\n//ajouteSon 'glass','zzxz zzzz zzxz zzzz'\n//ajouteSon 'glass1','zzxz zzzz zzxz zzzz'\n//ajouteSon 'glass2','zzxz zzzz zzxz zzzz'\n//ajouteSon 'glass3','zzxz zzzz zzxz zzzz'\n//ajouteSon 'thump','zzxz zzzz zzxz zzzz'\n//ajouteSon 'lowFlash','zzxz zzzz zzxz zzzz'\n//ajouteSon 'lowFlash2','zzxz zzzz zzxz zzzz'\n//ajouteSon 'tranceKick2','zzxz zzzz zzxz zzzz'\n//ajouteSon 'tranceKick','zzxz zzzz zzxz zzzz'\n//ajouteSon 'wosh','zzxz zzzz zzxz zzzz'\n//ajouteSon 'voltage','zzxz zzzz zzxz zzzz'\n//ajouteSon 'beepA','zzxz zzzz zzxz zzzz'\n//ajouteSon 'beepB','zzxz zzzz zzxz zzzz'\n//ajouteSon 'beepC','zzxz zzzz zzxz zzzz'\n//ajouteSon 'beepD','zzxz zzzz zzxz zzzz'\n//ajouteSon 'beep','zzxz zzzz zzxz zzzz'\n//ajouteSon 'hello','zzxz zzzz zzxz zzzz'\n//ajouteSon 'alienBeep','zzxz zzzz zzxz zzzz'",
springysquaresDemo="styleAnimation flouMouvement\nd\u00e9grad\u00e9Simple fuchsia,couleur(100,200,200),jaune\ntaille 0.3\n3 fois ->\n\tdeplace 0,0,0.5\n\t5 fois ->\n\t\ttourne temps/2000\n\t\tdeplace 0.7,0,0\n\t\trect",diceDemo="styleAnimation flouMouvement\nd\u00e9grad\u00e9Simple couleur(255),moccasin,peche\ntrait 255,100,100,255\nremplissage rouge,155\ndeplace -0.5,0,0\ntaille 0.3\n3 fois ->\n\tdeplace 0,0,0.5\n\t1 fois ->\n\t\ttourne temps/1000\n\t\tdeplace 2,0,0\n\t\tboite",webglalmostvoronoiDemo=
"taille 10\n2 fois ->\n\ttourne 0,1,temps/10000\n\tballe -1",webglshardsDemo="taille 10\nremplissage 0\ntraitSize 7\n5 fois ->\n\ttourne 0,1,temps/20000\n\tballe \n\ttourne 0,1,1\n\tballe -1.01",webglredthreadsDemo="taille 10.5\nfond noir\ntrait rouge\nsansRemplissage\ntraitSize 7\n5 fois ->\n\ttourne temps/20000\n\tballe\n\ttourne 0,1,1\n\tballe",webglnuclearOctopusDemo="d\u00e9grad\u00e9Simple noir,couleur(0,0,(temps/5)%255),noir\ntaille 0.2\ndeplace 5,0,0\nstyleAnimation flouMouvement\n//styleAnimation peindreAuDessus\ntrait 255,0,0,120\nremplissage temps%255,0,0\nsauveMatrice\ncount = 0\n3 fois ->\n\tcount++\n\tsauveMatrice\n\ttourne count+3+temps/1000,2+count + temps/1000,4+count\n\t120 fois ->\n\t\ttaille 0.9\n\t\tdeplace 1,1,0\n\t\ttourne temps/100\n\t\tboite\n\trestaureMatrice";
else var roseDemo="// 'A rose' by Guy John\n// Mozilla Festival 2012\n// adapted by from 'A rose' by Lib4tech\n\nscale 1.5\nanimationStyle paintOver\nrotate time/1000\nfill 255-((frame/2)%255),0,0\nstroke 255-((frame/2)%255),0,0\nscale 1-((frame/2)%255) / 255\nbox",cheeseAndOlivesDemo="// 'Cheese and olives' by\n// Davina Tirvengadum\n// Mozilla festival 2012\n\nbackground white\nscale .3\nmove 0,-1\nfill yellow\nstroke black\nrotate\nstrokeSize 3\nline 4\nbox\n\nrotate 2,3\nmove 0,3\nscale .3\nfill black\nstroke black\nball\n\nrotate 3\nmove 5\nscale 1\nfill green\nstroke green\nball\n\nrotate 1\nmove -3\nscale 1\nfill yellow\nstroke yellow\nball",
simpleCubeDemo="// there you go!\n// a simple cube!\n\nbackground yellow\nrotate 0,time/2000,time/2000\nbox",webgltwocubesDemo="background 155,255,255\n2 times ->\n\trotate 0, 1, time/2000\n\tbox",cubesAndSpikes="simpleGradient fuchsia,color(100,200,200),yellow\nscale 2.1\n5 times ->\n\trotate 0,1,time/5000\n\tbox 0.1,0.1,0.1\n\tmove 0,0.1,0.1\n\t3 times ->\n\t\trotate 0,1,1\n\t\tbox 0.01,0.01,1",webglturbineDemo="background 155,55,255\n70 times ->\n\trotate time/100000,1,time/100000\n\tbox",webglzfightartDemo=
"// Explore the artifacts\n// of your GPU!\n// Go Z-fighting, go!\nscale 5\nrotate\nfill red\nbox\nrotate 0.000001\nfill yellow\nbox",littleSpiralOfCubes="background orange\nscale 0.1\n10 times ->\n\trotate 0,1,time/1000\n\tmove 1,1,1\n\tbox",tentacleDemo="background 155,255,155\nscale 0.15\n3 times ->\n\trotate 0,1,1\n\t10 times ->\n\t\trotate 0,1,time/1000\n\t\tscale 0.9\n\t\tmove 1,1,1\n\t\tbox",lampDemo="animationStyle motionBlur\nsimpleGradient red,yellow,color(255,0,255)\n//animationStyle paintOver\nscale 2\nrotate time/4000, time/4000,  time/4000\n90 times ->\n\trotate time/200000, time/200000,  time/200000\n\tline\n\tmove 0.5,0,0\n\tline\n\tmove -0.5,0,0\n\tline\n\tline",
trillionfeathersDemo="animationStyle paintOver\nmove 2,0,0\nscale 2\nrotate\n20 times ->\n\trotate\n\tmove 0.25,0,0\n\tline\n\tmove -0.5,0,0\n\tline",monsterblobDemo="ballDetail 6\nanimationStyle motionBlur\nrotate time/5000\nsimpleGradient fuchsia,aqua,yellow\n5 times ->\n\trotate 0,1,time/5000\n\tmove 0.2,0,0\n\t3 times ->\n\t\trotate 1\n\t\tball -1",industrialMusicDemo="bpm 88\nplay 'alienBeep'  ,'zzxz zzzz zzxz zzzz'\nplay 'beepC'  ,'zxzz zzzz xzzx xxxz'\nplay 'beepA'  ,'zzxz zzzz zzxz zzzz'\nplay 'lowFlash'  ,'zzxz zzzz zzzz zzzz'\nplay 'beepB'  ,'xzzx zzzz zxzz zxzz'\nplay 'voltage' ,'xzxz zxzz xzxx xzxx'\nplay 'tranceKick' ,'zxzx zzzx xzzz zzxx'",
trySoundsDemo="bpm 88\n// leave this one as base\nplay 'tranceKick' ,'zxzx zzzx xzzz zzxx'\n\n// uncomment the sounds you want to try\n//play 'toc','zzxz zzzz zzxz zzzz'\n//play 'highHatClosed','zzxz zzzz zzxz zzzz'\n//play 'highHatOpen','zzxz zzzz zzxz zzzz'\n//play 'toc2','zzxz zzzz zzxz zzzz'\n//play 'toc3','zzxz zzzz zzxz zzzz'\n//play 'toc4','zzxz zzzz zzxz zzzz'\n//play 'snare','zzxz zzzz zzxz zzzz'\n//play 'snare2','zzxz zzzz zzxz zzzz'\n//play 'china','zzxz zzzz zzxz zzzz'\n//play 'crash','zzxz zzzz zzxz zzzz'\n//play 'crash2','zzxz zzzz zzxz zzzz'\n//play 'crash3','zzxz zzzz zzxz zzzz'\n//play 'ride','zzxz zzzz zzxz zzzz'\n//play 'glass','zzxz zzzz zzxz zzzz'\n//play 'glass1','zzxz zzzz zzxz zzzz'\n//play 'glass2','zzxz zzzz zzxz zzzz'\n//play 'glass3','zzxz zzzz zzxz zzzz'\n//play 'thump','zzxz zzzz zzxz zzzz'\n//play 'lowFlash','zzxz zzzz zzxz zzzz'\n//play 'lowFlash2','zzxz zzzz zzxz zzzz'\n//play 'tranceKick2','zzxz zzzz zzxz zzzz'\n//play 'tranceKick','zzxz zzzz zzxz zzzz'\n//play 'wosh','zzxz zzzz zzxz zzzz'\n//play 'voltage','zzxz zzzz zzxz zzzz'\n//play 'beepA','zzxz zzzz zzxz zzzz'\n//play 'beepB','zzxz zzzz zzxz zzzz'\n//play 'beepC','zzxz zzzz zzxz zzzz'\n//play 'beepD','zzxz zzzz zzxz zzzz'\n//play 'beep','zzxz zzzz zzxz zzzz'\n//play 'hello','zzxz zzzz zzxz zzzz'\n//play 'alienBeep','zzxz zzzz zzxz zzzz'",
springysquaresDemo="animationStyle motionBlur\nsimpleGradient fuchsia,color(100,200,200),yellow\nscale 0.3\n3 times ->\n\tmove 0,0,0.5\n\t5 times ->\n\t\trotate time/2000\n\t\tmove 0.7,0,0\n\t\trect",diceDemo="animationStyle motionBlur\nsimpleGradient color(255),moccasin,peachpuff\nstroke 255,100,100,255\nfill red,155\nmove -0.5,0,0\nscale 0.3\n3 times ->\n\tmove 0,0,0.5\n\t1 times ->\n\t\trotate time/1000\n\t\tmove 2,0,0\n\t\tbox",webglalmostvoronoiDemo="scale 10\n2 times ->\n\trotate 0,1,time/10000\n\tball -1",
webglshardsDemo="scale 10\nfill 0\nstrokeSize 7\n5 times ->\n\trotate 0,1,time/20000\n\tball \n\trotate 0,1,1\n\tball -1.01",webglredthreadsDemo="scale 10.5\nbackground black\nstroke red\nnoFill\nstrokeSize 7\n5 times ->\n\trotate time/20000\n\tball\n\trotate 0,1,1\n\tball",webglnuclearOctopusDemo="simpleGradient black,color(0,0,(time/5)%255),black\nscale 0.2\nmove 5,0,0\nanimationStyle motionBlur\n//animationStyle paintOver\nstroke 255,0,0,120\nfill time%255,0,0\npushMatrix\ncount = 0\n3 times ->\n\tcount++\n\tpushMatrix\n\trotate count+3+time/1000,2+count + time/1000,4+count\n\t120 times ->\n\t\tscale 0.9\n\t\tmove 1,1,0\n\t\trotate time/100\n\t\tbox\n\tpopMatrix";
if(frenchVersion)introTutorial="// Les lignes qui commencent avec deux slashes\n// (comme celle-ci) sont des commentaires.\n// Tout le reste est lanc\u00e9\n// entre 30 et 60 fois par seconde\n// pour cr\u00e9er une animation\n\n// Cliquez sur le lien ci-dessous pour d\u00e9marrer le tutorial.\n// next-tutorial:hello_world",helloworldTutorial="// Tapez ces cinq lettres\n// sur une des lignes vides\n// b, o, i, t, e\n\n\n\n// (vous devriez voir une belle boite appara\u00eetre)\n// cliquez pour le prochain tutorial :\n// next-tutorial:some_notes",
somenotesTutorial="// Au cas o\u00f9 cela vous dit quelque chose :\n// la syntaxe est similaire \u00e0 Coffeescript\n// et les commandes sont presque\n// comme Processing.\n\n// Si cela ne veut rien dire pour vous\n// pas de soucis.\n// next-tutorial:rotate",rotateTutorial='// Maintenant nous avons une boite\n// faisons la tourner:\n// tapez "tourne 1" sur la ligne\n// au dessus de "boite"\n\n\nboite\n\n// cliquez pour le prochain tutorial :\n// next-tutorial:frame',frameTutorial='// faites tourner la boite\n// en rempla\u00e7ant "1" par "image"\n\ntourne 1\nboite\n\n// "image" contient un nombre\n// qui s\u2019incr\u00e9mente au fur et \u00e0 mesure\n// que l\u2019\u00e9cran est re-dessin\u00e9.\n// (utilisez "image/100" pour la ralentir)\n// next-tutorial:time',
timeTutorial='// "image/100" a un probl\u00e8me :\n// les ordinateurs rapides vont faire\n// tourner le cube trop vite.\n// Remplacez le par "temps/2000".\n\ntourne image/100\nboite\n\n// "temps" compte le nombre de millisecondes\n// depuis que le programme  a d\u00e9marr\u00e9,\n// il est donc ind\u00e9pendent de la vitesse\n// \u00e0 laquelle l\u2019ordinateur dessine les images.\n// next-tutorial:move',moveTutorial='// vous pouvez d\u00e9placer n\u2019importe quel objet\n// en utilisant "deplace"\n\nboite\ndeplace 1,1,0\nboite\n\n// essayez d\u2019utiliser tourne\n// avant la premi\u00e8re boite pour voir\n// comment la sc\u00e8ne change.\n// next-tutorial:scale',
scaleTutorial='// vous pouvez changer la taille des objets\n// en utilisant "taille"\n\ntourne 3\nboite\ndeplace 1\ntaille 2\nboite\n\n// essayez d\u2019utiliser tourne\n// avant la premi\u00e8re boite pour voir\n// comment la sc\u00e8ne change..\n// next-tutorial:times',timesTutorial='// "fois" peut-\u00eatre utilis\u00e9\n// pour r\u00e9p\u00e9ter des op\u00e9rations :\n\ntourne 1\n3 fois ->\n\tdeplace 0.2,0.2,0.2\n\tboite\n\n// notez comme les tabulations indiquent \n// exactement le bloc de code\n// qui doit \u00eatre r\u00e9p\u00e9t\u00e9.\n// next-tutorial:fill',
fillTutorial='// "remplissage" d\u00e9fini la\n// couleur de toutes les faces :\n\nremplissage 255,255,0\nboite\n\n// les trois nombres indiquent\n// les valeurs de rouge, vert et bleu.\n// Vous pouvez aussi utiliser\n// des noms de couleur comme indigo\n// Essayez de remplacer les nombres avec\n// "couleurAngle"\n// next-tutorial:stroke',strokeTutorial='// "trait" change la couleur\n// des arr\u00eates :\n\ntourne 1\ntailleTrait 5\ntrait 255,255,255\nboite\n\n// les trois nombres sont les valeurs RVB\n// mais vous pouvez utiliser les noms des couleurs,\n// ou la couleur sp\u00e9ciale  "couleurAngle"\n// Vous pouvez aussi utiliser "tailleTrait"\n// pour pr\u00e9ciser l\u2019\u00e9paisseur.\n// next-tutorial:color_names',
colornamesTutorial="// vous pouvez indiquer les couleurs par nom\n// essayer de d\u00e9-commenter une ligne :\n\n//remplissage rouge\n//remplissage vert\n//remplissage p\u00eache\ntourne 1\nboite\n\n// plus de noms de couleurs ici :\n// http://html-color-codes.info/color-names/\n// (utilisez en minuscule, pas de majuscules)\n// next-tutorial:lights",lightsTutorial='// "eclairageAmbiant" cr\u00e9\u00e9 un\n// \u00e9clairage ambiant de sorte que les objets\n// ont une sorte de d\u2019ombrage:\n\neclairageAmbiant 0,255,255\ntourne temps/1000\nboite\n\n// vous pouvez \u00e9teindre ou allumer cet \u00e9clairage\n// pendant que vous construisez la sc\u00e8ne// en utilisant "eclairage" et "sansEclairage"\n// next-tutorial:background',
backgroundTutorial='// "fond" cr\u00e9\u00e9 un\n// fond de couleur :\n\nfond 0,0,255\ntourne temps/1000\nboite\n\n// next-tutorial:gradient',gradientTutorial="// encore plus sympa, vous pouvez\n// cr\u00e9\u00e9r un fond en d\u00e9grad\u00e9:\n\ndegradeSimple couleur(190,10,10),couleur(30,90,100),couleur(0)\ntourne temps/1000\nboite\n\n// next-tutorial:line",lineTutorial="// dessinez des lignes comme ceci :\n\n20 fois ->\n\ttourne temps/9000\n\tligne\n\n// next-tutorial:ball",ballTutorial='// dessinez des balles comme ceci :\n\nballeDetail 10\n3 fois ->\n\tdeplace 0.2,0.2,0.2\n\tballe\n\n// ("balleDetail" est optionnel)\n// next-tutorial:pushpopMatrix',
pushpopMatrixTutorial='// sauveMatrice m\u00e9morise\n// la position, et vous pouvez\n// y revenir plus tard avec restaureMatrice.\n// Vous pouvez revenir \u00e0 z\u00e9ro avec "effaceMatrice".\n\ntourne temps/1000\nsauveMatrice // m\u00e9morise la position apr\u00e8s la rotation\nligne\ndeplace 0.5,0,0\nligne\nrestaureMatrice // revient \u00e0 la position m\u00e9moris\u00e9e\ndeplace -0.5,0,0\nligne\neffaceMatrice // remets la position \u00e0 z\u00e9ro\nligne // cette ligne n\u2019est donc pas affect\u00e9 par la rotation\n// next-tutorial:animation_style',
animationstyleTutorial="// essayez de d\u00e9-commenter l\u2019une ou l\u2019autre\n// des deux lignes  avec styleAnimation\n\nfond 255\n//styleAnimation flouMouvement\n//styleAnimation peindreAudessus\ntourne image/10\nboite\n\n// next-tutorial:do_once",doonceTutorial="// effacez l\u2019une ou l\u2019autre des coches\n\ntourne temps/1000\n\u2713uneFois ->\n\tfond 255\n\tremplissage 255,0,0\n\u2713uneFois -> balle\nboite\n\n// \u2026la ligne ou le bloc de code\n// n\u2019est ex\u00e9cut\u00e9 qu\u2019une seule fois, et apr\u00e8s cela\n// la coche r\u00e9apparait imm\u00e9diattement\n// P.S. continuez de supprimer la premi\u00e8re coche\n// en continu pour provoquer un \u00e9vanouissement :-)\n// next-tutorial:autocode",
autocodeTutorial="// le bouton Autocode invente pour vous\n// des variations al\u00e9atoires du code.\n\n// vous pouvez arr\u00eater Autocode\n// \u00e0 tout moment en r\u00e9-appuyant sur le bouton\n// ou vous pouvez faire CTRL-Z\n// (CMD-Z sur Mac) pour annuler (or r\u00e9tablir) certainesn// des \u00e9tapes y compris PENDANT que Autocode est actif\n// si par exemple vous trouvez que les choses\n// deviennent ennuyeuse dans la direction prise par Autocode.";else var introTutorial="// Lines beginning with two\n// slashes (like these) are just comments.\n// Everything else is run\n// about 30 to 60 times per second\n// in order to create an animation.\n\n// Click the link below to start the tutorial.\n// next-tutorial:hello_world",
helloworldTutorial='// type these three letters\n// in one of these empty lines below:\n// "b" and "o" and "x"\n\n\n\n// (you should then see a box facing you)\n// click below for the next tutorial\n// next-tutorial:some_notes',somenotesTutorial="// If this makes sense to you:\n// the syntax is similar to Coffeescript\n// and the commands are almost\n// like Processing.\n\n// If this doesn't make sense to you\n// don't worry.\n// next-tutorial:rotate",rotateTutorial='// now that we have a box\n// let\'s rotate it:\n// type "rotate 1" in the\n// line before the "box"\n\n\nbox\n\n// click for the next tutorial:\n// next-tutorial:frame',
frameTutorial='// make the box spin\n// by replacing "1" with "frame"\n\nrotate 1\nbox\n\n// "frame" contains a number\n// always incrementing as\n// the screen is re-drawn.\n// (use "frame/100" to slow it down)\n// next-tutorial:time',timeTutorial='// "frame/100" has one problem:\n// faster computers will make\n// the cube spin too fast.\n// Replace it with "time/2000".\n\nrotate frame/100\nbox\n\n// "time" counts the\n// number of milliseconds since\n// the program started, so it\'s\n// independent of how fast\n// the computer is at drawing.\n// next-tutorial:move',
moveTutorial='// you can move any object\n// by using "move"\n\nbox\nmove 1,1,0\nbox\n\n// try to use a rotate before \n// the first box to see how the\n// scene changes.\n// next-tutorial:scale',scaleTutorial='// you can make an object bigger\n// or smaller by using "scale"\n\nrotate 3\nbox\nmove 1\nscale 2\nbox\n\n// try to use scale or move before \n// the first box to see how the\n// scene changes.\n// next-tutorial:times',timesTutorial='// "times" (not to be confused with\n// "time"!) can be used to\n// repeat operations like so:\n\nrotate 1\n3 times ->\n\tmove 0.2,0.2,0.2\n\tbox\n\n// note how the tabs indicate \n// exactly the block of code\n// to be repeated.\n// next-tutorial:fill',
fillTutorial='// "fill" changes the\n// color of all the faces:\n\nfill 255,255,0\nbox\n\n// the three numbers indicate \n// red green and blue values.\n// You can also use color names such as indigo\n// Try replacing the numbers with\n// "angleColor"\n// next-tutorial:stroke',strokeTutorial='// "stroke" changes all the\n// edges:\n\nrotate 1\nstrokeSize 5\nstroke 255,255,255\nbox\n\n// the three numbers are RGB\n// but you can also use the color names\n// or the special color "angleColor"\n// Also you can use "strokeSize"\n// to specify the thickness.\n// next-tutorial:color_names',
colornamesTutorial="// you can call colors by name\n// try to un-comment one line:\n\n//fill greenyellow\n//fill indigo\n//fill lemonchiffon // whaaaat?\nrotate 1\nbox\n\n// more color names here:\n// http://html-color-codes.info/color-names/\n// (just use them in lower case)\n// next-tutorial:lights",lightsTutorial='// "ambientLight" creates an\n// ambient light so things have\n// some sort of shading:\n\nambientLight 0,255,255\nrotate time/1000\nbox\n\n// you can turn that light on and \n// off while you build the scene\n// by using "lights" and "noLights"\n// next-tutorial:background',
backgroundTutorial='// "background" creates a\n// solid background:\n\nbackground 0,0,255\nrotate time/1000\nbox\n\n// next-tutorial:gradient',gradientTutorial="// even nicer, you can paint a\n// background gradient:\n\nsimpleGradient color(190,10,10),color(30,90,100),color(0)\nrotate time/1000\nbox\n\n// next-tutorial:line",lineTutorial="// draw lines like this:\n\n20 times ->\n\trotate time/9000\n\tline\n\n// next-tutorial:ball",ballTutorial='// draw balls like this:\n\nballDetail 10\n3 times ->\n\tmove 0.2,0.2,0.2\n\tball\n\n// ("ballDetail" is optional)\n// next-tutorial:pushpopMatrix',
pushpopMatrixTutorial='// pushMatrix creates a bookmark of\n// the position, which you can\n// return to later by using popMatrix.\n// You can reset using "resetMatrix".\n\nrotate time/1000\npushMatrix // bookmark the position after the rotation\nline\nmove 0.5,0,0\nline\npopMatrix // go back to the bookmarked position\nmove -0.5,0,0\nline\nresetMatrix // resets the position\nline // not affected by initial rotation\n// next-tutorial:animation_style',animationstyleTutorial="// try uncommenting either line\n// with the animationStyle\n\nbackground 255\n//animationStyle motionBlur\n//animationStyle paintOver\nrotate frame/10\nbox\n\n// next-tutorial:do_once",
doonceTutorial="// delete either check mark below\n\nrotate time/1000\n\u2713doOnce ->\n\tbackground 255\n\tfill 255,0,0\n\u2713doOnce -> ball\nbox\n\n// ...the line or block of code\n// are ran one time only, after that the\n// check marks immediately re-appear\n// P.S. keep hitting the delete button\n// on that first check mark for seizures.\n// next-tutorial:conditionals",conditionalsTutorial="// you can draw different things\n// (or in general do different things)\n// based on any\n// test condition you want:\n\nrotate\nif frame%3 == 0\n\tbox\nelse if frame%3 == 1\n\tball\nelse\n\tpeg\n\n// next-tutorial:autocode",
autocodeTutorial="// the Autocode button invents random\n// variations for you.\n\n// You can interrupt the Autocoder at\n// any time by pressing the button again,\n// or you can press CTRL-Z\n// (or CMD-Z on Macs) to undo (or re-do) some of\n// the steps even WHILE the autocoder is running,\n// if you see that things got\n// boring down a particular path of changes.";
function loadDemoOrTutorial(a){if((!Detector.webgl||forceCanvasRenderer)&&!userWarnedAboutWebglExamples&&0===a.indexOf("webgl"))userWarnedAboutWebglExamples=!0,$("#exampleNeedsWebgl").modal(),$("#simplemodal-container").height(200);window.location.hash="bookmark="+a;fakeText&&shrinkFakeText();undimEditor();doTheSpinThingy=!1;var b="";if((!Detector.webgl||forceCanvasRenderer)&&0===a.indexOf("webgl"))b="// this drawing makes much more sense\n// in a WebGL-enabled browser\n\n";switch(a){case "roseDemo":editor.setValue(b+
roseDemo);break;case "cheeseAndOlivesDemo":editor.setValue(b+cheeseAndOlivesDemo);break;case "simpleCubeDemo":editor.setValue(b+simpleCubeDemo);break;case "webgltwocubesDemo":editor.setValue(b+webgltwocubesDemo);break;case "cubesAndSpikes":editor.setValue(b+cubesAndSpikes);break;case "webglturbineDemo":editor.setValue(b+webglturbineDemo);break;case "webglzfightartDemo":editor.setValue(b+webglzfightartDemo);break;case "littleSpiralOfCubes":editor.setValue(b+littleSpiralOfCubes);break;case "tentacleDemo":editor.setValue(b+
tentacleDemo);break;case "lampDemo":editor.setValue(b+lampDemo);break;case "trillionfeathersDemo":editor.setValue(b+trillionfeathersDemo);break;case "monsterblobDemo":editor.setValue(b+monsterblobDemo);break;case "industrialMusicDemo":editor.setValue(b+industrialMusicDemo);break;case "trySoundsDemo":editor.setValue(b+trySoundsDemo);break;case "springysquaresDemo":editor.setValue(b+springysquaresDemo);break;case "diceDemo":editor.setValue(b+diceDemo);break;case "webglalmostvoronoiDemo":editor.setValue(b+
webglalmostvoronoiDemo);break;case "webglshardsDemo":editor.setValue(b+webglshardsDemo);break;case "webglredthreadsDemo":editor.setValue(b+webglredthreadsDemo);break;case "webglnuclearOctopusDemo":editor.setValue(b+webglnuclearOctopusDemo);break;case "introTutorial":editor.setValue(b+introTutorial);break;case "helloworldTutorial":editor.setValue(b+helloworldTutorial);break;case "somenotesTutorial":editor.setValue(b+somenotesTutorial);break;case "rotateTutorial":editor.setValue(b+rotateTutorial);break;
case "frameTutorial":editor.setValue(b+frameTutorial);break;case "timeTutorial":editor.setValue(b+timeTutorial);break;case "moveTutorial":editor.setValue(b+moveTutorial);break;case "scaleTutorial":editor.setValue(b+scaleTutorial);break;case "timesTutorial":editor.setValue(b+timesTutorial);break;case "fillTutorial":editor.setValue(b+fillTutorial);break;case "strokeTutorial":editor.setValue(b+strokeTutorial);break;case "colornamesTutorial":editor.setValue(b+colornamesTutorial);break;case "lightsTutorial":editor.setValue(b+
lightsTutorial);break;case "backgroundTutorial":editor.setValue(b+backgroundTutorial);break;case "gradientTutorial":editor.setValue(b+gradientTutorial);break;case "lineTutorial":editor.setValue(b+lineTutorial);break;case "ballTutorial":editor.setValue(b+ballTutorial);break;case "pushpopMatrixTutorial":editor.setValue(b+pushpopMatrixTutorial);break;case "animationstyleTutorial":editor.setValue(b+animationstyleTutorial);break;case "doonceTutorial":editor.setValue(b+doonceTutorial);break;case "conditionalsTutorial":editor.setValue(b+
conditionalsTutorial);break;case "autocodeTutorial":editor.setValue(b+autocodeTutorial)}}var autocodeOn=!1,blinkingAutocoderTimeout,blinkingAutocoderStatus=!1,numberOfResults=0,whichOneToChange=0;function blinkAutocodeIndicator(){(blinkingAutocoderStatus=!blinkingAutocoderStatus)?$("#autocodeIndicatorContainer").css("background-color",""):($("#autocodeIndicatorContainer").css("background-color","#FF0000"),mutate())}
function toggleAutocodeAndUpdateButtonAndBlinking(){(autocodeOn=!autocodeOn)?(frenchVersion?$("#autocodeIndicator").html("Autocode: actif"):$("#autocodeIndicator").html("Autocode: on"),blinkingAutocoderTimeout=setInterval("blinkAutocodeIndicator();",500),$("#autocodeIndicatorContainer").css("background-color","#FF0000"),(""===editor.getValue()||-1!==window.location.hash.indexOf("bookmark")&&-1!==window.location.hash.indexOf("autocodeTutorial"))&&loadDemoOrTutorial("cubesAndSpikes")):(frenchVersion?
$("#autocodeIndicator").html("Autocode: inactif"):$("#autocodeIndicator").html("Autocode: off"),clearInterval(blinkingAutocoderTimeout),$("#autocodeIndicatorContainer").css("background-color",""))}function mutate(){var a=editor.getValue();Tokens=[];try{INIT.lex(a)}catch(b){console.log(b)}pickMutatableTokenAndMutateIt(Tokens);a=emit(Tokens);editor.setValue(a)}
var INIT=new McLexer.State,colours="aliceblue,antiquewhite,aqua,aquamarine,azure,beige,bisque,black,blanchedalmond,blue,blueviolet,brown,burlywood,cadetblue,chartreuse,chocolate,coral,cornflowerblue,cornsilk,crimson,cyan,darkblue,darkcyan,darkgoldenrod,darkgray,darkgrey,darkgreen,darkkhaki,darkmagenta,darkolivegreen,darkorange,darkorchid,darkred,darksalmon,darkseagreen,darkslateblue,darkslategray,darkslategrey,darkturquoise,darkviolet,deeppink,deepskyblue,dimgray,dimgrey,dodgerblue,firebrick,floralwhite,forestgreen,fuchsia,gainsboro,ghostwhite,gold,goldenrod,gray,grey,green,greenyellow,honeydew,hotpink,indianred,indigo,ivory,khaki,lavender,lavenderblush,lawngreen,lemonchiffon,lightblue,lightcoral,lightcyan,lightgoldenrodyellow,lightgrey,lightgray,lightgreen,lightpink,lightsalmon,lightseagreen,lightskyblue,lightslategray,lightslategrey,lightsteelblue,lightyellow,lime,limegreen,linen,magenta,maroon,mediumaquamarine,mediumblue,mediumorchid,mediumpurple,mediumseagreen,mediumslateblue,mediumspringgreen,mediumturquoise,mediumvioletred,midnightblue,mintcream,mistyrose,moccasin,navajowhite,navy,oldlace,olive,olivedrab,orange,orangered,orchid,palegoldenrod,palegreen,paleturquoise,palevioletred,papayawhip,peachpuff,peru,pink,plum,powderblue,purple,red,rosybrown,royalblue,saddlebrown,salmon,sandybrown,seagreen,seashell,sienna,silver,skyblue,slateblue,slategray,slategrey,snow,springgreen,steelblue,tan,teal,thistle,tomato,turquoise,violet,wheat,white,whitesmoke,yellow,yellowgreen".split(","),Tokens=
[];function COMMENT(a){this.string=a;this.toString=function(){return"COMMENT("+a+")"}}function SPACE(a){this.string=a;this.toString=function(){return"SPACE("+a+")"}}function NEWLINE(a){this.string=a;this.toString=function(){return"<br/>"}}function TRANSLATION(a){this.string=a;this.toString=function(){return"TRANSLATION("+a+")"}}function VARIABLE(a){this.string=a;this.toString=function(){return"VARIABLE("+a+")"}}
function NUM(a){this.string=a;this.toString=function(){return"NUM("+a+")"};this.mutate=function(){var a=new Number(this.string);0==a&&(a=0.1);Math.random();Math.random();var c=a*Math.random(),a=(a+c).toFixed(2);console.log("mutate number "+this.string+" -> "+a.toString());this.string=a.toString()}}function OP(a){this.string=a;this.toString=function(){return"OP("+a+")"}}function ARGDLIM(a){this.string=a;this.toString=function(){return"ARGDLIM("+a+")"}}
function TAB(a){this.string=a;this.toString=function(){return"TAB("+a+")"}}function DOONCE(a){this.string=a;this.toString=function(){return"DOONCE("+a+")"}}function COLOUROP(a){this.string=a;this.toString=function(){return"COLOUROP("+a+")"}}
function COLOUR(a){this.string=a;this.toString=function(){return"COLOUR("+a+")"};this.mutate=function(){for(var a=Math.floor(Math.random()*colours.length);this.string==colours[a];)a=Math.floor(Math.random()*colours.length);console.log("mutate colour "+this.string+" -> "+colours[a]);this.string=colours[a]}}
function MESH(a){this.string=a;this.toString=function(){return"MESH("+a+")"};this.mutate=function(){switch(this.string){case "box":this.string="ball";break;case "ball":this.string="box";break;case "line":this.string="rect";break;case "rect":this.string="line"}}}function STATEFUN(a){this.string=a;this.toString=function(){return"STATEFUN("+a+")"}}
function ITERATION(a){this.string=a;this.toString=function(){return"ITERATION("+a+")"};this.mutate=function(){var a=/\d/.exec(this.string);console.log("ITER NUM: "+a);0.5<Math.random()?a++:a--;this.string=a.toString()+" times ->"}}function UNKNOWN(a){this.string=a;this.toString=function(){return"UNKNOWN("+a+")"}}INIT(/\/\/.*\n/)(function(a,b,c){Tokens.push(new COMMENT(a[0]));return c.continuation(b)});INIT(/\t/)(function(a,b,c){Tokens.push(new TAB(a[0]));return c.continuation(b)});
INIT(/-?[0-9]+\.?[0-9]*/)(function(a,b,c){Tokens.push(new NUM(a[0]));return c.continuation(b)});INIT(/[*|\/|+|-]/)(function(a,b,c){Tokens.push(new OP(a[0]));return c.continuation(b)});INIT(/,/)(function(a,b,c){Tokens.push(new ARGDLIM(a[0]));return c.continuation(b)});INIT(/[\n|\r]{1,2}/)(function(a,b,c){Tokens.push(new NEWLINE(a[0]));return c.continuation(b)});INIT(/rotate/)(function(a,b,c){Tokens.push(new TRANSLATION(a[0]));return c.continuation(b)});
INIT(/move/)(function(a,b,c){Tokens.push(new TRANSLATION(a[0]));return c.continuation(b)});INIT(/scale/)(function(a,b,c){Tokens.push(new TRANSLATION(a[0]));return c.continuation(b)});for(var scanningAllColors=0;scanningAllColors<colours.length;scanningAllColors++)INIT(RegExp(colours[scanningAllColors]))(function(a,b,c){Tokens.push(new COLOUR(a[0]));return c.continuation(b)});INIT(/background/)(function(a,b,c){Tokens.push(new COLOUROP(a[0]));return c.continuation(b)});
INIT(/fill/)(function(a,b,c){Tokens.push(new COLOUROP(a[0]));return c.continuation(b)});INIT(/stroke/)(function(a,b,c){Tokens.push(new COLOUROP(a[0]));return c.continuation(b)});INIT(/simpleGradient/)(function(a,b,c){Tokens.push(new COLOUROP(a[0]));return c.continuation(b)});INIT(/box/)(function(a,b,c){Tokens.push(new MESH(a[0]));return c.continuation(b)});INIT(/ball/)(function(a,b,c){Tokens.push(new MESH(a[0]));return c.continuation(b)});INIT(/rect/)(function(a,b,c){Tokens.push(new MESH(a[0]));return c.continuation(b)});
INIT(/line/)(function(a,b,c){Tokens.push(new MESH(a[0]));return c.continuation(b)});INIT(/ballDetail/)(function(a,b,c){Tokens.push(new STATEFUN(a[0]));return c.continuation(b)});INIT(/animationStyle\s\w+/)(function(a,b,c){Tokens.push(new STATEFUN(a[0]));return c.continuation(b)});INIT(/\d+\s+times\s+->/)(function(a,b,c){Tokens.push(new ITERATION(a[0]));return c.continuation(b)});INIT(/time/)(function(a,b,c){Tokens.push(new VARIABLE(a[0]));return c.continuation(b)});
INIT(/delay/)(function(a,b,c){Tokens.push(new VARIABLE(a[0]));return c.continuation(b)});INIT(/\?doOnce\s+->\s*/)(function(a,b,c){Tokens.push(new DOONCE(a[0]));return c.continuation(b)});INIT(/ +/)(function(a,b,c){Tokens.push(new SPACE(a[0]));return c.continuation(b)});INIT(/color\s*\(.+\)/)(function(a,b,c){Tokens.push(new UNKNOWN(a[0]));return c.continuation(b)});INIT(/noFill/)(function(a,b,c){Tokens.push(new UNKNOWN(a[0]));return c.continuation(b)});
INIT(/strokeSize/)(function(a,b,c){Tokens.push(new UNKNOWN(a[0]));return c.continuation(b)});function emit(a){for(var b="",c=0;c<a.length;c++)b+=a[c].string;return b}function canMutate(a){return"function"==typeof a.mutate?!0:!1}function pickMutatableTokenAndMutateIt(a){for(var b=[],c=0;c<a.length;c++)canMutate(a[c])&&b.push(c);0==b.length?console.log("no possible mutations"):(console.log(b),c=Math.floor(Math.random()*b.length),a[b[c]].mutate())}
function replaceTimeWithAConstant(){var a=editor.getValue(),b;b=frenchVersion?/(temps)/gi:/(time)/gi;var c=a.match(b);numberOfResults=null===c?0:c.length;whichOneToChange=Math.floor(Math.random()*numberOfResults)+1;var f=0,a=a.replace(b,function(a){f++;return f===whichOneToChange?""+Math.floor(20*Math.random())+1:a});editor.setValue(a)}
function suspendDimmingAndCheckIfLink(){var a=editor.getCursor(!0);2<a.ch&&(a=editor.getLine(a.line),0===a.indexOf("// next-tutorial:")&&(a=a.substring(17),a=a.replace("_",""),setTimeout('loadDemoOrTutorial("'+a+'Tutorial");',200)));fakeText||""===editor.getValue()||(log("cursor activity! opacity: "+$("#formCode").css("opacity")),cursorActivity=!0,undimEditor())}
function undimEditor(){(fakeText||""===editor.getValue())&&$("#formCode").css("opacity",0);0.99>$("#formCode").css("opacity")&&(log("undimming the editor"),$("#formCode").animate({opacity:1},"fast"))}function dimEditor(){0<$("#formCode").css("opacity")&&(log("starting fadeout animation"),$("#formCode").animate({opacity:0},"slow"))}
function dimIfNoCursorActivity(){fakeText||""===editor.getValue()||(cursorActivity?(log("marking cursor activity = false. Will check again in the next interval"),cursorActivity=!1):(log("no activity in the last interval. Dimming now, starting opacity is: "+$("#formCode").css("opacity")),dimEditor()))}
function toggleDimCode(){(dimcodeOn=!dimcodeOn)?(dimIntervalID=setInterval("dimIfNoCursorActivity()",5E3),frenchVersion?$("#dimCodeIndicator").html("Code Cach\u00e9: actif"):$("#dimCodeIndicator").html("Hide Code: on")):(clearInterval(dimIntervalID),undimEditor(),frenchVersion?$("#dimCodeIndicator").html("Code Cach\u00e9: inactif"):$("#dimCodeIndicator").html("Hide Code: off"))}
var ambientColor=color(255,255,255),reflectValue=1,refractValue=0.98,lightsAreOn=!1,lights=function(){lightsAreOn=!0},noLights=function(){lightsAreOn=!1},ambientLight=function(a,b,c,f){a=void 0===a?color$1(125):color(a,b,c,f);b=!1;lightsAreOn=!0;defaultNormalStroke=defaultNormalFill=!1;c=ambientLightsPool[usedAmbientLights];void 0===c?(log("no ambientLight in pool, creating one"),c=new THREE.AmbientLight(a),b=!0,ambientLightsPool.push(c)):(c.color.setHex(a),log("existing ambientLight in pool, setting color: "+
c.color.r+" "+c.color.g+" "+c.color.b));c.isLine=!1;c.isRectangle=!1;c.isBox=!1;c.isCylinder=!1;c.isAmbientLight=!0;c.isPointLight=!1;c.isSphere=0;usedAmbientLights++;c.matrixAutoUpdate=!1;c.matrix.copy(worldMatrix);c.matrixWorldNeedsUpdate=!0;b&&scene.add(c)},animationStyle=function(a){!1===a||void 0===a||(animationStyleValue=a)},animationStyleUpdateIfChanged=function(){animationStyleValue!==previousanimationStyleValue&&(previousanimationStyleValue=animationStyleValue,isWebGLUsed&&animationStyleValue===
motionBlur?effectBlend.uniforms.mixRatio.value=0.7:!isWebGLUsed&&animationStyleValue===motionBlur&&(blendAmount=0.6),isWebGLUsed&&animationStyleValue===paintOver?effectBlend.uniforms.mixRatio.value=1:!isWebGLUsed&&animationStyleValue===paintOver&&(blendAmount=1),isWebGLUsed&&animationStyleValue===normal?effectBlend.uniforms.mixRatio.value=0:!isWebGLUsed&&animationStyleValue===normal&&(blendAmount=0))},initThreeJs=function(){scaledBackgroundWidth=Math.floor(window.innerWidth/backGroundFraction);scaledBackgroundHeight=
Math.floor(window.innerHeight/backGroundFraction);!forceCanvasRenderer&&Detector.webgl&&!forceCanvasRenderer?(ballDefaultDetLevel=16,sceneRenderingCanvas=document.createElement("canvas"),renderer=new THREE.WebGLRenderer({canvas:sceneRenderingCanvas,preserveDrawingBuffer:!1,antialias:!1,premultipliedAlpha:!1}),isWebGLUsed=!0,navigator.userAgent.toLowerCase().indexOf("chrome"),renderer.setSize(window.innerWidth,window.innerHeight),document.getElementById("container").appendChild(sceneRenderingCanvas)):
(ballDefaultDetLevel=6,sceneRenderingCanvas=document.createElement("canvas"),sceneRenderingCanvasContext=sceneRenderingCanvas.getContext("2d"),renderer=new THREE.CanvasRenderer({canvas:sceneRenderingCanvas,antialias:!0,preserveDrawingBuffer:!1}),previousRenderForBlending=document.createElement("canvas"),previousRenderForBlending.width=window.innerWidth,previousRenderForBlending.height=window.innerHeight,previousRenderForBlendingContext=previousRenderForBlending.getContext("2d"),finalRenderWithSceneAndBlend=
document.getElementById("finalRenderWithSceneAndBlendCanvas"),finalRenderWithSceneAndBlend.width=window.innerWidth,finalRenderWithSceneAndBlend.height=window.innerWidth,finalRenderWithSceneAndBlendContext=finalRenderWithSceneAndBlend.getContext("2d"),renderer.setSize(window.innerWidth,window.innerHeight));backgroundScene=document.getElementById("backGroundCanvas");backgroundScene.width=scaledBackgroundWidth;backgroundScene.height=scaledBackgroundHeight;backgroundSceneContext=backgroundScene.getContext("2d");
stats=new Stats;stats.getDomElement().style.position="absolute";stats.getDomElement().style.right="0px";stats.getDomElement().style.top="0px";document.body.appendChild(stats.getDomElement());scene=new THREE.Scene;scene.matrixAutoUpdate=!1;camera=new THREE.PerspectiveCamera(35,window.innerWidth/window.innerHeight,1,1E4);camera.position.set(0,0,5);scene.add(camera);var a=new THREE.PointLight(16777215);a.position.x=10;a.position.y=50;a.position.z=130;scene.add(a);THREEx.WindowResize.bind(renderer,camera);
isWebGLUsed&&buildPostprocessingChain()},effectBlend,buildPostprocessingChain=function(){var a={format:THREE.RGBAFormat,stencilBuffer:!0},b=new THREE.WebGLRenderTarget(window.innerWidth,window.innerHeight,a),a=new THREE.SavePass(new THREE.WebGLRenderTarget(window.innerWidth,window.innerHeight,a));a.clear=!1;(new THREE.ShaderPass(THREE.ShaderExtras.fxaa)).uniforms.resolution.value.set(1/window.innerWidth,1/window.innerHeight);effectBlend=new THREE.ShaderPass(THREE.ShaderExtras.blend,"tDiffuse1");var c=
new THREE.ShaderPass(THREE.ShaderExtras.screen);effectBlend.uniforms.tDiffuse2.texture=a.renderTarget;effectBlend.uniforms.mixRatio.value=0;var f=new THREE.RenderPass(scene,camera);composer=new THREE.EffectComposer(renderer,b);composer.addPass(f);composer.addPass(effectBlend);composer.addPass(a);composer.addPass(c);c.renderToScreen=!0},log=function(){};
function wheel(a){var b=a||window.event;[].slice.call(arguments,1);var c=0,f=0,h=0,a=$.event.fix(b);a.type="mousewheel";b.wheelDelta&&(c=b.wheelDelta/120);b.detail&&(c=-b.detail/3);h=c;void 0!==b.axis&&b.axis===b.HORIZONTAL_AXIS&&(h=0,f=-1*c);void 0!==b.wheelDeltaY&&(h=b.wheelDeltaY/120);void 0!==b.wheelDeltaX&&(f=-1*b.wheelDeltaX/120);log(""+f+" "+h);0.2<h?(b=editor.getCursor(!0),log(b.line+" "+editor.lineCount()),b.line!==editor.lineCount()-1&&editor.setCursor(b.line+1,b.ch)):-0.2>h&&(b=editor.getCursor(!0),
editor.setCursor(b.line-1,b.ch))}window.addEventListener&&window.addEventListener("DOMMouseScroll",wheel,!1);window.onmousewheel=document.onmousewheel=wheel;var fakeText=!0;document.onkeypress=function(a){fakeText&&""!==editor.getValue()&&shrinkFakeText(a)};
var shrinkFakeText=function(a){void 0!==a?(a=a||window.event,a=a.keyCode||a.which,a=String.fromCharCode(a)):a="";var b=$("#caption").html(),b=b.substring(0,b.length-1);$("#caption").html(b+a+"|");$("#fakeStartingBlinkingCursor").html("");$("#toMove").animate({opacity:0,margin:-100,fontSize:300,left:0},"fast");setTimeout('$("#formCode").animate({opacity: 1}, "fast");',120);setTimeout('$("#justForFakeCursor").hide();',200);setTimeout('$("#toMove").hide();',200);fakeText=!1},fakeCursorInterval;
function fakeCursorBlinking(){$("#fakeStartingBlinkingCursor").animate({opacity:0.2},"fast","swing").animate({opacity:1},"fast","swing")};
